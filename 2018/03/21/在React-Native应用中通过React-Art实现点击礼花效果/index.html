<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="react-native," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="ä»‹ç»å®é™…ä¸Šè¿™ä¸ªä¾‹å­å¹¶ä¸éœ€è¦ä½¿ç”¨react-artå°±èƒ½å®ç°ï¼Œä½†æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨react-artæ¥å®ç°ä¸€ç§è‰¯å¥½çš„æ•ˆæœã€‚é‚£è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬è¦å®Œæˆçš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç¤¼èŠ±ğŸ‰ç§€ã€‚å¹¶ä¸èŠ±å“¨ï¼Œåªéœ€è¦ç‚¹å‡»å±å¹•ï¼Œä¸€æœµç¤¼èŠ±å°±å°†è¦å‘å°„åˆ°ä½ ç‚¹å‡»çš„åœ°æ–¹å¹¶å±•å¼€ã€‚ æœ€ç»ˆæ•ˆæœè¿™å°±æ˜¯æˆ‘ä»¬è¦å®ç°çš„æ•ˆæœã€‚  start projectå°±åƒæ™®é€šçš„é¡¹ç›®é‚£æ ·ï¼Œåˆ›å»ºä¸€ä¸ªç©ºç™½çš„React-Nativeå·¥ç¨‹ï¼Œç„¶åæŠŠindex.jsé‡Œçš„è‡ªåŠ¨ç”Ÿæˆä»£ç æ”¹ä¸º 12">
<meta name="keywords" content="react-native">
<meta property="og:type" content="article">
<meta property="og:title" content="åœ¨React-Nativeåº”ç”¨ä¸­é€šè¿‡React-Artå®ç°ç‚¹å‡»ç¤¼èŠ±æ•ˆæœ">
<meta property="og:url" content="http://yoursite.com/2018/03/21/åœ¨React-Nativeåº”ç”¨ä¸­é€šè¿‡React-Artå®ç°ç‚¹å‡»ç¤¼èŠ±æ•ˆæœ/index.html">
<meta property="og:site_name" content="å¤§èƒƒå´çš„é—²è¯å” å—‘">
<meta property="og:description" content="ä»‹ç»å®é™…ä¸Šè¿™ä¸ªä¾‹å­å¹¶ä¸éœ€è¦ä½¿ç”¨react-artå°±èƒ½å®ç°ï¼Œä½†æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨react-artæ¥å®ç°ä¸€ç§è‰¯å¥½çš„æ•ˆæœã€‚é‚£è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬è¦å®Œæˆçš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç¤¼èŠ±ğŸ‰ç§€ã€‚å¹¶ä¸èŠ±å“¨ï¼Œåªéœ€è¦ç‚¹å‡»å±å¹•ï¼Œä¸€æœµç¤¼èŠ±å°±å°†è¦å‘å°„åˆ°ä½ ç‚¹å‡»çš„åœ°æ–¹å¹¶å±•å¼€ã€‚ æœ€ç»ˆæ•ˆæœè¿™å°±æ˜¯æˆ‘ä»¬è¦å®ç°çš„æ•ˆæœã€‚  start projectå°±åƒæ™®é€šçš„é¡¹ç›®é‚£æ ·ï¼Œåˆ›å»ºä¸€ä¸ªç©ºç™½çš„React-Nativeå·¥ç¨‹ï¼Œç„¶åæŠŠindex.jsé‡Œçš„è‡ªåŠ¨ç”Ÿæˆä»£ç æ”¹ä¸º 12">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://7oxfjd.com2.z0.glb.qiniucdn.com/2018-03-21-preview_3.gif">
<meta property="og:image" content="http://7oxfjd.com2.z0.glb.qiniucdn.com/2018-03-21-preview_1.gif">
<meta property="og:image" content="http://7oxfjd.com2.z0.glb.qiniucdn.com/2018-03-21-preview_2.gif">
<meta property="og:image" content="http://7oxfjd.com2.z0.glb.qiniucdn.com/2018-03-21-preview_3.gif">
<meta property="og:updated_time" content="2018-03-21T11:10:08.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="åœ¨React-Nativeåº”ç”¨ä¸­é€šè¿‡React-Artå®ç°ç‚¹å‡»ç¤¼èŠ±æ•ˆæœ">
<meta name="twitter:description" content="ä»‹ç»å®é™…ä¸Šè¿™ä¸ªä¾‹å­å¹¶ä¸éœ€è¦ä½¿ç”¨react-artå°±èƒ½å®ç°ï¼Œä½†æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨react-artæ¥å®ç°ä¸€ç§è‰¯å¥½çš„æ•ˆæœã€‚é‚£è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬è¦å®Œæˆçš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç¤¼èŠ±ğŸ‰ç§€ã€‚å¹¶ä¸èŠ±å“¨ï¼Œåªéœ€è¦ç‚¹å‡»å±å¹•ï¼Œä¸€æœµç¤¼èŠ±å°±å°†è¦å‘å°„åˆ°ä½ ç‚¹å‡»çš„åœ°æ–¹å¹¶å±•å¼€ã€‚ æœ€ç»ˆæ•ˆæœè¿™å°±æ˜¯æˆ‘ä»¬è¦å®ç°çš„æ•ˆæœã€‚  start projectå°±åƒæ™®é€šçš„é¡¹ç›®é‚£æ ·ï¼Œåˆ›å»ºä¸€ä¸ªç©ºç™½çš„React-Nativeå·¥ç¨‹ï¼Œç„¶åæŠŠindex.jsé‡Œçš„è‡ªåŠ¨ç”Ÿæˆä»£ç æ”¹ä¸º 12">
<meta name="twitter:image" content="http://7oxfjd.com2.z0.glb.qiniucdn.com/2018-03-21-preview_3.gif">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/2018/03/21/åœ¨React-Nativeåº”ç”¨ä¸­é€šè¿‡React-Artå®ç°ç‚¹å‡»ç¤¼èŠ±æ•ˆæœ/"/>

  <title> åœ¨React-Nativeåº”ç”¨ä¸­é€šè¿‡React-Artå®ç°ç‚¹å‡»ç¤¼èŠ±æ•ˆæœ | å¤§èƒƒå´çš„é—²è¯å” å—‘ </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">å¤§èƒƒå´çš„é—²è¯å” å—‘</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">æ‰¯æ‰¯æŠ€æœ¯ï¼Œå” å” é—²è¯ äº¤æµemail-xiao303178394@gmail.com</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-é¦–é¡µ">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            menu.é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-æ–‡ç« ">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            menu.æ–‡ç« 
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                åœ¨React-Nativeåº”ç”¨ä¸­é€šè¿‡React-Artå®ç°ç‚¹å‡»ç¤¼èŠ±æ•ˆæœ
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">VerÃ¶ffentlicht am</span>
            <time itemprop="dateCreated" datetime="2018-03-21T14:15:52+08:00" content="2018-03-21">
              2018-03-21
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>å®é™…ä¸Šè¿™ä¸ªä¾‹å­å¹¶ä¸éœ€è¦ä½¿ç”¨react-artå°±èƒ½å®ç°ï¼Œä½†æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨react-artæ¥å®ç°ä¸€ç§è‰¯å¥½çš„æ•ˆæœã€‚é‚£è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬è¦å®Œæˆçš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç¤¼èŠ±ğŸ‰ç§€ã€‚å¹¶ä¸èŠ±å“¨ï¼Œåªéœ€è¦ç‚¹å‡»å±å¹•ï¼Œä¸€æœµç¤¼èŠ±å°±å°†è¦å‘å°„åˆ°ä½ ç‚¹å‡»çš„åœ°æ–¹å¹¶å±•å¼€ã€‚</p>
<h2 id="æœ€ç»ˆæ•ˆæœ"><a href="#æœ€ç»ˆæ•ˆæœ" class="headerlink" title="æœ€ç»ˆæ•ˆæœ"></a>æœ€ç»ˆæ•ˆæœ</h2><p>è¿™å°±æ˜¯æˆ‘ä»¬è¦å®ç°çš„æ•ˆæœã€‚</p>
<p><img src="http://7oxfjd.com2.z0.glb.qiniucdn.com/2018-03-21-preview_3.gif" alt="preview_3"></p>
<h2 id="start-project"><a href="#start-project" class="headerlink" title="start project"></a>start project</h2><p>å°±åƒæ™®é€šçš„é¡¹ç›®é‚£æ ·ï¼Œåˆ›å»ºä¸€ä¸ªç©ºç™½çš„React-Nativeå·¥ç¨‹ï¼Œç„¶åæŠŠindex.jsé‡Œçš„è‡ªåŠ¨ç”Ÿæˆä»£ç æ”¹ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">import React, &#123;</div><div class="line">    Component</div><div class="line">&#125;from &apos;react&apos;;</div><div class="line"></div><div class="line">import &#123;</div><div class="line">    ART as Art,</div><div class="line">    StyleSheet,</div><div class="line">    View,</div><div class="line">    Dimensions,</div><div class="line">    TouchableWithoutFeedback,</div><div class="line">    Animated</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line"></div><div class="line">var &#123;</div><div class="line">    width,</div><div class="line">    height</div><div class="line">&#125; = Dimensions.get(&apos;window&apos;);</div><div class="line"></div><div class="line">var &#123;</div><div class="line">    Surface,</div><div class="line">    Shape,</div><div class="line">    Path,</div><div class="line">    Group,</div><div class="line">    Transform</div><div class="line">&#125; = Art;</div><div class="line"></div><div class="line">var AnimatedShape = Animated.createAnimatedComponent(Shape);</div><div class="line">var AnimatedGroup = Animated.createAnimatedComponent(Group);</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¼•å…¥äº†Animated APIï¼Œreact-artåº“ï¼Œè¿˜æœ‰ä¸€äº›ARTçš„ç»„ä»¶ã€‚ç„¶åæˆ‘è¦åˆ›å»ºAnimatedShapeå’ŒAnimatedGroupï¼Œè¿™äº›è®©æˆ‘ä»¬å¯ä»¥è®¾ç½®fill, opacity, x, yè¿™äº›åŠ¨ç”»å±æ€§ï¼Œå¯ä»¥è®©åŠ¨ç”»æ•ˆæœå‡†ç¡®æœ‰æ•ˆã€‚</p>
<p>æ¥ç€ï¼Œæˆ‘ä»¬åˆ›å»ºstyles</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">var styles = StyleSheet.create(&#123;</div><div class="line">  container: &#123;</div><div class="line">    flex: 1,</div><div class="line">    flexDirection: &apos;column&apos;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æ˜¯çš„ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬åŠ¨ç”»çš„å‘ç”Ÿçš„ç»„ä»¶äº†ã€‚</p>
<p>ç„¶ååˆ›å»ºæˆ‘ä»¬çš„ç»„ä»¶ç±»</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">export default class App extends Component&lt;Props&gt; &#123;</div><div class="line">    state = &#123;</div><div class="line">        fireworks: []</div><div class="line">    &#125;</div><div class="line">    render()&#123;</div><div class="line">        return (</div><div class="line">            &lt;View style=&#123;styles.container&#125;&gt;</div><div class="line">                &lt;TouchableWithoutFeedback&gt;</div><div class="line">                    &lt;View&gt;</div><div class="line">                        &lt;Surface width=&#123;width&#125; height=&#123;height&#125;&gt;</div><div class="line">                        &lt;/Surface&gt;</div><div class="line">                    &lt;/View&gt;</div><div class="line">                &lt;/TouchableWithoutFeedback&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·æˆ‘ä»¬çš„å¯åŠ¨ç©ºç™½å·¥ç¨‹å°±å®Œæˆäº†ã€‚ä¸€ä¸ªå®¹å™¨Viewï¼ŒåŒ…å«TouchableWithoutFeedbackè®©æˆ‘ä»¬èƒ½è·å–ç‚¹å‡»çš„åæ ‡ã€‚åœ¨Touchableä¸­éœ€è¦æœ‰ä¸€ä¸ªViewåœ¨åŒ…è£…æˆ‘ä»¬çš„react-art Surfaceç»„ä»¶ï¼Œå®ƒå¯ä»¥è®¾ç½®å®½é«˜ã€‚æˆ‘ä»¬çš„ä¾‹å­éœ€è¦ä¸€ä¸ªå…¨å±çš„ç”»å¸ƒï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡è·å–å±å¹•å°ºå¯¸å¹¶è®¾ç½®ç»™Surfaceç»„ä»¶ã€‚</p>
<h2 id="è®©ç‚®å¼¹é£ä¸€ä¼š"><a href="#è®©ç‚®å¼¹é£ä¸€ä¼š" class="headerlink" title="è®©ç‚®å¼¹é£ä¸€ä¼š"></a>è®©ç‚®å¼¹é£ä¸€ä¼š</h2><p>è®©æˆ‘ä»¬æƒ³è±¡å‘é€ç‚®å¼¹çš„æƒ…æ™¯ï¼šä¸€ä¸ªç‚®å¼¹ä»å±å¹•åº•éƒ¨ä¸­å¤®å¤„å‘å°„åˆ°æˆ‘ä»¬åœ¨å±å¹•ä¸Šç‚¹å‡»çš„ä½ç½®ã€‚</p>
<p>é‚£ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦é€šè¿‡react-artç»˜åˆ¶ä¸€ä¸ªåœ†ï¼›è¿˜è¦æœ‰ä¸€ä¸ªå¯ä»¥è§¦åœ°ç‚¹å‡»äº‹ä»¶çš„å‡½æ•°å»è·å–æˆ‘ä»¬ç‚¹å‡»çš„ä½ç½®ï¼›è¿˜è¦é€šè¿‡Animatedå°†åœ†å‘å°„åˆ°ç‚¹å‡»çš„ä½ç½®ï¼›æœ€ååœ¨ç‚¹å‡»çš„ä½ç½®æ¸²æŸ“å‡ºè¿™ä¸ªç‚®å¼¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;TouchableWithoutFeedback onPress=&#123;this._handleAddFirework&#125;&gt;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†ä½¿ç”¨TouchableWithoutFeedbackåœ¨ç”¨æˆ·ç‚¹å‡»å±å¹•æ—¶å€™å›è°ƒå‡½æ•°å»å¢åŠ ç¤¼èŠ±åˆ°é˜Ÿåˆ—ä¸­ã€‚ç„¶åæ¸²æŸ“æ—¶å€™åœ¨é˜Ÿåˆ—ä¸­è¯»å–ç‚®å¼¹å¹¶ç»˜åˆ¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">class AnimatedCircle extends Component&lt;Props&gt; &#123;</div><div class="line">    render()&#123;</div><div class="line">        var radius = this.props.radius;</div><div class="line">        var path = Path().moveTo(0, -radius)</div><div class="line">            .arc(0, radius * 2, radius)</div><div class="line">            .arc(0, radius * -2, radius)</div><div class="line">            .close();</div><div class="line">        return (</div><div class="line">            &lt;AnimatedShape d=&#123;path&#125;  &#123;...this.props&#125;/&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>çœ‹èµ·æ¥æˆ‘ä»¬åªæ˜¯æŠŠAnimatedShapeåŒ…è£…èµ·æ¥ï¼Œä¹Ÿå°±æ˜¯ç»„ä»¶åŒ–ï¼Œè¿™æ ·å¯ä»¥å°½å¯èƒ½æ˜¯å¤ç”¨ä»£ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">const MORTAR_RADIUS = 5</div><div class="line">///...</div><div class="line">_handleAddFirework = (e) =&gt; &#123;</div><div class="line">    var _shootingPosition = new Animated.ValueXY(&#123;x: width/2, y: height - MORTAR_RADIUS&#125;);</div><div class="line"></div><div class="line">    this.state.fireworks.push(&#123;</div><div class="line">        shootingPosition: _shootingPosition,</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    Animated.timing(_shootingPosition, &#123;</div><div class="line">        duration: 300,</div><div class="line">        toValue: &#123;</div><div class="line">            y: e.nativeEvent.locationY,</div><div class="line">            x: e.nativeEvent.locationX</div><div class="line">        &#125;</div><div class="line">    &#125;).start()</div><div class="line"></div><div class="line">    this.setState(this.state);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¥½çš„ï¼Œè®©æˆ‘ä»¬åœä¸‹æ¥åˆ†æä¸‹ä»£ç ã€‚</p>
<p>å‡½æ•°çš„ç¬¬ä¸€è¡Œ_shootingPositionï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªAnimatedçš„å‘é‡å€¼ç±»å‹ï¼Œè¿™æ˜¯é»˜è®¤å€¼ï¼Œä¹Ÿå°±æ˜¯ç‚®å¼¹å‘é€å‡ºæ¥çš„åœ°æ–¹ï¼Œå°±æ˜¯æ°´å¹³ä¸­å¤®ï¼Œå¹¶è·ç¦»åº•éƒ¨MORTAR_RADIUSçš„è·ç¦»ï¼Œä½¿ç”¨å¸¸é‡æ–¹ä¾¿æˆ‘ä»¬ä¿®æ”¹å°ºå¯¸æ—¶å€™å¯ä»¥ä¸ç”¨ä¿®æ”¹ä»£ç ï¼ŒMORTAR_RADIUSä¼šè®¾ç½®ä¸º5ï¼Œå› ä¸ºæˆ‘ä»¬ç‚®å¼¹çš„åŠå¾„ä¹Ÿæ˜¯5.</p>
<p>ç„¶åæˆ‘ä»¬å°†å®ƒæ·»åŠ åˆ°ä¸€ä¸ªç¤¼èŠ±çš„æ•°ç»„ä¸­ï¼Œç¨ä¼šæˆ‘ä»¬å°±è¦å‘å°„ä»–ä»¬äº†ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å¼€å§‹åˆ›å»ºåŠ¨ç”»ã€‚æˆ‘ä»¬æƒ³è®©ç‚®å¼¹ç»è¿‡300æ¯«ç§’åˆ°è¾¾ç”¨æˆ·ç‚¹å‡»çš„ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½®toValueä¸ºç”¨æˆ·ç‚¹å‡»çš„ä½ç½®ã€‚ç„¶åæˆ‘ä»¬æ‰§è¡ŒåŠ¨ç”»ã€‚å¯¹ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰æ¸²æŸ“ä»»ä½•ä¸œè¥¿ä½†ç›¸ä¿¡æˆ‘é©¬ä¸Šæˆ‘ä»¬å°±è¦çœ‹åˆ°ç¬¬ä¸€æ­¥çš„æ•ˆæœäº†ã€‚</p>
<p>æœ€åæˆ‘ä»¬è®¾ç½®stateï¼Œä»–ä¼šå¼•å‘å†æ¸²æŸ“ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥æ¸²æŸ“æˆ‘ä»¬çš„ç¤¼èŠ±äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;Surface width=&#123;width&#125; height=&#123;height&#125;&gt;</div><div class="line">    &#123;</div><div class="line">        this.state.fireworks.map((firework, index) =&gt; &#123;</div><div class="line">            return &lt;AnimatedCircle</div><div class="line">                radius=&#123;MORTAR_RADIUS&#125;</div><div class="line">                x=&#123;firework.shootingPosition.x&#125;</div><div class="line">                y=&#123;firework.shootingPosition.y&#125;</div><div class="line">                key=&#123;&quot;circle&quot;+index&#125;</div><div class="line">                fill=&quot;#000&quot;</div><div class="line">            /&gt;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">&lt;/Surface&gt;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­æˆ‘ä»¬æ˜ å°„äº†stateä¸­çš„æ¯ä¸ªç‚®å¼¹æˆAnimatedCircleï¼Œå¹¶è®¾ç½®ç›¸åº”çš„x,yå€¼ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¦ç»™ç‚®å¼¹å¡«å……é»‘è‰²ä¸ºåˆå§‹é¢œè‰²ã€‚</p>
<p>åˆ°æ­¤ä½ç½®ï¼Œè¿è¡Œä»£ç å¯ä»¥çœ‹åˆ°åˆæ­¥çš„æ•ˆæœäº†ã€‚</p>
<p><img src="http://7oxfjd.com2.z0.glb.qiniucdn.com/2018-03-21-preview_1.gif" alt="preview_1"></p>
<h2 id="æ¶ˆå¤±çš„ç‚®å¼¹"><a href="#æ¶ˆå¤±çš„ç‚®å¼¹" class="headerlink" title="æ¶ˆå¤±çš„ç‚®å¼¹"></a>æ¶ˆå¤±çš„ç‚®å¼¹</h2><p>æ˜¯çš„ï¼Œç‚®å¼¹å¹¶ä¸æ˜¯è¿™æ ·ç²˜è´´åœ¨å±å¹•ä¸Šçš„ã€‚æ‰€ä»¥æˆ‘ä»¬è¦è®©ä»–ä»¬æ¶ˆå¤±ã€‚start()å‡½æ•°å¯ä»¥è®¾ç½®ä¸€ä¸ªå›è°ƒï¼Œå½“åŠ¨ç”»ç»“æŸåä¼šå›è°ƒä»–ã€‚</p>
<p>æ‰€ä»¥æ•°ç»„ä¸­çš„ç‚®å¼¹éœ€è¦å”¯ä¸€æ ‡è¯†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨shootingPositionæ¥æ ‡è¯†å®ƒä»¬å¹¶è¿‡æ»¤å‡ºä»–ä»¬æ¥ã€‚</p>
<p>åƒä¸‹é¢è¿™æ ·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Animated.timing(_shootingPosition, &#123;</div><div class="line">    duration: 300,</div><div class="line">    toValue: &#123;</div><div class="line">        y: e.nativeEvent.locationY,</div><div class="line">        x: e.nativeEvent.locationX</div><div class="line">    &#125;</div><div class="line">&#125;).start(this.removeSelf.bind(this, _shootingPosition))</div><div class="line"></div><div class="line">this.setState(this.state);</div><div class="line">//...</div><div class="line"></div><div class="line">removeSelf = (_shootingPosition)=&gt; &#123;</div><div class="line">    this.setState(&#123;</div><div class="line">        fireworks: this.state.fireworks.filter((firework) =&gt; firework.shootingPosition !== _shootingPosition)</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç»ˆäºå®ƒè¿è¡Œèµ·æ¥åƒä¸ªç‚®å¼¹äº†ã€‚</p>
<h2 id="é€ƒç¦»é»‘ç™½ä¸–ç•Œ"><a href="#é€ƒç¦»é»‘ç™½ä¸–ç•Œ" class="headerlink" title="é€ƒç¦»é»‘ç™½ä¸–ç•Œ"></a>é€ƒç¦»é»‘ç™½ä¸–ç•Œ</h2><p>ç°åœ¨æˆ‘ä»¬å¼€å§‹è®©ç‚®å¼¹ä¸åªæ˜¯ä¸€ä¸ªé»‘ç‚¹ã€‚è®©æˆ‘ä»¬å‡è®¾å®ƒæ˜¯ä¸ªç«çƒï¼Œé‚£æˆ‘ä»¬å¯ä»¥è®©ä»–åœ¨é»„å’Œæ©™è‰²ä¹‹é—´å˜æ¢é¢œè‰²ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">const SHOOTING_COLORS = [</div><div class="line">    &apos;rgb(234,238,112)&apos;, //Yellow</div><div class="line">    &apos;rgb(245,137,12)&apos; //Orange</div><div class="line">];</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¦è°ƒç”¨çš„interpolateå‡½æ•°åªé€‚ç”¨äºrgbï¼Œå› æ­¤ä½¿ç”¨rgbè€Œä¸æ˜¯hexã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å°±åˆ›å»ºå¦ä¸€ä¸ªAnimated valueï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">adjustShootingFill = (_shootingColor, value) =&gt; &#123;</div><div class="line">    Animated.timing(_shootingColor, &#123;</div><div class="line">        duration: 16,</div><div class="line">        toValue: _shootingColor.__getAnimatedValue() == 0 ? 1 : 0</div><div class="line">    &#125;).start()</div><div class="line">&#125;</div><div class="line"></div><div class="line">_handleAddFirework = (e) =&gt; &#123;</div><div class="line">    var _shootingPosition = new Animated.ValueXY(&#123;x: width/2, y: height - MORTAR_RADIUS&#125;);</div><div class="line">    var _shootingColor = new Animated.Value(0);</div><div class="line"></div><div class="line">    this.state.fireworks.push(&#123;</div><div class="line">        shootingPosition: _shootingPosition,</div><div class="line">        shootingColor: _shootingColor,</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    _shootingPosition.addListener(this.adjustShootingFill.bind(null, _shootingColor));</div><div class="line"></div><div class="line">    Animated.timing(_shootingPosition, &#123;</div><div class="line">        duration: 300,</div><div class="line">        toValue: &#123;</div><div class="line">            y: e.nativeEvent.locationY,</div><div class="line">            x: e.nativeEvent.locationX</div><div class="line">        &#125;</div><div class="line">    &#125;).start(this.removeSelf.bind(this, _shootingPosition))</div><div class="line"></div><div class="line">    this.setState(this.state);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¼€å§‹æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªAnimated.Valueï¼Œé»˜è®¤è®¾ç½®ä¸º0.æˆ‘ä»¬æŠŠå®ƒæ·»åŠ åˆ°æˆ‘ä»¬çš„ç‚®å¼¹é›†åˆä¸­ã€‚</p>
<p>ç„¶åæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªç›‘å¬å™¨åœ¨_shootingPositionï¼Œè¿™æ ·å½“ç‚®å¼¹ä½ç½®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™å°†è°ƒç”¨è®¾ç½®çš„å›è°ƒå‡½æ•°ã€‚å›è°ƒä¸­æˆ‘ä»¬ä¸æ–­çš„é€šè¿‡å˜æ¢é»„å’Œæ©™è‰²ã€‚é€šè¿‡Animated.timingå‡½æ•°æ‰§è¡Œå˜è‰²åŠ¨ç”»ï¼Œè¿™ä¸ªåŠ¨ç”»åœ¨16å†…å®Œæˆï¼Œ__getAnimatedValueå¯ä»¥è·å–å½“å‰å€¼å¹¶ä¸”å˜æ¢æˆå¦ä¸€ä¸ªã€‚</p>
<p>æ‰€ä»¥ï¼Œæ¯16æ¯«ç§’ï¼Œç‚®å¼¹çš„é¢œè‰²éƒ½æ˜¯é»„â†’æ©™â†’é»„â†’æ©™â€¦â€¦å¾ªç¯ä¸‹å»ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;Surface width=&#123;width&#125; height=&#123;height&#125;&gt;</div><div class="line">    &#123;</div><div class="line">        this.state.fireworks.map((firework, index) =&gt; &#123;</div><div class="line">            var _shootingFill = firework.shootingColor.interpolate(&#123;</div><div class="line">                inputRange: [0,1],</div><div class="line">                outputRange: SHOOTING_COLORS</div><div class="line">            &#125;);</div><div class="line">            return &lt;AnimatedCircle</div><div class="line">                radius=&#123;MORTAR_RADIUS&#125;</div><div class="line">                key=&#123;&quot;circle&quot;+index&#125;</div><div class="line">                x=&#123;firework.shootingPosition.x&#125;</div><div class="line">                y=&#123;firework.shootingPosition.y&#125;</div><div class="line">                fill=&#123;_shootingFill&#125;</div><div class="line">            /&gt;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">&lt;/Surface&gt;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªinterpolatorï¼Œå®ƒå°è£…äº†Animated Valueåˆ°é¢œè‰²æ˜ å°„çš„é€»è¾‘ï¼Œæ˜ å°„æ˜¯åƒè¿™æ ·çš„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">0 =&gt; yellow</div><div class="line">1 =&gt; orange</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œæˆ‘ä»¬çš„æ•ˆæœç¦»é¢„æœŸå³è¿‘ä¸€æ­¥äº†ã€‚</p>
<p><img src="http://7oxfjd.com2.z0.glb.qiniucdn.com/2018-03-21-preview_2.gif" alt="preview_2"></p>
<h2 id="ç‚¸è£‚å§ï¼Œç‚®å¼¹"><a href="#ç‚¸è£‚å§ï¼Œç‚®å¼¹" class="headerlink" title="ç‚¸è£‚å§ï¼Œç‚®å¼¹"></a>ç‚¸è£‚å§ï¼Œç‚®å¼¹</h2><p>æœ‰è¶£çš„æ—¶é—´åˆ°äº†ï¼Œç‚¸è£‚å§ï¼Œç‚®å¼¹ã€‚</p>
<p>æˆ‘ä»¬çš„ç‚®å¼¹æ¦‚å¿µéå¸¸ç®€å•ï¼Œæˆ‘ä»¬å°†åˆ›å»º20ä¸ªå‘å¤–çˆ†å¼€çš„åœ†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ¶ä½œå„ç§å„æ ·çš„å°¾å·´ï¼Œè¿˜å¯ä»¥å››å¤„é£è¡Œï¼Œç”šè‡³åšä¸€äº›å¾ˆé…·çš„æ•ˆæœï¼Œä½†æ˜¯é‚£æ˜¯ä¹‹åçš„äº‹æƒ…äº†ï¼Œæˆ‘ä»¬å…ˆå®Œæˆè¿™æœ€åŸºæœ¬çš„æ•ˆæœã€‚</p>
<p>æˆ‘ä»¬å…ˆåˆ›å»ºä¸€äº›å˜é‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">const PARTICLE_RADIUS = 30; // ç‚¸å¼€ç²’å­çš„èŒƒå›´åŠå¾„</div><div class="line">const PARTICLE_COUNT = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]; // æ¯ä¸ªçˆ†å¼€æœ‰å¤šå°‘ç²’å­</div><div class="line"></div><div class="line">//ç²’å­çš„é¢œè‰²å˜åŒ–åŸŸ</div><div class="line">const PARTICLE_COLORS = [</div><div class="line">    &apos;rgba(54, 17, 52, 100)&apos;,</div><div class="line">    &apos;rgba(176, 34, 140, 100)&apos;,</div><div class="line">    &apos;rgba(234, 55, 136, 100)&apos;,</div><div class="line">    &apos;rgba(229, 107, 112, 100)&apos;,</div><div class="line">    &apos;rgba(243, 145, 160, 100)&apos;</div><div class="line">]</div></pre></td></tr></table></figure>
<p>PARTICLE_RADIUSå®šä¹‰äº†æ¯ä¸ªçˆ†ç‚¸çš„èŒƒå›´æœ‰å¤šå¤§ï¼›PARTICLE_COUNTå®šä¹‰äº†ç²’å­çš„æ•°é‡ï¼›æœ€åï¼ŒPARTICLE_COLORSå®šä¹‰äº†ç²’å­æœ‰å¤šå°‘ç§ä¸åŒçš„é¢œè‰²ï¼Œæ‰€ä»¥ï¼Œæ¯ä¸ªçˆ†ç‚¸å°†åœ¨è¿™å‡ ç§é¢œè‰²ä¹‹é—´å˜åŒ–ã€‚<br>ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†ä½¿æ¯ä¸ªç²’å­å…·æœ‰ç›¸åŒçš„é¢œè‰²ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬åªéœ€è¦1ä¸ªAnimated.Valueã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> _particleColor = <span class="keyword">new</span> Animated.Value(<span class="number">0</span>);</div><div class="line"><span class="keyword">var</span> _particleRadius = <span class="keyword">new</span> Animated.Value(<span class="number">0</span>);</div><div class="line"><span class="keyword">var</span> _coreOpacity = <span class="keyword">new</span> Animated.Value(<span class="number">1</span>);</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªAnimated.Valueä½œä¸ºæˆ‘ä»¬çš„åŠå¾„ï¼Œé»˜è®¤ä¸º0ï¼Œæ‰€ä»¥å®ƒå¼€å§‹éšè—ã€‚ å¦ä¸€ä¸ªAnimated.Valueæ˜¯é€æ˜çš„åŠ¨ç”»ã€‚å½“æˆ‘ä»¬çš„ç‚®å¼¹ç‚¸å¼€åéšè—å®ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> _particlePositions = PARTICLE_COUNT.map(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> Animated.ValueXY(&#123;<span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span>&#125;));</div></pre></td></tr></table></figure>
<p>æ¯ä¸ªç²’å­å°†æœ‰ä¸åŒçš„åæ ‡ï¼Œæ‰€ä»¥ä¾‹å­ä¸­æˆ‘ä»¬éœ€è¦20ä¸ªAnimated.ValueXYã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">this.state.fireworks.push(&#123;</div><div class="line">    shootingPosition: _shootingPosition,</div><div class="line">    shootingColor: _shootingColor,</div><div class="line">    particleColor: _particleColor,</div><div class="line">    particleRadius: _particleRadius,</div><div class="line">    coreOpacity: _coreOpacity,</div><div class="line">    particlePositions: _particlePositions</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æ·»åŠ æ–°çš„å¯¹è±¡ï¼Œè¿‡ä¼šæˆ‘ä»¬å°±æ¸²æŸ“å®ƒä»¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">function getXYParticle(total, i, radius) &#123;</div><div class="line">    var angle = 360/total*i;</div><div class="line"></div><div class="line">    var x = Math.round((radius*2) * Math.cos(angle - (Math.PI/2)));</div><div class="line">    var y = Math.round((radius*2) * Math.sin(angle - (Math.PI/2)));</div><div class="line"></div><div class="line">    return &#123;</div><div class="line">        x: x,</div><div class="line">        y: y</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var _animatedParticles = [</div><div class="line">    Animated.timing(_particleRadius, &#123;</div><div class="line">        duration: 700,</div><div class="line">        toValue: 1</div><div class="line">    &#125;),</div><div class="line">    Animated.timing(_coreOpacity, &#123;</div><div class="line">        duration: 200,</div><div class="line">        toValue: 0</div><div class="line">    &#125;)</div><div class="line">]</div><div class="line"></div><div class="line">var _movingParticles = _particlePositions.map((particle, i) =&gt; &#123;</div><div class="line">    var _xy = getXYParticle(PARTICLE_COUNT.length, i, PARTICLE_RADIUS);</div><div class="line">    return Animated.timing(particle, &#123;</div><div class="line">        duration: 250,</div><div class="line">        toValue: _xy</div><div class="line">    &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">_animatedParticles = _animatedParticles.concat(_movingParticles);</div></pre></td></tr></table></figure>
<p>è¿™äº›éƒ½æ˜¯ä¸ºæˆ‘ä»¬æ¥ä¸‹æ¥è¦åšçš„äº‹æƒ…åšå‡†å¤‡ï¼Œå°†æˆ‘ä»¬çš„åŠ¨ç”»éƒ½æ’æˆåºåˆ—ã€‚</p>
<p>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ç³»åˆ—éœ€è¦å‘ç”Ÿçš„åŠ¨ç”»ã€‚é¦–å…ˆæ˜¯æ‰©å±•æ¯ä¸ª_particleRadiusï¼Œæˆ‘ä»¬å·²ç»ç¡®å®šå®Œå…¨ç‚¸å¼€çš„åŠ¨ç”»æ—¶é•¿ä¸º700æ¯«ç§’ã€‚ _particleRadiuså®é™…ä¸Šæ˜¯ç²’å­å°ºå¯¸ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åªæ˜¯æ”¾å¤§è¿™ä¸ªåœ†ï¼Œçœ‹èµ·æ¥åƒæ˜¯å‘å¤–çˆ†ç‚¸ï¼Œä½†æ˜¯è¿™ä¼šåœ¨æˆ‘ä»¬çš„æ¸²æŸ“å‡½æ•°ä¸­æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>æˆ‘ä»¬å°†_coreOpacityï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç‚®å¼¹ï¼‰è®¾ç½®ä¸ºåœ¨200æ¯«ç§’å†…æ¶ˆå¤±ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸ªç²’å­åˆ›å»ºåŠ¨ç”»ï¼Œè®©ç²’å­ä»æˆ‘ä»¬ç›®å‰çš„ç‚®å¼¹ä½ç½®å‘å°„åˆ°ç²’å­åœ†èŒƒå›´å†…çš„ä¸åŒç‚¹ã€‚ç„¶åæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®—æ³•ï¼Œè®¡ç®—ç²’å­x,yçš„ä½ç½®ã€‚</p>
<p>ç„¶ååˆç”¨åˆ°Animated.timingï¼Œè®©ç²’å­èŠ±è´¹250æ¯«ç§’åˆ°è¾¾å®ƒçš„ä½ç½®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Animated.sequence([</div><div class="line">  Animated.timing(_shootingPosition, &#123;</div><div class="line">    duration: 300,</div><div class="line">    toValue: &#123;</div><div class="line">      y: e.nativeEvent.locationY,</div><div class="line">      x: e.nativeEvent.locationX</div><div class="line">    &#125;</div><div class="line">  &#125;),</div><div class="line">  Animated.parallel(_animatedParticles)</div><div class="line">]).start(this.removeSelf.bind(this, _shootingPosition));</div></pre></td></tr></table></figure>
<p>ç°åœ¨å°†æˆ‘ä»¬çš„åŠ¨ç”»åˆ—é˜Ÿåˆ—ã€‚å› ä¸ºæˆ‘ä»¬å¸Œæœ›ç‚®å¼¹å…ˆå°„å‡»ï¼Œç„¶ååˆ°è¾¾æŒ‡å®šä½ç½®åçˆ†ç‚¸ã€‚æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨Animated.sequenceå®ç°è¿™ä¸ªå…ˆåé¡ºåºã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆå°†æˆ‘ä»¬çš„ç‚®å¼¹ç§»åŠ¨åˆ°ç”¨æˆ·è§¦æ‘¸çš„ä½ç½®ã€‚ä¸‹ä¸€éƒ¨åˆ†å°†æˆ‘ä»¬æ‰€æœ‰çš„çˆ†ç‚¸åŠ¨ç”»å°è£…æˆAnimated.parallelã€‚è¿™ä¸Animated.sequenceç›¸åï¼Œå®ƒè¡¨ç¤ºåŒæ—¶æ‰§è¡Œæ‰€æœ‰è¿™äº›åŠ¨ç”»ã€‚</p>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬çš„ç‚®å¼¹æ¸æ¸æ¶ˆå¤±ï¼Œæˆ‘ä»¬çš„ç²’å­è†¨èƒ€ï¼Œé¢œè‰²å˜åŒ–ï¼Œçˆ†ç‚¸å‘å¤–éƒ½ä¼šåŒæ—¶å‘ç”Ÿã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line">adjustParticleFill = (_particleColor, value) =&gt; &#123;</div><div class="line">    var _currentFill = _particleColor.__getAnimatedValue(),</div><div class="line">    _particleFill = _currentFill === 5 ? 0 : _currentFill + 1;</div><div class="line"></div><div class="line">    Animated.timing(_particleColor, &#123;</div><div class="line">        duration: 16,</div><div class="line">        toValue: _particleFill</div><div class="line">    &#125;).start()</div><div class="line">&#125;</div><div class="line"></div><div class="line">_handleAddFirework = (e) =&gt; &#123;</div><div class="line">    //...</div><div class="line"></div><div class="line">    _shootingPosition.addListener(this.adjustShootingFill.bind(null, _shootingColor));</div><div class="line">    _particleRadius.addListener(this.adjustParticleFill.bind(null, _particleColor));</div><div class="line">    </div><div class="line">    //...</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ€åæˆ‘ä»¬éœ€è¦å»æ”¹å˜ç²’å­çš„é¢œè‰²ã€‚æ‰€ä»¥åƒä¹‹å‰é‚£æ ·ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå›è°ƒå‡½æ•°å»ç›‘å¬ç²’å­çš„åŠå¾„å˜åŒ–ã€‚ä¸åŒçš„æ˜¯ï¼Œç°åœ¨æˆ‘ä»¬æœ‰5ç§é¢œè‰²éœ€è¦å˜åŒ–ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬è¦å¼€å§‹æ¸²æŸ“æ–°çš„æ•ˆæœäº†ï¼Œæˆ‘ä»¬å°†ç§»åˆ°ä¸€ä¸ªä¸åŒçš„å‡½æ•°é‡Œé¢å»å¤„ç†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;Surface width=&#123;width&#125; height=&#123;height&#125;&gt;</div><div class="line">  &#123;this.getFireworks()&#125;</div><div class="line">&lt;/Surface&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">getFireworks = () =&gt; &#123;</div><div class="line">       return this.state.fireworks.map((firework, i) =&gt; &#123;</div><div class="line"></div><div class="line">           var _shootingFill = firework.shootingColor.interpolate(&#123;</div><div class="line">               inputRange: [0,1],</div><div class="line">               outputRange: SHOOTING_COLORS</div><div class="line">           &#125;);</div><div class="line"></div><div class="line">           var _particleFill = firework.particleColor.interpolate(&#123;</div><div class="line">               inputRange: [0,1,2,3,4],</div><div class="line">               outputRange: PARTICLE_COLORS</div><div class="line">           &#125;);</div><div class="line"></div><div class="line">           return (</div><div class="line">               &lt;AnimatedGroup</div><div class="line">                   x=&#123;firework.shootingPosition.x&#125;</div><div class="line">                   y=&#123;firework.shootingPosition.y&#125;</div><div class="line">                   key=&#123;&quot;group_&quot;+i&#125;</div><div class="line">               &gt;</div><div class="line">                   &lt;AnimatedCircle</div><div class="line">                       opacity=&#123;firework.coreOpacity&#125;</div><div class="line">                       radius=&#123;MORTAR_RADIUS&#125;</div><div class="line">                       fill=&#123;_shootingFill&#125;</div><div class="line">                       key=&#123;&quot;circle_&quot;+i&#125;</div><div class="line">                   /&gt;</div><div class="line">                   &lt;Group&gt;</div><div class="line">                       &#123;</div><div class="line">                           PARTICLE_COUNT.map((v, j) =&gt; &#123;</div><div class="line">                               return &lt;AnimatedCircle</div><div class="line">                                   x=&#123;firework.particlePositions[j].x&#125;</div><div class="line">                                   y=&#123;firework.particlePositions[j].y&#125;</div><div class="line">                                   key=&#123;&quot;particles_&quot;+j&#125;</div><div class="line">                                   scaleX=&#123;firework.particleRadius&#125;</div><div class="line">                                   scaleY=&#123;firework.particleRadius&#125;</div><div class="line">                                   radius=&#123;PARTICLE_RADIUS&#125;</div><div class="line">                                   fill=&#123;_particleFill&#125;</div><div class="line">                               /&gt;</div><div class="line">                           &#125;)</div><div class="line">                       &#125;</div><div class="line">                   &lt;/Group&gt;</div><div class="line">               &lt;/AnimatedGroup&gt;</div><div class="line">           );</div><div class="line">       &#125;)</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>è¿˜æ˜¯å’Œä¹‹å‰å˜æ¢ç‚®å¼¹é¢œè‰²ä¸€æ ·ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨interpolationæ¥å˜åŒ–ç²’å­çš„5ç§é¢œè‰²ã€‚</p>
<p>è¿™é‡Œä¸åŒçš„æ˜¯ä½¿ç”¨AnimatedGroupï¼Œæˆ‘ä»¬å°†åæ ‡ä»x,yè®¾ç½®åˆ°AnimatedGroupä¸­ã€‚</p>
<p>AnimatedGroupæ‰“åŒ…äº†ç‚®å¼¹å’Œæ‰€æœ‰çš„ç²’å­ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥è®©æˆ‘ä»¬çš„ç²’å­ä»0,0å¼€å§‹å‘å¤–ç§»åŠ¨ï¼ŒAnimatedGroupå°†ç¡®ä¿æ‰€æœ‰çš„åæ ‡éƒ½èƒ½æ­£ç¡®å¤„ç†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;AnimatedCircle</div><div class="line">  opacity=&#123;firework.coreOpacity&#125;</div><div class="line">  radius=&#123;MORTAR_RADIUS&#125;</div><div class="line">  fill=&#123;_shootingFill&#125;</div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°æŠŠcoreOpacityåŠ¨ç”»æ”¾åœ¨ç²’å­è¿™ï¼Œç„¶åä»–å°†åœ¨200æ¯«ç§’å†…æ¶ˆå¤±ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;Group&gt;</div><div class="line">  &#123;</div><div class="line">    PARTICLE_COUNT.map((v, j) =&gt; &#123;</div><div class="line">      return &lt;AnimatedCircle</div><div class="line">        x=&#123;firework.particlePositions[j].x&#125;</div><div class="line">        y=&#123;firework.particlePositions[j].y&#125;</div><div class="line">        key=&#123;&quot;particles_&quot;+j&#125;</div><div class="line">        scaleX=&#123;firework.particleRadius&#125;</div><div class="line">        scaleY=&#123;firework.particleRadius&#125;</div><div class="line">        radius=&#123;PARTICLE_RADIUS&#125;</div><div class="line">        fill=&#123;_particleFill&#125;</div><div class="line">      /&gt;</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&lt;/Group&gt;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æŠŠç²’å­éƒ½æ”¾åœ¨Groupç»„ä»¶é‡Œã€‚æˆ‘ä»¬æ˜ å°„å‡º20ä¸ªç²’å­ï¼Œxå’Œyçš„å€¼ç”±getXYParticleå‡½æ•°æ¥ç¡®å®šã€‚</p>
<p>ä½ å¯ä»¥æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬æŠŠparticleRadiusä¼ é€’ç»™äº†scaleXå’ŒscaleYå±æ€§ï¼Œå› ä¸ºAnimatedCircleå¸¦æœ‰çš„radiuså±æ€§ä¸å…·æœ‰å¯åŠ¨ç”»æ€§ï¼Œæ‰€ä»¥é€šè¿‡ç¼©æ”¾åˆ°0çš„æ–¹å¼æ¥å®Œå…¨éšè—ã€‚</p>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶æ‰©å¤§åˆ°å®Œæ•´çš„å°ºå¯¸ï¼Œå¹¶ä½¿å…¶çœ‹èµ·æ¥åƒçˆ†ç‚¸ä¸€æ ·ï¼Œè¿™æ ·å®é™…ä¸Šçš„æ•ˆæœæ›´å¥½ã€‚</p>
<p>æœ€åæˆ‘ä»¬ä½¿ç”¨åœ¨é¡¶éƒ¨å®šä¹‰çš„PARTICLE_RADIUSï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªç‚®å¼¹çš„å¤§å°ï¼Œç„¶åå°†_particleFillè®¾ç½®ä¸ºè¿™5ç§é¢œè‰²çš„interpolationã€‚</p>
<h2 id="å‘å°„"><a href="#å‘å°„" class="headerlink" title="å‘å°„"></a>å‘å°„</h2><p>å®Œå·¥ï¼æˆ‘ä»¬æœ‰äº†ğŸ‰ï¼<br>è¿è¡Œèµ·æ¥å°±å¯ä»¥çœ‹åˆ°æ•ˆæœ</p>
<p><img src="http://7oxfjd.com2.z0.glb.qiniucdn.com/2018-03-21-preview_3.gif" alt="preview_3"></p>
<h3 id="Final-Code"><a href="#Final-Code" class="headerlink" title="Final Code"></a>Final Code</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">import React, &#123;</div><div class="line">    Component</div><div class="line">&#125;from &apos;react&apos;;</div><div class="line"></div><div class="line">import &#123;</div><div class="line">    ART as Art,</div><div class="line">    StyleSheet,</div><div class="line">    View,</div><div class="line">    Dimensions,</div><div class="line">    TouchableWithoutFeedback,</div><div class="line">    Animated</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line"></div><div class="line">var &#123;</div><div class="line">    width,</div><div class="line">    height</div><div class="line">&#125; = Dimensions.get(&apos;window&apos;);</div><div class="line"></div><div class="line">var &#123;</div><div class="line">    Surface,</div><div class="line">    Shape,</div><div class="line">    Path,</div><div class="line">    Group,</div><div class="line">    Transform</div><div class="line">&#125; = Art;</div><div class="line"></div><div class="line">var AnimatedShape = Animated.createAnimatedComponent(Shape);</div><div class="line">var AnimatedGroup = Animated.createAnimatedComponent(Group);</div><div class="line"></div><div class="line">const MORTAR_RADIUS = 5</div><div class="line"></div><div class="line">const SHOOTING_COLORS = [</div><div class="line">    &apos;rgb(234,238,112)&apos;, //Yellow</div><div class="line">    &apos;rgb(245,137,12)&apos; //Orange</div><div class="line">];</div><div class="line"></div><div class="line">const PARTICLE_RADIUS = 30; // ç‚¸å¼€ç²’å­çš„èŒƒå›´åŠå¾„</div><div class="line">const PARTICLE_COUNT = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]; // æ¯ä¸ªçˆ†å¼€æœ‰å¤šå°‘ç²’å­</div><div class="line"></div><div class="line">//ç²’å­çš„é¢œè‰²å˜åŒ–åŸŸ</div><div class="line">const PARTICLE_COLORS = [</div><div class="line">    &apos;rgba(54, 17, 52, 100)&apos;,</div><div class="line">    &apos;rgba(176, 34, 140, 100)&apos;,</div><div class="line">    &apos;rgba(234, 55, 136, 100)&apos;,</div><div class="line">    &apos;rgba(229, 107, 112, 100)&apos;,</div><div class="line">    &apos;rgba(243, 145, 160, 100)&apos;</div><div class="line">]</div><div class="line"></div><div class="line">export default class App extends Component&lt;Props&gt; &#123;</div><div class="line">    state = &#123;</div><div class="line">        fireworks: []</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    adjustShootingFill = (_shootingColor, value) =&gt; &#123;</div><div class="line">        Animated.timing(_shootingColor, &#123;</div><div class="line">            duration: 16,</div><div class="line">            toValue: _shootingColor.__getAnimatedValue() == 0 ? 1 : 0</div><div class="line">        &#125;).start()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    adjustParticleFill = (_particleColor, value) =&gt; &#123;</div><div class="line">        var _currentFill = _particleColor.__getAnimatedValue(),</div><div class="line">        _particleFill = _currentFill === 5 ? 0 : _currentFill + 1;</div><div class="line"></div><div class="line">        Animated.timing(_particleColor, &#123;</div><div class="line">            duration: 16,</div><div class="line">            toValue: _particleFill</div><div class="line">        &#125;).start()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    _handleAddFirework = (e) =&gt; &#123;</div><div class="line">        var _shootingPosition = new Animated.ValueXY(&#123;x: width/2, y: height - MORTAR_RADIUS&#125;);</div><div class="line">        var _shootingColor = new Animated.Value(0);</div><div class="line">        var _particleColor = new Animated.Value(0);</div><div class="line">        var _particleRadius = new Animated.Value(0);</div><div class="line">        var _coreOpacity = new Animated.Value(1);</div><div class="line"></div><div class="line">        var _particlePositions = PARTICLE_COUNT.map(() =&gt; new Animated.ValueXY(&#123;x: 0, y: 0&#125;));</div><div class="line"></div><div class="line">        this.state.fireworks.push(&#123;</div><div class="line">            shootingPosition: _shootingPosition,</div><div class="line">            shootingColor: _shootingColor,</div><div class="line">            particleColor: _particleColor,</div><div class="line">            particleRadius: _particleRadius,</div><div class="line">            coreOpacity: _coreOpacity,</div><div class="line">            particlePositions: _particlePositions</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        _shootingPosition.addListener(this.adjustShootingFill.bind(null, _shootingColor));</div><div class="line">        _particleRadius.addListener(this.adjustParticleFill.bind(null, _particleColor));</div><div class="line"></div><div class="line">        function getXYParticle(total, i, radius) &#123;</div><div class="line">            var angle = 360/total*i;</div><div class="line"></div><div class="line">            var x = Math.round((radius*2) * Math.cos(angle - (Math.PI/2)));</div><div class="line">            var y = Math.round((radius*2) * Math.sin(angle - (Math.PI/2)));</div><div class="line"></div><div class="line">            return &#123;</div><div class="line">                x: x,</div><div class="line">                y: y</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        var _animatedParticles = [</div><div class="line">            Animated.timing(_particleRadius, &#123;</div><div class="line">                duration: 700,</div><div class="line">                toValue: 1</div><div class="line">            &#125;),</div><div class="line">            Animated.timing(_coreOpacity, &#123;</div><div class="line">                duration: 200,</div><div class="line">                toValue: 0</div><div class="line">            &#125;)</div><div class="line">        ]</div><div class="line"></div><div class="line">        var _movingParticles = _particlePositions.map((particle, i) =&gt; &#123;</div><div class="line">            var _xy = getXYParticle(PARTICLE_COUNT.length, i, PARTICLE_RADIUS);</div><div class="line">            return Animated.timing(particle, &#123;</div><div class="line">                duration: 250,</div><div class="line">                toValue: _xy</div><div class="line">            &#125;)</div><div class="line">        &#125;)</div><div class="line"></div><div class="line">        _animatedParticles = _animatedParticles.concat(_movingParticles);</div><div class="line"></div><div class="line">        Animated.sequence([</div><div class="line">            Animated.timing(_shootingPosition, &#123;</div><div class="line">                duration: 300,</div><div class="line">                toValue: &#123;</div><div class="line">                    y: e.nativeEvent.locationY,</div><div class="line">                    x: e.nativeEvent.locationX</div><div class="line">                &#125;</div><div class="line">            &#125;),</div><div class="line">            Animated.parallel(_animatedParticles)</div><div class="line">        ]).start(this.removeSelf.bind(this, _shootingPosition));</div><div class="line"></div><div class="line">        this.setState(this.state);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    removeSelf = (_shootingPosition)=&gt; &#123;</div><div class="line">        this.setState(&#123;</div><div class="line">            fireworks: this.state.fireworks.filter((firework) =&gt; firework.shootingPosition !== _shootingPosition)</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    getFireworks = () =&gt; &#123;</div><div class="line">        return this.state.fireworks.map((firework, i) =&gt; &#123;</div><div class="line"></div><div class="line">            var _shootingFill = firework.shootingColor.interpolate(&#123;</div><div class="line">                inputRange: [0,1],</div><div class="line">                outputRange: SHOOTING_COLORS</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">            var _particleFill = firework.particleColor.interpolate(&#123;</div><div class="line">                inputRange: [0,1,2,3,4],</div><div class="line">                outputRange: PARTICLE_COLORS</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">            return (</div><div class="line">                &lt;AnimatedGroup</div><div class="line">                    x=&#123;firework.shootingPosition.x&#125;</div><div class="line">                    y=&#123;firework.shootingPosition.y&#125;</div><div class="line">                    key=&#123;&quot;group_&quot;+i&#125;</div><div class="line">                &gt;</div><div class="line">                    &lt;AnimatedCircle</div><div class="line">                        opacity=&#123;firework.coreOpacity&#125;</div><div class="line">                        radius=&#123;MORTAR_RADIUS&#125;</div><div class="line">                        fill=&#123;_shootingFill&#125;</div><div class="line">                        key=&#123;&quot;circle_&quot;+i&#125;</div><div class="line">                    /&gt;</div><div class="line">                    &lt;Group&gt;</div><div class="line">                        &#123;</div><div class="line">                            PARTICLE_COUNT.map((v, j) =&gt; &#123;</div><div class="line">                                return &lt;AnimatedCircle</div><div class="line">                                    x=&#123;firework.particlePositions[j].x&#125;</div><div class="line">                                    y=&#123;firework.particlePositions[j].y&#125;</div><div class="line">                                    key=&#123;&quot;particles_&quot;+j&#125;</div><div class="line">                                    scaleX=&#123;firework.particleRadius&#125;</div><div class="line">                                    scaleY=&#123;firework.particleRadius&#125;</div><div class="line">                                    radius=&#123;PARTICLE_RADIUS&#125;</div><div class="line">                                    fill=&#123;_particleFill&#125;</div><div class="line">                                /&gt;</div><div class="line">                            &#125;)</div><div class="line">                        &#125;</div><div class="line">                    &lt;/Group&gt;</div><div class="line">                &lt;/AnimatedGroup&gt;</div><div class="line">            );</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    render()&#123;</div><div class="line">        return (</div><div class="line">            &lt;View style=&#123;styles.container&#125;&gt;</div><div class="line">                &lt;TouchableWithoutFeedback onPress=&#123;this._handleAddFirework&#125; &gt;</div><div class="line">                    &lt;View&gt;</div><div class="line">                        &lt;Surface width=&#123;width&#125; height=&#123;height&#125;&gt;</div><div class="line">                            &#123;this.getFireworks()&#125;</div><div class="line">                        &lt;/Surface&gt;</div><div class="line">                    &lt;/View&gt;</div><div class="line">                &lt;/TouchableWithoutFeedback&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var styles = StyleSheet.create(&#123;</div><div class="line">    container: &#123;</div><div class="line">        flex: 1,</div><div class="line">        flexDirection: &apos;column&apos;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">class AnimatedCircle extends Component&lt;Props&gt; &#123;</div><div class="line">    render()&#123;</div><div class="line">        var radius = this.props.radius;</div><div class="line">        var path = Path().moveTo(0, -radius)</div><div class="line">            .arc(0, radius * 2, radius)</div><div class="line">            .arc(0, radius * -2, radius)</div><div class="line">            .close();</div><div class="line">        return (</div><div class="line">            &lt;AnimatedShape d=&#123;path&#125;  &#123;...this.props&#125;/&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/react-native/" rel="tag">#react-native</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/02/01/iOSä½åŠŸè€—è“ç‰™å¼€å‘æŒ‡è¥¿-è¯‘/" rel="next" title="iOSä½åŠŸè€—è“ç‰™å¼€å‘æŒ‡è¥¿[è¯‘]">
                <i class="fa fa-chevron-left"></i> iOSä½åŠŸè€—è“ç‰™å¼€å‘æŒ‡è¥¿[è¯‘]
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/03/26/React-Native-Animated-åˆ’é‡ç‚¹ï¼šä¸¤ä¸ªç»†èŠ‚æ’æŸ¥ä¸¤ä¸ªå°æ—¶/" rel="prev" title="React-Native Animated åˆ’é‡ç‚¹ï¼šä¸¤ä¸ªç»†èŠ‚æ’æŸ¥ä¸¤ä¸ªå°æ—¶">
                React-Native Animated åˆ’é‡ç‚¹ï¼šä¸¤ä¸ªç»†èŠ‚æ’æŸ¥ä¸¤ä¸ªå°æ—¶ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Inhaltsverzeichnis
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Ãœbersicht
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="David Woo" />
          <p class="site-author-name" itemprop="name">David Woo</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/">
              <span class="site-state-item-count">112</span>
              <span class="site-state-item-name">Artikel</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">195</span>
                <span class="site-state-item-name">Kategorien</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">Tags</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#ä»‹ç»"><span class="nav-number">1.</span> <span class="nav-text">ä»‹ç»</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æœ€ç»ˆæ•ˆæœ"><span class="nav-number">2.</span> <span class="nav-text">æœ€ç»ˆæ•ˆæœ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#start-project"><span class="nav-number">3.</span> <span class="nav-text">start project</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è®©ç‚®å¼¹é£ä¸€ä¼š"><span class="nav-number">4.</span> <span class="nav-text">è®©ç‚®å¼¹é£ä¸€ä¼š</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¶ˆå¤±çš„ç‚®å¼¹"><span class="nav-number">5.</span> <span class="nav-text">æ¶ˆå¤±çš„ç‚®å¼¹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é€ƒç¦»é»‘ç™½ä¸–ç•Œ"><span class="nav-number">6.</span> <span class="nav-text">é€ƒç¦»é»‘ç™½ä¸–ç•Œ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç‚¸è£‚å§ï¼Œç‚®å¼¹"><span class="nav-number">7.</span> <span class="nav-text">ç‚¸è£‚å§ï¼Œç‚®å¼¹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‘å°„"><span class="nav-number">8.</span> <span class="nav-text">å‘å°„</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Final-Code"><span class="nav-number">8.1.</span> <span class="nav-text">Final Code</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">David Woo</span>
</div>

<div class="powered-by">
  Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>

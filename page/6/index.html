<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="大胃吴的闲话唠嗑">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="大胃吴的闲话唠嗑">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="大胃吴的闲话唠嗑">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/page/6/"/>

  <title> 大胃吴的闲话唠嗑 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">大胃吴的闲话唠嗑</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">扯扯技术，唠唠闲话</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-首页">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            menu.首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-文章">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            menu.文章
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/20/2014-05-20-everythis-is-in-our-store-2/" itemprop="url">
                  Everythis is store书载(2)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2014-05-20T14:32:00+08:00" content="2014-05-20">
              2014-05-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/" itemprop="url" rel="index">
                    <span itemprop="name">Amazon</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/" itemprop="url" rel="index">
                    <span itemprop="name">bezos</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/一网打尽/" itemprop="url" rel="index">
                    <span itemprop="name">一网打尽</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/一网打尽/EverythisIsStore/" itemprop="url" rel="index">
                    <span itemprop="name">EverythisIsStore</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>有一次散步时，卡芬问贝佐斯，既然他们现在已经实现了一些早期目标，为何还极力向外扩张。贝佐斯回答：“当公司规模还非常弱小时，其他大公司会随时出现，并且极力抢夺你的果实。因此我们必须平衡竞争力量，来和那些老牌图书销售商抗衡。”</p>
<p>每天一睁眼就要有忧患意识，但不用关注我们的对手，因为他们不会给我们送钱。让我们更关注顾客吧，各位一定要脚踏实地。</p>
<p>首次公开募股前，贝佐斯和他的这位老搭档一同散步，告诉他公司需要更强的技术管理人员，然后想任命他为亚马逊的首席技术官。这听起来像是升职了，但实际上，卡芬将变成一个顾问的角色，既不需要做预算，也不需要负直接责任。卡芬想了几天，没答应，但贝佐斯知道卡芬的性格，然后说“让它过去吧”,就再也没提这事了。</p>
<p>这时，两个承诺发生了冲突。贝佐斯曾向卡芬承诺，可以永久保留他的工作。但亚马逊的创始人还向公司和投资人承诺，他将会提高应聘标准，亚马逊的命运与招募的技术人员的能力息息相关。瑞克·达尔泽尔和乔尔·施皮格尔两人擅长于公司政治；而卡芬是一位性格内向的电脑奇才，有些过于理想化，缺乏领导才能事实上，他已经不再插手员工招聘和壮大自己部门的工作了。但他却默默地为亚马逊奉献了自己，并且帮助亚马逊确立了世界地位。回首当年，贝佐斯的电子表格上就是一串虚无缥缈的数字而已。</p>
<p>年来的历程却感到有些酸楚。他把贝佐斯不让他参与亚马逊决策一事称为“是对信任的一种背叛”，忘了当初两人共同创业时的艰辛。卡芬说，他得到的是“一生中最令他失望的一次遭遇”。</p>
<p>这些不满是许多亚马逊老员工相同境遇的浓缩版。由于贝佐斯令人信服的信条，使得所有员工都怀有一种信念，他们确实也得到了丰厚的回报。但这位眼神坚定的创始人最终还是把他们解雇了，取而代之的是拥有新观念和更多经验的人。公司前进中，再也看不到这些老员工的身影了，这实在让人心酸，好像是他的孩子离开了家，又搬到了另一个家。最终，Bezos向卡芬坦言，亚马逊只有一个真正的父亲。</p>
<p>当我们看到获得市场领先地位的可能性很大时，做投资决定就要大胆，而不要畏首畏尾。这些投资有些会获得回报，有些则不能，但我们从二者中都会吸取宝贵的经验。</p>
<p>贝佐斯强调亚马逊日常运行中的节俭习惯。他让员工付停车费，并要求所有高管出差坐经济舱。</p>
<p>贝佐斯吸取了沃尔顿自传中的精华，而且沿用沃尔玛创始人的节俭作风以及“崇尚行动”的做法，并使其融入了亚马逊的文化中。</p>
<p><strong>沃尔玛式的传奇在今天这个时代还能重现吗？我的答案是，当然还会。或许现在就有人正在跃跃欲试——或许有成千上万的人在做——他们有足够多的创意支持其一路走下去。假如有人非常热切地追求自己心中的梦想，虽然期间会经历很多的失败，但也要锲而不舍地坚持下去。这全仰仗一个人的态度和能力，要不断研究和探寻商业管理的秘诀。</strong></p>
<p>杰夫·贝佐斯就具备了山姆·沃尔顿所描绘的那些品质。他一直不愿意让亚马逊屈从于任何官僚的慵懒作风，希望不断有新的想法涌现，想方设法改进网站的过去做法，以吸引更多的顾客，始终走在对手的前头。</p>
<p>谁也不能跟杰夫·贝佐斯合作，而只能替他卖命。</p>
<p>Bezos把亚马逊定义为一家以顾客为中心的公司，而并非以竞争者为核心的公司。</p>
</blockquote>
<p><em>但后来事实证明，Bezos在易趣的竞争下，单纯为了竞争，下了很多昏招。</em></p>
<blockquote>
<p><strong>五项狠心价值：顾客至上（ customer   obsession）、 勤俭节约（ frugality）、 崇尚行动（ bias   for   action）、 主人翁精神（ ownership） 和人才招聘的高标准（ high   bar   talent）。 后来又加上一条：创新（ innovation ）</strong></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/20/2014-05-20-implementation-of-davidpotter/" itemprop="url">
                  DavidPotter的实现、cucumber实现BDD开发
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2014-05-20T12:25:00+08:00" content="2014-05-20">
              2014-05-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/" itemprop="url" rel="index">
                    <span itemprop="name">UML</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/" itemprop="url" rel="index">
                    <span itemprop="name">BDD</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/" itemprop="url" rel="index">
                    <span itemprop="name">TDD</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/设计/" itemprop="url" rel="index">
                    <span itemprop="name">设计</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/设计/KataPotter/" itemprop="url" rel="index">
                    <span itemprop="name">KataPotter</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/设计/KataPotter/cucumber/" itemprop="url" rel="index">
                    <span itemprop="name">cucumber</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/设计/KataPotter/cucumber/责任链设计模式/" itemprop="url" rel="index">
                    <span itemprop="name">责任链设计模式</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/设计/KataPotter/cucumber/责任链设计模式/面向接口/" itemprop="url" rel="index">
                    <span itemprop="name">面向接口</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="DavidPotter实现"><a href="#DavidPotter实现" class="headerlink" title="#DavidPotter实现"></a>#DavidPotter实现</h2><p><img src="http://i1.tietuku.com/13ad8e00f1cf9723s.png" alt=""><br><a href="https://github.com/yuezaixz/DavidPotter" target="_blank" rel="external">代码Github地址</a></p>
<h2 id="包结构"><a href="#包结构" class="headerlink" title="包结构"></a>包结构</h2><p><img src="http://d2.freep.cn/3tb_140520204718v75v531911.jpg" alt=""></p>
<ol>
<li>按照UML设计图，进行了包结构划分；</li>
<li>每个分包中基本都含有接口和实现类；</li>
<li>每个包职责分明，遵循单一原则；</li>
</ol>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>不具体说明所有代码，具体分析几个主要的类。</p>
<h2 id="Basket"><a href="#Basket" class="headerlink" title="# Basket"></a># Basket</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Basket</span> </span>&#123;</div><div class="line"></div><div class="line">    Map&lt;String, SeriesseriesMap = <span class="keyword">new</span> HashMap&lt;String, Series&gt;();</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> IBasketFactory factory;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">Basket</span><span class="params">(<span class="keyword">final</span> Series... inputSeries)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">final</span> Series serie : inputSeries) &#123;</div><div class="line">            <span class="keyword">this</span>.seriesMap.put(serie.getSeriesName(), serie);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNoEmptySeriesSize</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (Series serie : seriesMap.values()) &#123;</div><div class="line">            <span class="keyword">if</span> (!serie.isEmpty()) &#123;</div><div class="line">                num++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> num;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Price <span class="title">howMany</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">areThereAnyBooksLeft</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (Series serie : seriesMap.values()) &#123;</div><div class="line">            <span class="keyword">if</span> (!serie.isEmpty()) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">bookNum</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> bookNum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (Series serie : seriesMap.values()) &#123;</div><div class="line">            bookNum += serie.length();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> bookNum;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">push</span><span class="params">(String name, Book... books)</span> </span>&#123;</div><div class="line">        Series series = seriesMap.get(name);</div><div class="line">        <span class="keyword">if</span> (series == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (Book book : books) &#123;</div><div class="line">            series.push(book);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">popForEachSeriesBox</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (Series serie : seriesMap.values()) &#123;</div><div class="line">            <span class="keyword">if</span> (!serie.isEmpty()) &#123;</div><div class="line">                serie.pop();</div><div class="line">                num++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> num;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Basket <span class="title">pop</span><span class="params">(<span class="keyword">int</span> bookNum)</span> </span>&#123;</div><div class="line">        Basket emptyBasket = factory.getEmptyBasket();</div><div class="line">        <span class="keyword">int</span> noEmptySeriesSize = getNoEmptySeriesSize();</div><div class="line">        <span class="keyword">if</span> (noEmptySeriesSize &gt;= bookNum) &#123;</div><div class="line">            <span class="keyword">for</span> (Series serie : seriesMap.values()) &#123;</div><div class="line">                <span class="keyword">if</span> (!serie.isEmpty()) &#123;</div><div class="line">                    emptyBasket.push(serie.getSeriesName(), serie.pop());</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> emptyBasket;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Book <span class="title">popByName</span><span class="params">(<span class="keyword">int</span> seriesName)</span> </span>&#123;</div><div class="line">        Series series = seriesMap.get(seriesName);</div><div class="line">        <span class="keyword">return</span> series.isEmpty() ? <span class="keyword">null</span> : series.pop();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span>[][] convertBasketToTwoDArray();</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> seriesMap.toString();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(<span class="keyword">final</span> Object obj)</span> </span>&#123;</div><div class="line">        Basket target = (Basket) obj;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.seriesMap.equals(target.seriesMap);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>该类为购物车的抽象类，内部的数据结构通过系列名称和系列数据结构的Map来实现，是该codejourney的核心数据结构之一。<br>该类将一些购物车的特征性方法封装，比如获取购物车中的图书类数，是否还有书，剩余书的数量，向购物车内新增图书，    将购物车中所有类别书各取出一本，取出指定本书，根据书的类名取出图书。<br>另外，还对一些方法进行了抽象，比如当前购物车所有书籍折前价格，打印当前购物车的情况，将当前购物车转换成二维数组的数据结构，这些抽象方法通过子类来分别实现。因为这些方法都是面向具体实现的。</p>
<h2 id="Series"><a href="#Series" class="headerlink" title="# Series"></a># Series</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Series</span> <span class="keyword">implements</span> <span class="title">ISeries</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Book[] books = <span class="keyword">new</span> Book[<span class="number">16</span>];</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String seriesName;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Series</span><span class="params">(String seriesName)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.seriesName = seriesName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Series</span><span class="params">(String seriesName,Book ... books)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.seriesName = seriesName;</div><div class="line">        <span class="keyword">this</span>.books = books;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSeriesName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> seriesName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSeriesName</span><span class="params">(String seriesName)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.seriesName = seriesName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> size == <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">// 将数组中的数据置为null, 方便GC进行回收</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</div><div class="line">            books[size] = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        size = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">length</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> size;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">push</span><span class="params">(Book data)</span> </span>&#123;</div><div class="line">        <span class="comment">// 判断是否需要进行数组扩容</span></div><div class="line">        <span class="keyword">if</span> (size &gt;= books.length) &#123;</div><div class="line">            resize();</div><div class="line">        &#125;</div><div class="line">        books[size++] = data;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 数组扩容</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">resize</span><span class="params">()</span> </span>&#123;</div><div class="line">        Book[] temp = <span class="keyword">new</span> Book[books.length * <span class="number">3</span> / <span class="number">2</span> + <span class="number">1</span>];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</div><div class="line">            temp[i] = books[i];</div><div class="line">            books[i] = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        books = temp;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Book <span class="title">pop</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> (Book) books[--size];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        sb.append(<span class="string">"MyArrayStack: ["</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</div><div class="line">            sb.append(books[i].toString());</div><div class="line">            <span class="keyword">if</span> (i != size - <span class="number">1</span>) &#123;</div><div class="line">                sb.append(<span class="string">", "</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        sb.append(<span class="string">"]"</span>);</div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>该类内部数据结构为数组，通过数组实现了一个简易的类似栈，可以向栈内pop和push图书。是该codejourney的核心数据结构之一。</p>
<h2 id="PotterStrategy"><a href="#PotterStrategy" class="headerlink" title="# PotterStrategy"></a># PotterStrategy</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PotterStrategy</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = Logger.getLogger(PotterStrategy.class.getName());</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;StringPOTTER_SERIES_NAME_LIST = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">    <span class="keyword">static</span>&#123;</div><div class="line">        POTTER_SERIES_NAME_LIST.add(<span class="string">"Harry Potter and the Philosopher's Stone"</span>);</div><div class="line">        POTTER_SERIES_NAME_LIST.add(<span class="string">"Harry Potter and the Chamber of Secrets"</span>);</div><div class="line">        POTTER_SERIES_NAME_LIST.add(<span class="string">"Harry Potter and the Prisoner of Azkaban"</span>);</div><div class="line">        POTTER_SERIES_NAME_LIST.add(<span class="string">"Harry Potter and the Goblet of Fire"</span>);</div><div class="line">        POTTER_SERIES_NAME_LIST.add(<span class="string">"Harry Potter and the Order of Phoenix"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Price PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT = <span class="keyword">new</span> Price(<span class="number">800</span>);</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_SERIES_NUMBER = <span class="number">5</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Price CHEAPER_BY_FIVE_THREE_PATTERN = <span class="keyword">new</span> Price(<span class="number">40</span>);</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> FIVE_THREE_PATTERN_FIVE = <span class="number">5</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> FIVE_THREE_PATTERN_THREE = <span class="number">3</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_NUMBER_OF_COPIES_FOR_EACH_SERIES = <span class="number">10</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> DISCOUNT_FOR_TWO_SERIES = <span class="number">0.95</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> DISCOUNT_FOR_THREE_SERIES = <span class="number">0.9</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> DISCOUNT_FOR_FOUR_SERIES = <span class="number">0.8</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> DISCOUNT_FOR_FIVE_SERIES = <span class="number">0.75</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] differentSeriesCount = <span class="keyword">new</span> <span class="keyword">int</span>[PotterStrategy.MAX_NUMBER_OF_COPIES_FOR_EACH_SERIES];</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PotterStrategy</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">// To turn on logging, set level to be Level.INFO.</span></div><div class="line">        LOGGER.setLevel(Level.OFF);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasFiveThreePattern</span><span class="params">(Basket shoppingBasket)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span>[][] basketTwoDArray = shoppingBasket.convertBasketToTwoDArray();</div><div class="line">        countDifferentSeries(basketTwoDArray);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; differentSeriesCount.length - <span class="number">1</span>; i++) &#123;</div><div class="line">            LOGGER.info(<span class="string">"==Going to check differentSeriesCount["</span> + i + <span class="string">"]: "</span> + differentSeriesCount[i] + <span class="string">"; differentSeriesCount["</span> + (i+<span class="number">1</span>) + <span class="string">"]: "</span> + differentSeriesCount[i+<span class="number">1</span>]);</div><div class="line">            <span class="keyword">if</span> (differentSeriesCount[i] == FIVE_THREE_PATTERN_FIVE &amp;&amp; differentSeriesCount[i+<span class="number">1</span>] == FIVE_THREE_PATTERN_THREE) &#123;</div><div class="line">                LOGGER.info(<span class="string">"==Found five three pattern."</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">countDifferentSeries</span><span class="params">(<span class="keyword">int</span>[][] basketTwoDArray)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; differentSeriesCount.length; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; basketTwoDArray.length; j++) &#123;</div><div class="line">                count += basketTwoDArray[j][i];</div><div class="line">            &#125;</div><div class="line">            differentSeriesCount[i] = count;</div><div class="line">            count = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        printDifferentSeriesCount(differentSeriesCount);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printDifferentSeriesCount</span><span class="params">(<span class="keyword">int</span>[] differentSeriesCount)</span> </span>&#123;</div><div class="line">        LOGGER.info(<span class="string">"==different series count: "</span> + Arrays.toString(differentSeriesCount));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getSeriesNumOfBookName</span><span class="params">(<span class="keyword">int</span> seriesNumOfBook)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> POTTER_SERIES_NAME_LIST.get(seriesNumOfBook-<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>该类的作用主要是提供一些常量（比如折扣、价格、书的类别及名字）及静态方法（判断是否存在5-3的情况和一些日志打印静态方法）。</p>
<h2 id="handler"><a href="#handler" class="headerlink" title="# handler"></a># handler</h2><p>最核心的处理逻辑还是封装在handler组件中。IHandler为核心接口。使用的是责任链设计模式，这点和FizzBuzzWhizz类似。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IHandler</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(ICalculate calc, PotterStrategy discountStrategy)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PotterHandler</span> <span class="keyword">implements</span> <span class="title">IHandler</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> IHandler nextHandler;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PotterHandler</span><span class="params">(IHandler priceHandler)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.nextHandler = priceHandler;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(ICalculate calc, PotterStrategy discountStrategy)</span> </span>&#123;</div><div class="line">        run(calc, discountStrategy);</div><div class="line">        IHandler nextHandler = getNextHandler();</div><div class="line">        <span class="keyword">if</span> (nextHandler != <span class="keyword">null</span>) &#123;</div><div class="line">            nextHandler.handle(calc, discountStrategy);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(ICalculate calc, PotterStrategy discountStrategy)</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> IHandler <span class="title">getNextHandler</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> nextHandler;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>通过实现该接口的抽象类，该抽象类又用了模板设计模式，将handler方法的责任链处理逻辑封装。子类只需要知道如何实现每个子链条的处理逻辑即可。<br>例如该项目的难点，5-3折扣同时出现的情况下，改用4-4折扣会更优惠，由于，优惠的价格固定为0.4元，所以当这种情况，就调用FiveThreePatternHandler。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FiveThreePatternHandler</span> <span class="keyword">extends</span> <span class="title">PotterHandler</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FiveThreePatternHandler</span><span class="params">(IHandler wordHandler)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(wordHandler);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(ICalculate calc, PotterStrategy discountStrategy)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (calc.hasFiveThreePattern()) &#123;</div><div class="line">            calc.setCalculatedPrice(calc.getCalculatedPrice().minus(PotterStrategy.CHEAPER_BY_FIVE_THREE_PATTERN));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="price"><a href="#price" class="headerlink" title="# price"></a># price</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Price</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">double</span> price;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Price</span><span class="params">(<span class="keyword">final</span> <span class="keyword">double</span> price)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.price = price;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> price;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="string">"Price: "</span> + Double.toString(price);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(<span class="keyword">final</span> Object obj)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> ((Price) obj).price == price;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Double(price).hashCode();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">lowestPrice</span><span class="params">(<span class="keyword">final</span> Price other)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Price(Math.min(price, other.price));</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">add</span><span class="params">(<span class="keyword">final</span> Price other)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Price(price + other.price);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">minus</span><span class="params">(<span class="keyword">final</span> Price other)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Price(price - other.price);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">mul</span><span class="params">(<span class="keyword">final</span> Price other)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Price(price * other.price);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">mul</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> mulNum)</span> </span>&#123;</div><div class="line">	    <span class="keyword">return</span> <span class="keyword">new</span> Price(price * mulNum);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">mul</span><span class="params">(<span class="keyword">final</span> <span class="keyword">double</span> mulNum)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Price(price * mulNum);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>该类主要用于对价格封装，把加减乘除的方法都封装。</p>
<p>#calc<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICalculate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Price <span class="title">getCalculatedPrice</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">setCalculatedPrice</span><span class="params">(Price calculatedPrice)</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">calculate</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printCalc</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">fillSeriesBoxAndCalculatePrice</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">putIntoBasket</span><span class="params">(String seriesName, <span class="keyword">int</span> numberOfBook)</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">putIntoBasket</span><span class="params">(<span class="keyword">int</span> seriesNumberOfBook, <span class="keyword">int</span> numberOfBook)</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">areThereAnyBooksLeft</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">hasFiveThreePattern</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">printBasket</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>该接口封装了很多方法，有些方法可以直接是链式引用，比如hasFiveThreePattern，会通过调用持有的Strategy的相应方法来实现。那接着让我们看看该类的实现类。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PriceCaclulate</span> <span class="keyword">implements</span> <span class="title">ICalculate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Price calculatedPrice = <span class="keyword">new</span> Price(<span class="number">0</span>);</div><div class="line"></div><div class="line">    <span class="keyword">private</span> IHandler handler ;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> PotterStrategy potterStrategy;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Basket potterBasket;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PriceCaclulate</span><span class="params">()</span> </span>&#123;</div><div class="line">        IHandler maxDiffenentSeriesHandler = <span class="keyword">new</span> MaxDifferentSeriesHandler(<span class="keyword">null</span>);</div><div class="line">        potterStrategy = <span class="keyword">new</span> PotterStrategy();</div><div class="line">        handler = <span class="keyword">new</span> FiveThreePatternHandler(</div><div class="line">                maxDiffenentSeriesHandler);</div><div class="line">        potterBasket = BasketFactoryBean.getPotterBasketFactoryInstance().getEmptyBasket();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printCalc</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"购物车中的哈利波特故事书"</span>+<span class="keyword">this</span>.calculatedPrice);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Price <span class="title">getCalculatedPrice</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> calculatedPrice;</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCalculatedPrice</span><span class="params">(Price calculatedPrice)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.calculatedPrice = calculatedPrice;</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">calculate</span><span class="params">()</span> </span>&#123;</div><div class="line">        handler.handle(<span class="keyword">this</span>, <span class="keyword">this</span>.potterStrategy);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fillSeriesBoxAndCalculatePrice</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> seriesNum = potterBasket.popForEachSeriesBox();</div><div class="line">        <span class="keyword">switch</span> (seriesNum) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">            calculatedPrice = calculatedPrice</div><div class="line">                    .add(PotterStrategy.PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">            calculatedPrice = calculatedPrice</div><div class="line">                    .add(PotterStrategy.PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT</div><div class="line">                            .mul(<span class="number">2</span>).mul(PotterStrategy.DISCOUNT_FOR_TWO_SERIES));</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">3</span>:</div><div class="line">            calculatedPrice = calculatedPrice</div><div class="line">                    .add(PotterStrategy.PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT</div><div class="line">                            .mul(<span class="number">3</span>).mul(</div><div class="line">                                    PotterStrategy.DISCOUNT_FOR_THREE_SERIES));</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">4</span>:</div><div class="line">            calculatedPrice = calculatedPrice</div><div class="line">                    .add(PotterStrategy.PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT</div><div class="line">                            .mul(<span class="number">4</span>)</div><div class="line">                            .mul(PotterStrategy.DISCOUNT_FOR_FOUR_SERIES));</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">5</span>:</div><div class="line">            calculatedPrice = calculatedPrice</div><div class="line">                    .add(PotterStrategy.PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT</div><div class="line">                            .mul(<span class="number">5</span>)</div><div class="line">                            .mul(PotterStrategy.DISCOUNT_FOR_FIVE_SERIES));</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(</div><div class="line">                    <span class="string">"the number of series should be within "</span></div><div class="line">                            + PotterStrategy.MAX_SERIES_NUMBER);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">()</span> </span>&#123;</div><div class="line">        calculatedPrice = <span class="keyword">new</span> Price(<span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">putIntoBasket</span><span class="params">(String seriesName, <span class="keyword">int</span> numberOfBook)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numberOfBook; i++) &#123;</div><div class="line">            potterBasket.push(seriesName, <span class="keyword">new</span> Book());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">putIntoBasket</span><span class="params">(<span class="keyword">int</span> seriesNumOfBook, <span class="keyword">int</span> numberOfBook)</span> </span>&#123;</div><div class="line"></div><div class="line">        String seriesName = PotterStrategy.getSeriesNumOfBookName(seriesNumOfBook);</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numberOfBook; i++) &#123;</div><div class="line">            potterBasket.push(seriesName, <span class="keyword">new</span> Book());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">areThereAnyBooksLeft</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> potterBasket.areThereAnyBooksLeft();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasFiveThreePattern</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> potterStrategy.hasFiveThreePattern(potterBasket);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printBasket</span><span class="params">()</span> </span>&#123;</div><div class="line">        potterBasket.print();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>该类依赖了Strategy、Price、Handler、Basket。该类是对外的API接口，使用该组件不需要对组件的内部实现有什么了解。只要知道接口，已经具体需要的实现类，然后调用相应API即可。</p>
<h2 id="调用"><a href="#调用" class="headerlink" title="# 调用"></a># 调用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">ICalculate cacluate = <span class="keyword">new</span> PriceCaclulate();</div><div class="line">cacluate.putIntoBasket(PotterStrategy.getSeriesNumOfBookName(<span class="number">1</span>), <span class="number">1</span>);</div><div class="line">cacluate.putIntoBasket(PotterStrategy.getSeriesNumOfBookName(<span class="number">2</span>), <span class="number">1</span>);</div><div class="line">cacluate.putIntoBasket(PotterStrategy.getSeriesNumOfBookName(<span class="number">3</span>), <span class="number">2</span>);</div><div class="line">cacluate.putIntoBasket(PotterStrategy.getSeriesNumOfBookName(<span class="number">4</span>), <span class="number">1</span>);</div><div class="line">cacluate.putIntoBasket(PotterStrategy.getSeriesNumOfBookName(<span class="number">5</span>), <span class="number">2</span>);</div><div class="line"></div><div class="line">cacluate.printBasket();</div><div class="line">cacluate.calculate();</div><div class="line">cacluate.printCalc();</div></pre></td></tr></table></figure>
<p>如上所说，只要调用接口的相应实现子类，然后添加书籍（添加书籍的方法也做好了封装），然后调用相应的API即可。</p>
<h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><p>这次项目的单元测试采用的是一种叫做cucumber的BDD工具，该工具在Ruby业内挺流行的，Java还不是应用广泛，在国内可能找相应的文章都不容易。<br>什么是BDD？TDD是一种通过测试用例来进行设计、代码驱动的开发方式，但是，这种方式是由程序员作为主导的，一般测试和产品经理并看不懂单元测试，只能说产品经理通过描述，让测试转化为测试用例，再通过程序员编写单元测试来实现。<br>那么，cucumber就解决了TDD的这一问题，直接通过产品经理设置场景，测试在场景内加入Example数据，再通过程序员来实现。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">Feature: Kata Potter</div><div class="line"> 出版社要促销一套哈利波特图书，该套图书共5集，每集单册购买价8元。</div><div class="line"> 若任意两集各买一本，打95折；若任意三集各买一本，打9折；若任意四集各买一本，打8折；</div><div class="line"> 若所有这五集都各买一本，打75折。上述优惠之外再购买的单册还是按8元一本计价。</div><div class="line"> 比如五集各买一本之外再加一本第一集，五本书打75折，这本另加的第一集按8元计价。</div><div class="line"> 若有人第一集买2本，第二集买2本，第三集买2本，第四集买1本，第五集买1本。</div><div class="line"> 问打折后最低的优惠价是多少钱？提示，不是51.6元，而是51.2元。</div><div class="line"></div><div class="line">  Scenario Outline: David的Potter测试</div><div class="line">    Given 开始我先要初始化我的购物车</div><div class="line">    And 我购买 &lt;Harry Potter and the Philosopher&apos;s Stone本 1st 系列书</div><div class="line">    And 我购买 &lt;Harry Potter and the Chamber of Secrets本 2nd 系列书</div><div class="line">    And 我购买 &lt;Harry Potter and the Prisoner of Azkaban本 3rd 系列书</div><div class="line">    And 我购买 &lt;Harry Potter and the Goblet of Fire本 4th 系列书</div><div class="line">    And 我购买 &lt;Harry Potter and the Order of Phoenix本 5th 系列书</div><div class="line">    When 我计算购物车的总价</div><div class="line">    Then 我最少应该付 &lt;lowest price&gt;</div><div class="line"></div><div class="line">  Examples: 最基本的测试</div><div class="line">    | Harry Potter and the Philosopher&apos;s Stone | Harry Potter and the Chamber of Secrets | Harry Potter and the Prisoner of Azkaban | Harry Potter and the Goblet of Fire | Harry Potter and the Order of Phoenix | lowest price |</div><div class="line">    |                    0                     |                    0                    |                      0                   |                  0                  |                   0                   |       0      |</div><div class="line">    |                    1                     |                    0                    |                      0                   |                  0                  |                   0                   |       800    |</div><div class="line">    |                    0                     |                    1                    |                      0                   |                  0                  |                   0                   |       800    |</div><div class="line">    |                    0                     |                    0                    |                      1                   |                  0                  |                   0                   |       800    |</div><div class="line">    |                    0                     |                    0                    |                      0                   |                  1                  |                   0                   |       800    |</div><div class="line">    |                    0                     |                    0                    |                      0                   |                  0                  |                   1                   |       800    |</div><div class="line">    |                    2                     |                    0                    |                      0                   |                  0                  |                   0                   |       1600   |</div><div class="line">    |                    0                     |                    3                    |                      0                   |                  0                  |                   0                   |       2400   |</div><div class="line"></div><div class="line">  Examples: 简单的打折测试</div><div class="line">    | Harry Potter and the Philosopher&apos;s Stone | Harry Potter and the Chamber of Secrets | Harry Potter and the Prisoner of Azkaban | Harry Potter and the Goblet of Fire | Harry Potter and the Order of Phoenix | lowest price |</div><div class="line">    |                    1                     |                    1                    |                      0                   |                  0                  |                   0                   |       1520   |</div><div class="line">    |                    1                     |                    0                    |                      1                   |                  0                  |                   1                   |       2160   |</div><div class="line">    |                    1                     |                    1                    |                      1                   |                  0                  |                   1                   |       2560   |</div><div class="line">    |                    1                     |                    1                    |                      1                   |                  1                  |                   1                   |       3000   |</div><div class="line"></div><div class="line">  Examples: 复合折扣测试</div><div class="line">    | Harry Potter and the Philosopher&apos;s Stone | Harry Potter and the Chamber of Secrets | Harry Potter and the Prisoner of Azkaban | Harry Potter and the Goblet of Fire | Harry Potter and the Order of Phoenix | lowest price |</div><div class="line">    |                    2                     |                    1                    |                      0                   |                  0                  |                   0                   |       2320   |</div><div class="line">    |                    2                     |                    2                    |                      0                   |                  0                  |                   0                   |       3040   |</div><div class="line">    |                    2                     |                    1                    |                      2                   |                  1                  |                   0                   |       4080   |</div><div class="line">    |                    1                     |                    2                    |                      1                   |                  1                  |                   1                   |       3800   |</div><div class="line"></div><div class="line">  Examples: 复杂折扣测试</div><div class="line">    | Harry Potter and the Philosopher&apos;s Stone | Harry Potter and the Chamber of Secrets | Harry Potter and the Prisoner of Azkaban | Harry Potter and the Goblet of Fire | Harry Potter and the Order of Phoenix | lowest price |</div><div class="line">    |                    2                     |                    2                    |                      2                   |                  1                  |                   1                   |       5120   |</div><div class="line">    |                    5                     |                    5                    |                      4                   |                  5                  |                   4                   |       14120   |</div></pre></td></tr></table></figure></p>
<p>上为本例中的场景。Given为给定的条件，AND是与的情况，WHEN是进行的操作，Then是结果，Examples是测试用例，&lt;&gt;中的内容会去测试用例中拿。让我们看看对应的代码怎么写。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PotterStepdefs</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> ICalculate calc = <span class="keyword">new</span> PriceCaclulate();</div><div class="line"></div><div class="line">    <span class="meta">@Given</span>(<span class="string">"^开始我先要初始化我的购物车$"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">I_clear_my_shopping_basket</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        calc.initialize();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Given</span>(<span class="string">"^我购买 (\\d+) 本 (\\d+)(?:st|nd|rd|th) 系列书$"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">I_buy_copies_of_book</span><span class="params">(<span class="keyword">int</span> numberOfBook,<span class="keyword">int</span> seriesNumberOfBook)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        System.out.println(<span class="string">"wudw"</span>+seriesNumberOfBook);</div><div class="line">        calc.putIntoBasket(seriesNumberOfBook, numberOfBook);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@When</span>(<span class="string">"^我计算购物车的总价$"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">I_calculate_the_price</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        calc.calculate();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Then</span>(<span class="string">"^我最少应该付 (\\d+)$"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">I_should_get_the_lowest_price</span><span class="params">(<span class="keyword">int</span> expectedPrice)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        <span class="keyword">int</span> price = (<span class="keyword">int</span>) (calc.getCalculatedPrice().getPrice());</div><div class="line">        assertEquals(<span class="string">"错误 - 计算结果与期望值不一致"</span>, expectedPrice, price);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>每个方法上有GIVEN、WHEN、THEN等，内部有相应的正则，会对应前面行为描述文件中的内容，正则()刮号中匹配的{1}、{2}等，都为成为注释方法中的参数。然后按描述文件中的顺序执行。<br>直接看看单元测试的结果吧。<br><img src="http://d3.freep.cn/3tb_140520204143venn531911.jpg" alt=""><br>还可以生成测试报告。<br><img src="http://d2.freep.cn/3tb_140520204143phb5531911.jpg" alt=""><br>有没觉得很好用？</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/18/2014-05-18-everythis-is-store-davidpotter-design/" itemprop="url">
                  Everythis is store----DavidPotter的设计
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2014-05-18T12:29:00+08:00" content="2014-05-18">
              2014-05-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/" itemprop="url" rel="index">
                    <span itemprop="name">Amazon</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/" itemprop="url" rel="index">
                    <span itemprop="name">bezos</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/设计/" itemprop="url" rel="index">
                    <span itemprop="name">设计</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/设计/责任链/" itemprop="url" rel="index">
                    <span itemprop="name">责任链</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/设计/责任链/KataPotter/" itemprop="url" rel="index">
                    <span itemprop="name">KataPotter</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/设计/责任链/KataPotter/一网打尽/" itemprop="url" rel="index">
                    <span itemprop="name">一网打尽</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一网打尽"><a href="#一网打尽" class="headerlink" title="一网打尽"></a>一网打尽</h2><h2 id="Bezos新看法"><a href="#Bezos新看法" class="headerlink" title="Bezos新看法"></a>Bezos新看法</h2><p>最近在看《Everything is store》这本书，暂时只看到Amazon新世纪前的艰难处境，这让我看到了Bezos的另一面：他吝啬，不给员工交保险；他主观，他认为员工就应该为了亚马逊的千秋万代不停的工作；他强势，他和乔布斯一样有不可思议的现实扭曲能力；他敏捷，他发现商机后往往是立马行动，不留下一点拖沓；他精明，善于在规则中发现漏洞，并钻这个空子；他谨慎，几乎没有人知道他的计划，包括他的合伙人和投资商；他无情，他让员工放弃家庭为他工作；他厚道，就算离开原有公司，也遵守着约定，并没有带走原公司的员工；他有感染力，他可以放开心的大笑；他是毒药，他的大笑让你失去防备。<br>一点载记，来自于《Everything is store》</p>
<blockquote>
<p>亚马逊当时还没有那么大的销售量，贝佐斯却为当初克服困难的勇气而津津乐道。他说：“我们发现了批发商订购规则的一个漏洞，他们的系统是这样设计的，你没有必要真买10本书，但你必须至少订10本书。我们发现有一本书，是描写‘地衣’的，系统里面有，但脱销了。我们开始订购1本我们想要的书，还有另外9本‘地衣’。然后他们会运来我们需要的那本书，并附上一张纸条，‘抱歉，我们的书脱销了。’”</p>
<p>如果一位有潜力的应聘者想在工作和家庭之间寻找平衡，那他就大错特错了，贝索斯肯定会把他拒之门外。</p>
<p>渐渐地，CEO向他的员工展示真是的自我，感染人的大笑、秃秃的头顶和神经质的举止。他异乎寻常的自信，比想象中还要固执。他近乎偏执地认为，员工都要不知疲倦得卖命，并且经常要大发豪言壮语。他一直雄心勃勃，但却行事谨慎，一些计划有时甚至连卡芬都蒙在鼓里。</p>
<p>Bezos最终命令他们停止这样做，因为这（员工通过服务器查看订单的每日增长情况）给服务器增加了更多的压力。当亚马逊第一次突破单日5000美元的订单时，拉夫乔伊建议搞个聚会，Bezos也没答应。他说：“将来会有很多有意义的事情，我不想这样庆祝”。</p>
<p>你可以超时工作、勤奋工作、动脑工作，但在亚马逊，你必须三选二。</p>
<p>Bezos再一次强调紧迫性：领先的企业现在要保持这种紧迫的状态，只有保持领先地位才能为顾客停工最优质的服务。</p>
<p>当然，这意味着亚马逊的每位员工都必须加倍努力。今后就没有任何公休日可言了，包括周末。在这里没人说你不能休周末，也没有人认为你可以休周末。</p>
</blockquote>
<h2 id="DavidPotter"><a href="#DavidPotter" class="headerlink" title="DavidPotter"></a>DavidPotter</h2><h2 id="设计"><a href="#设计" class="headerlink" title="设计"></a>设计</h2><p>上篇博文中已经说了题目的含义。但是后来设计的时候觉得，如果按那样设计，一个购物车，有x本书，用n种折扣处理，处理后可能会出现y（y根据剩余书系列类别书和n决定）种情况的新购物车，然后再回头开始，用n中折扣处理。<br>我觉得这样设计带来的时间复杂度提升太严重了。而且这种设计只是为了未来可能的扩展要求。因此，我用一种简单的方式实现，暂时之前只有最后两层出现5本书折扣和3本书折扣的时候会出现用2次四折处理会便宜0.4元，就对这个特殊情况，我用一个特殊的handler处理下就好了。之后如果折扣变更有新的需要，用责任链设计模式也可以很方便的热拔插进一个新的handler。</p>
<h2 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h2><p><img src="http://i1.tietuku.com/13ad8e00f1cf9723s.png" alt=""><br>可以看出，设计都是面向抽象，而不是具体实现。计算器Calc依赖于计算策略、购物车、购物车工厂、处理器，购物车依赖于书的系列，系列再依赖于书。处理器使用责任链的方式组合。</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>这篇文章暂就介绍到这里，下篇再具体介绍代码。另外这次的代码实现还会用BDD的方式来完成。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/14/2014-05-14-i-think-bezos/" itemprop="url">
                  我眼里的Bezos&Amazon----Code Journey for Kata Potter
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2014-05-14T13:58:00+08:00" content="2014-05-14">
              2014-05-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/" itemprop="url" rel="index">
                    <span itemprop="name">Amazon</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/" itemprop="url" rel="index">
                    <span itemprop="name">bezos</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/天道酬勤/" itemprop="url" rel="index">
                    <span itemprop="name">天道酬勤</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/天道酬勤/KataPotter/" itemprop="url" rel="index">
                    <span itemprop="name">KataPotter</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/天道酬勤/KataPotter/CodeJourney/" itemprop="url" rel="index">
                    <span itemprop="name">CodeJourney</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="近况"><a href="#近况" class="headerlink" title="近况"></a>近况</h2><p>感觉现在忙的事情越来越多了。给我家媳妇调毕业论文的日子结束了，紧接上来的就是给媳妇找房子租。然后V1.0版本差不多搞定了，立项、整体计划、下个阶段需求、设计等事情也连绵不绝。然后因为用户开始试用，V1.0版本很多的问题开始暴露，要搜集问题分析问题，紧急的还要打补丁解决，一些用户还需用定制一些特殊功能。<br>忙的事情实在多，只能拼凑一些晚上时间来做做Code Journey，再利用各种班车上、午间、饭后时间看书。<br>所以今天博文就是写最近我看的Bezos传记和Kata Potter的编程之旅，Kata Potter暂时未实现，只是有了一些思路，在设计中。</p>
<h2 id="Bezos-amp-Amazon"><a href="#Bezos-amp-Amazon" class="headerlink" title="Bezos&amp;Amazon"></a>Bezos&amp;Amazon</h2><p>#Amazon<br>亚马逊开始时候不过就是个网络书商，靠从出版商那里批发图书转卖挣其中的利润。什么当当网之类的不过都是亚马逊的中国制造——山寨。从普通网络书店，到地球上最大的书店，到最大的综合网络零售商，最后到今天这样一个综合性的网络服务商。<br>亚马逊崛起的平缓而持续，得益于Bezos。</p>
<p>#Bezos<br>Bezos的经历告诉我们一个事情，天道不一定酬勤，但是会决定你成为一个怎样的人。就像我去年考系统集成项目管理认证，两个月的高压工作下学习，虽然最后差之毫厘，但是这个过程中，<strong>我已经得到了这样的能力与见识，我已经将自己变成了一个不一样的人。外在的评估与期待只是一个结果而已，但是绝不应该是目的</strong>。<br>如果你真的早已知晓你所希望成就的一切（说到这里可能又会被认为是成功学），并努力一直将生命向这个方向推动，不懈怠，专注思考，穷尽一切可能，你一定会得到你所想要得到的。虽然至于得到多少，能不能闻达于天下，仍然取决于概率，但是这种主动至少能够帮助你战胜概率。在机会来临前，如果你能做好准备，你才有资格去丰收。我不信儒家思想中的天命，天命不过是未来的一种不确定性，会掌控和颠覆我们的生活，但是想一想，这种不确定性在人的一生这七八十年的样本区间里，就被概率抹平了，大部分的你们终会回归预期轨迹。虽然没几个人能达到Bezos的高度，但是主动至少能给我们获得成功的概率，这概率大小就取决于我们的努力有多少以及我们定义的成功有多高。</p>
<p>以下为Bezos2010年在普林斯顿大学的演讲，<a href="http://c.blog.sina.com.cn/profile.php?blogid=bec49e8b8900143l" target="_blank" rel="external">全文</a></p>
<blockquote>
<p>对我来说，这真是个困难的选择（指辞去对冲基金的工作去创建亚马逊），最终，我决定放手一搏。因为，万一试了以后失败，我并不会后悔；但如果不去试试看，我可能永远都会耿耿于怀。考虑了很久，我最后选择了一条比较不安全的路，去追随我的热情。今天，对于这个选择，我感到非常自豪。</p>
<p>我要斗胆做个预测。当你们活到八十岁，在某个安静的沉思时刻，回到内心深处，想起自己的人生故事时，最有意义的部份，将会是你所做过的那些选择。人生到头来，我们的选择，决定了我们是什么样的人（We are our choices.）。替你们自己写一篇精彩的人生故事吧。</p>
</blockquote>
<h2 id="Kata-Potter"><a href="#Kata-Potter" class="headerlink" title="Kata Potter"></a>Kata Potter</h2><p>#Problem Description<br> Once upon a time there was a series of 5 books about a very English hero called Harry. (At least when this Kata was invented, there were only 5. Since then they have multiplied) Children all over the world thought he was fantastic, and, of course, so did the publisher. So in a gesture of immense generosity to mankind, (and to increase sales) they set up the following pricing model to take advantage of Harry’s magical powers.</p>
<p>One copy of any of the five books costs 8 EUR. If, however, you buy two different books from the series, you get a 5% discount on those two books. If you buy 3 different books, you get a 10% discount. With 4 different books, you get a 20% discount. If you go the whole hog, and buy all 5, you get a huge 25% discount.</p>
<p>Note that if you buy, say, four books, of which 3 are different titles, you get a 10% discount on the 3 that form part of a set, but the fourth book still costs 8 EUR.</p>
<p>Potter mania is sweeping the country and parents of teenagers everywhere are queueing up with shopping baskets overflowing with Potter books. Your mission is to write a piece of code to calculate the price of any conceivable shopping basket, giving as big a discount as possible.</p>
<p>For example, how much does this basket of books cost?<br>  2 copies of the first book<br>  2 copies of the second book<br>  2 copies of the third book<br>  1 copy of the fourth book<br>  1 copy of the fifth book</p>
<p>(answer: 51.20 EUR) </p>
<p>#含义<br>原题目很长，大意就是出版社要促销一套哈利波特图书，该套图书共5集，每集单册购买价8元。若任意两集各买一本，打95折；若任意三集各买一本，打9折；若任意四集各买一本，打8折；若所有这五集都各买一本，打75折。上述优惠之外再购买的单册还是按8元一本计价。比如五集各买一本之外再加一本第一集，五本书打75折，这本另加的第一集按8元计价。若有人第一集买2本，第二集买2本，第三集买2本，第四集买1本，第五集买1本。问打折后最低的优惠价是多少钱？提示，不是51.6元，而是51.2元。</p>
<p>#思路<br>现在我想了一个办法，就是一个DiscountHandler，集成了95折、9折、8折、75折的handler，然后有一个购物车，从购物车用不同的handler去处理，然后会剩下剩余的购物车（这个购物车会有多种情况，比如1、2、3、4、5、3、4、5在8折策略后可能会是5、3、4、5，也可能是1、3、4、5），然后再把剩余的购物车用DiscountHandler去处理。<br>具体实现，还需要用业余时间去设计实现。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/12/2014-05-12-you-should-figure-out-what-you-want-to/" itemprop="url">
                  用户应该想清楚要什么，产品经理应该清楚用户需要什么
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2014-05-12T14:30:00+08:00" content="2014-05-12">
              2014-05-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/产品/" itemprop="url" rel="index">
                    <span itemprop="name">产品</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/产品/设计/" itemprop="url" rel="index">
                    <span itemprop="name">设计</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/产品/设计/极简/" itemprop="url" rel="index">
                    <span itemprop="name">极简</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#话题<br>最近关于Thinkpad new X1的争论非常多，很多人抱着“贬”的态度。对于这款有着独创式的键盘，如果用习惯传统键盘的人使用恰里，就会出现光标乱飞、页面乱切、时不时休眠、时不时关闭页面，各种键需要拿着放大镜去找……而且很多特殊功能需要查说明书才能发现。<br>贬的就不用说了，各种骂设计师脑残，各种骂又贵有JB难用，各种骂要换Mac，各种喊9700买的本全新的7900出。<br>但是也有人持褒的态度，意思是Mac的键盘也不好用啊，你们应该抛弃久的习惯使用这更高（搞）效（笑）的操作……</p>
<p>#拙见<br>我对于新事物从来都是比较好奇的，不过这9700的东西我是买不起了，只能围观看看。<br>随便举个X1的创新，比如CAPS LOCK键被去掉了，取而代之的是home 和end，原来的大写锁变成点击Shift两下。这个设计主要是因为我们的小拇指太短，正常键盘上无法点击到home和end键，所以设计师说那就给你们放近一点，不用谢，请叫我雷锋。但是使用的人估计只会大喊，你妹啊，刚刚想输入个大写字母，怎么就跳到页顶去了。然后据说Shift两下后大小写锁定状态的灯很烂，基本不知道现在处于什么状态。<br>别的功能就不一一列举，反正我看到的所有介绍，基本上都可以用“坑爹两个字形容”。</p>
<p>#极简<br>我想，X1的设计师估计是想达到乔老爷子极简的境界，这种多一分太多少一分不足的境界，真是很难把握的。首先要改变传统使用者的习惯，这就很需要乔老爷子那种扭曲现实的能力，强势的给你灌输这货就是应该这样操作的。然后就是很难符合每个人口味，毕竟每个人的需求不一样，这功能在路人甲那可能是渣渣，而在路人乙那确实瑰宝。<br>按产品设计的原则来说，80%主流用户的80%需求就是产品极简的界限，那么这种调查要怎么做呢？这得对产品经理的自觉有多大的要求啊。至少，X1这牛是没画好。</p>
<p>#电话线还是无线<br>产品设计最终目的还是解决问题，那么就要找到用户需求的本质，他到底是需要5米长的电话线还是一个无线电话，又或者说是要飞机还是更快的火车。这样产品设计的例子是在太多了，但是我这新手从前人已有事迹上来马后炮当然是坐着说话不腰疼，实际操作中是很难。我也做产品设计，但是我清楚的感觉到对于用户的需求的极简设计很难把握。比如用户想要一个更方便的监控资源配置，我要设计出他真实想要的，我一定需要了解到他产生这个想法时候的情景环境，这时候我就幻想自己是一个运维管理员，对着资源清单配置了一整天，想象那种烦躁的心情，想象这时候我想要的是什么？<br>除了情景环境，还要的就是Idea，比如刚刚那个情景，我想到的就是导入、批量设置、可视化配置，但是这些都稍微能改善一些问题，但是没有解决根源问题，还是有复杂的配置。</p>
<p>#工具论<br>其实，不管什么样的设计，他都不过是一个解决用户问题的工具，首先他要能解决问题。设计的再好，如果不能再用户所在情境下解决特定的问题，都是错误设计，或者过度设计。所以我觉得X1他没能解决用户的问题。在我看来Thinkpad面向的还是商务用户，他们不像程序员那样喜欢一直把手停留在键盘上，所以并不需要两只手范围内完成所有的操作，而且X1的很多设计都过于复杂，并没有加快商务人士的工作效率。在没有提高效率的前提下增加了他们的学习成本，就算老板肯为这昂贵的笔记本买单，使用者也不大愿意使用吧？</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/08/2014-05-08-transfer-went-from-seven-values-of-zhang-xiaolong-said/" itemprop="url">
                  [转]从张小龙的七大价值观说开去
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2014-05-08T14:45:00+08:00" content="2014-05-08">
              2014-05-08
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://www.csdn.net/article/2014-05-07/2819654-WeiXin-Group-zhangxiaolong" target="_blank" rel="external">原文地址</a></p>
<p>#摘要<br>腾讯公司宣布由张小龙担任微信事业群总裁。微信的成功让人们开始越来越多的关注他，可以说他的每一句话、每一句理念都影响着中国大量互联网从业者。文中笔者收集了张小龙给产品经理的一些建议，希望对你有所启迪。<br>近日，腾讯公司宣布成立微信事业群（WeiXin Group，简称WXG），由“微信之父”、腾讯高级副总裁张小龙担任事业群总裁，并向公司总裁刘炽平汇报工作。</p>
<p>#概述<br>据悉，微信事业群将负责包括微信基础平台、微信开放平台，以及微信支付拓展、O2O等微信延伸业务的发展，并包括邮箱、通讯录等产品开发和运营，致力于打造微信大平台，为用户和合作伙伴创造更多价值。腾讯内部未来将包括七个事业群组，分别为WXG（微信事业群）、SNG（社交网络事业群）、CDG（企业发展事业群）、IEG（互动娱乐事业群）、MIG（移动互联网事业群）、OMG（网络媒体事业群）和TEG（技术工程事业群）。<br>有人在知乎上问：腾讯的张小龙是一个什么样的人？大家的回答绫罗万千，无不夸赞这位优秀的产品经理。谈及微信，张小龙称对人性的把握最重要。微信的成功让人们开始越来越多的关注他，可以说他的每一句话每一个做产品的理念都开始影响中国大量互联网从业者。为此，笔者收集了张小龙给产品经理的一些建议，希望对你有所启迪。</p>
<p>#七大价值观</p>
<p>微信事业群的成立意味着微信已完成第一阶段的孵化，从产品升级为腾讯战略级的业务体系。张小龙总结了微信团队的七大理念，希望新团队能继续保持和发扬。他指出，</p>
<ul>
<li>要做对用户有价值的事情；</li>
<li>保持我们自身的价值观，因为它会体现在我们的产品和服务中；</li>
<li>保持小团队，保持敏捷；</li>
<li>学习速迭代比过去的经验更重要；</li>
<li>系统思维；</li>
<li>让用户带来用户，口碑赢得口碑；</li>
<li>思辨胜于执行。</li>
</ul>
<p>事实上，张小龙并不认为自己说的每一句话都值得产品经理研究，他甚至坦言，成功的产品经理是很难复制的。推荐阅读：<a href="http://play.cn/base/news/view/54938.htm" target="_blank" rel="external">优秀的产品经理难以复制</a>、<a href="http://www.leiphone.com/7-24-allen-zhang-wechat.html" target="_blank" rel="external">通过微信谈产品》完整版</a></p>
<p>#对产品经理要求：一千一百十<br>一千指每月在微博、QQ空间等谈论相关行业话题需要和他们互动一千次，点赞也算；一百指每月相关行业的重要分析文章看一百篇；十指每月需要与客户、消费者互动十次，最好是深度访谈。</p>
<p>#产品经理的方法论与价值观<br>回顾微信的演化历史之后，张小龙几乎分析了有关移动互联网产品的所有关键点，包括了其产品经理的素养，产品设计原则、思路与方法论等等。全文最令笔者感触的一句话是：它没有人造物的冰冷生硬，而有一种温暖的人性存在。<br>产品经理的主流应该是服务于未来。先于人众接触新技术新知识，并把这种认知转化为产品，利用产品提供现代人类社会中的各种人群。尽一切可能，降低学习成本，利用人类的本能设计产品，使得人群得以顺利“滑入”新的产品使用场景。</p>
<p>移动互联网产品经理的素养应包括：敏锐感知潮流变化、、放弃理性思维、海量的实践、博而不专的积累、负责的态度。</p>
<p>#APP产品经理必须要懂的30条原则</p>
<p>手机是肢体的延伸，和人是一体的；而PC是外物，即外部环境。移动互联网产品不是简单的PC到手机的移植。做没有Web的移动互联网产品该怎么做？这对中国IT人来说是全新的课题。这里整理出的30条原则，可以看到对于APP产品设计和推广的清醒认识。</p>
<ul>
<li>时尚是驱动力</li>
<li>重视“屌丝”用户群</li>
<li>从日常体验中发现本质</li>
<li>需求是满足人们的贪嗔痴</li>
<li>需求的本质往往可以归结为心理诉求</li>
</ul>
<p>#微信背后的产品观：移动互联网产品经理要放弃理性思维</p>
<p>一个亿级用户的产品经理，无需做到透彻思考人性和产品的所有方面，得出定性结论，但依然可以做出成功的产品。</p>
<p>一个成功的产品经理，需要在极端现实主义和极端理想主义之间取得平衡，把它们作为整体一并接受下来，彻底去除其中的相对性，丝毫不会觉得其中的矛盾和冲突之处。</p>
<p>#产品之上的世界观</p>
<p>微信的平台化发展方向是否真的会让这个原本简洁的产品变得臃肿？在国际化发展方向上，微信面临的问题真的是文化差异壁垒吗？腾讯高级副总裁、微信产品负责人张小龙给出了自己的回复。张小龙认为，一个东西是不是很臃肿并不取决于它有多少功能，而取决于它最终展现出来的，在体验上是不是用户觉得很臃肿。</p>
<p>他表示，做产品不是从文化角度出发，而是从需求出发。微信国际化路线上能否成功，未必是由文化因素决定，而是对当地的用户和需求是否够了解。</p>
<p>#怎样做简单的产品经理？</p>
<p>怎样看待简单是美？张小龙的理解是，简单是一种审美观，它不是一种完全理性的结论。不是说尽可能做得简陋一点，而是说你脑袋里是不是有一种观念在这里。当你看到一个界面上密密麻麻铺满了按钮，你就知道这东西一点都不美，想要把它给简化一下。</p>
<p>产品经理应该像上帝那样了解人性 ，我们喜欢简单，因为上帝创造宇宙的时候，定下来的规则也非常简单。</p>
<p>#张小龙的腾讯内部邮件<br><strong>微信BG的兄弟姐妹们</strong>，</p>
<p>想必大家都已看到公司发文的消息：今天，微信BG正式成立，将负责以微信为基础建设移动互联网社交、开放与O2O平台，为用户提供即时通信与线上娱乐、生活 和商业化的综合性服务，创造更多价值。这意味着 <code>微信已完成第一阶段的孵化，从产品升级为腾讯战略级的业务体系，全面助力公司在移动互联网领域发挥更大作用</code>。</p>
<p>2010年10月微信立项，2011年1月微信发布第一版。我们从QQ邮箱团队分出一支10个人的小团队开始起步，成长到现在的微信BG。微信的用户量，也成长到几亿之大。我们欣喜看到移动互联时代，微信融入了几亿人日常的线上生活， 让时间和空间在这个时代有了新的涵义。在此，我要特别感谢每位微信同学的全力付出，并且为大家在这三年里面创造的微信之旅感到骄傲！</p>
<p>新的BG，也吸纳了ECC和财付通的一些团队。欢迎新同学的加入！</p>
<p>作为一个新的业务团队，我也希望之前微信团队的一些理念能继续保持和发扬。这些理念，其实也是公司一直倡导的。在这里总结几点。</p>
<h2 id="做对用户有价值的事情。"><a href="#做对用户有价值的事情。" class="headerlink" title="做对用户有价值的事情。"></a>做对用户有价值的事情。</h2><p>我们经常会在各种权衡中做取舍，在任何时候，我们都要想，这个事情是不是从用户价值本身出发的来考虑的。如果我们想的策略和用户价值有违背，哪怕舍弃短期利益，也应该维护用户价值。让用户看到你的努力，而不是同事和上级。</p>
<h2 id="保持我们自身的价值观，因为它会体现在我们的产品和服务中。"><a href="#保持我们自身的价值观，因为它会体现在我们的产品和服务中。" class="headerlink" title="保持我们自身的价值观，因为它会体现在我们的产品和服务中。"></a>保持我们自身的价值观，因为它会体现在我们的产品和服务中。</h2><p>解决纷争时，它会帮我们做出决定。如果我们认为用户不能被骚扰，我们就不会在产品中做出骚扰用户的行为。如果我们没有一致的价值观，我们的产品和服务就会割裂为利益的集合体。不做个人价值观和产品价值观的双面人。</p>
<h2 id="保持小团队，保持敏捷。"><a href="#保持小团队，保持敏捷。" class="headerlink" title="保持小团队，保持敏捷。"></a>保持小团队，保持敏捷。</h2><p>希望我们在BG成立规模变大后，还能保持小团队心态，避免陷入官僚化和流程化里面。我们曾经禁止写PPT，认为那是形式化的体现。这有些武断，但目标是效率的最大化。我们还将继续限制招聘的人员数目，只招聘最优秀的人员加入团队。对一个优秀团队来说，人员也是少比多好。</p>
<h2 id="学习和快速迭代比过去的经验更重要。"><a href="#学习和快速迭代比过去的经验更重要。" class="headerlink" title="学习和快速迭代比过去的经验更重要。"></a>学习和快速迭代比过去的经验更重要。</h2><p>移动互联网变化太快，我们的产品和业务思路，也希望是面向新的环境而产生。</p>
<h2 id="系统思维。"><a href="#系统思维。" class="headerlink" title="系统思维。"></a>系统思维。</h2><p>记住我们的愿景：连接人，连接企业，连接物体。让它们组成有机的自运转的系统，而不是构建分割的局部的商业模式。我们专注于基于连接能力的平台，并将平台开 放给第三方接入，和第三方一起建造基于微信的人和服务的生态系统。系统思维也会帮助我们建造透明公正的商业体系，让系统在规则下运转，避免人为的干预。</p>
<h2 id="让用户带来用户，口碑赢得口碑。"><a href="#让用户带来用户，口碑赢得口碑。" class="headerlink" title="让用户带来用户，口碑赢得口碑。"></a>让用户带来用户，口碑赢得口碑。</h2><p>用互联网的网状传递效应来推动产品和服务。一个例子是一个小小的飞机大战可以引发一场手机游戏的风暴。我们处在一个人人互联的时代，如果我们能让一个用户说好，这个口碑就会传播出去。将我们的创造力体现在各个细节中。创意不是宏图大略，而在于我们每天工作的点点滴滴，用户都能感知到。</p>
<h2 id="思辨胜于执行。"><a href="#思辨胜于执行。" class="headerlink" title="思辨胜于执行。"></a>思辨胜于执行。</h2><p>执行力很重要，但更希望我们的日常工作是一个思辨的过程。我们提倡争论，在工作中通过辩理来找到正确的解决方法，而非为了团队利益或者人际关系放弃思辨能力甚至思辨习惯。进步来自思辨。</p>
<p>这些朴素的价值观，希望能融入到我们团队的日常工作中。</p>
<p>过去的三年，是微信从无到有的成长的三年。未来的三年，希望微信能成长为一个真正的具备开放能力的系统，并培育出健康的生态。</p>
<p>“微信因你而美“，这是我们去年年会的主题，也以此来感谢大家。在新的微信BG下，相信我们会一起努力，让我们的产品和服务做得更好！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/08/2014-05-08-open-b-victims-of-confucius-theory-of-ethnic/" itemprop="url">
                  百家争鸣（二）-孔子害名族论
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2014-05-08T01:01:00+08:00" content="2014-05-08">
              2014-05-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/孔子/" itemprop="url" rel="index">
                    <span itemprop="name">孔子</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/孔子/儒家/" itemprop="url" rel="index">
                    <span itemprop="name">儒家</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/孔子/儒家/易中天/" itemprop="url" rel="index">
                    <span itemprop="name">易中天</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/孔子/儒家/易中天/百家争鸣/" itemprop="url" rel="index">
                    <span itemprop="name">百家争鸣</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/孔子/儒家/易中天/百家争鸣/中庸/" itemprop="url" rel="index">
                    <span itemprop="name">中庸</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/孔子/儒家/易中天/百家争鸣/中庸/仁爱/" itemprop="url" rel="index">
                    <span itemprop="name">仁爱</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#中庸<br>道家讲道，儒家讲德，德的最高境界就是中庸，孔子曰：“中庸之为德也，其至矣乎！”什么是中庸，中就是不走极端，庸，就是不唱高调，就是一件事情做过头了就等于没做到，没准还更糟，因此不越位，不过头，不掉队，凡事恰到好处，这就是和中庸之道。老子也不唱高调，提倡为弱，他的主张是水往低处流，人也往低处躲，中庸和为弱比起来，有点上德不德，大义不义，多情无情的感觉，给中华民族留下墨守成规的传统，做什么事情都不越界，不跨界，这恰恰与现在的互联网思维背道而驰，互联网处处存在极客，处处存在越界。中国封建社会的牢靠，跟中庸思想也脱不了关系，它制约思想和文明的发展，维护社会的稳定，很多优秀的思想其实都是很极端的，比如黑天鹅理论，就是著名的极端斯坦思想，只要能预估到极端的突发事件，才能走在时代浪潮之巅。中庸思想还不善于探索新的领域，更适合继承与发展，就如罗胖子最近说的存量和增量，中庸永远只能维护存量，只有极端才能造就增量。极端之路未必就是坏的，未被实践前就不能否认它的价值，中庸的人总是利用自己的无知去持否定性思维，对自己知道的深信不疑，中庸思想让我们是去了挑战一切的心，他是最妨碍中华名族的突破，不过，他确实一直维护着社会的稳定。</p>
<p>#仁礼<br>儒家主张仁礼，仁，是孔子的核心价值；礼，是孔子的政治主张，孔子的主张就是“克己复礼”。中国人也一直像着孔子那样，克己复礼，三年不为礼，礼必坏，三年不为乐，乐必崩。但是我觉得儒家很多主张都是没什么道理的，比如肉切割的方式不合规矩，就不能吃；椅子摆放的不对，也不能坐。这么多繁文缛节，儒家的人自己做不到，孔子自己也做不到。就比如孔子周游时候受困于陈，就抛弃了这些主张。后来他解释说之前是为了求生，此时是为了取义。那义如此重要，干嘛就不能舍生取义呢？</p>
<p>#亲爱<br>儒家的爱就更存在问题了，儒家讲的是爱族人胜过爱挚友，爱双亲胜过爱族人，爱自己胜过爱双亲，是有差别的爱，那么这种爱就可以让我损人利己。这种思想现在看来对中国造成了深渊的影响，凡事都要走关系。好在现在社会不断在好转，现在已经不像我们小时候了，那时候什么事情不走关系就没法办。</p>
<p>#天命<br>另外儒家讲的是天命，所谓天命不可违，天命论其实就是暴君和懒汉的主张。暴君倒台懒汉穷死一定不会认为自己有问题，这点也是国人存在的毛病，遇到问题总是无法从自己身上找原因，将命运交给天。</p>
<p>#小康<br>小康社会，其实也是儒家主张的。君仁臣忠，父慈子孝，男耕女织，四世同堂这就是理想中的封建社会，也就是儒家所说的小康社会。但所有人都只爱自己的父母，只疼自己的孩子，人人为己，财产私有，职位世袭，于是社会矛盾就有了，还不断加深。在中国，从来都是“家有”的概念，这是中国特色所有制的紧要之处。甚至权利也变成这样。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/07/2014-05-07-open-nodejs-fizzbuzzwhizz/" itemprop="url">
                  百家争鸣（一）---Node.js版FizzBuzzWhizz
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2014-05-07T13:34:00+08:00" content="2014-05-07">
              2014-05-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/fizzbuzzwhizz/" itemprop="url" rel="index">
                    <span itemprop="name">fizzbuzzwhizz</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/fizzbuzzwhizz/易中天/" itemprop="url" rel="index">
                    <span itemprop="name">易中天</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/fizzbuzzwhizz/易中天/百家争鸣/" itemprop="url" rel="index">
                    <span itemprop="name">百家争鸣</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="百家争鸣-读书感记事（一）"><a href="#百家争鸣-读书感记事（一）" class="headerlink" title="百家争鸣-读书感记事（一）"></a>百家争鸣-读书感记事（一）</h2><p>这本书是我在亚马逊Kindle特价上淘来的，看这本书之前我看过易中天老师两本书，一本是品三国，没有全看就是随便翻阅下，精彩是很精彩，但是没有太大感悟，另一本则是我觉得很有感悟的一本书，书名有好几个版本，书名我是忘了，《美国宪法的诞生和我们的反思》是我百度出来的，大概说的就是美国1785年（时间我也不确定了，大概这个时间吧）的立宪会议。这本书讲述了美国从被统治到独立后的一段混沌的时代，从这本书中不仅提到了麦迪逊、华盛顿的美国开国元勋们制定宪法的会议记录，如果只是这样，我也就不崇拜易中天老师了，他通过联邦、邦联、民主、共和、人民、公民等词来叙述了这个过程，由于本文主题不是这个，所以不细说。<br>这本书是我看的第三本易中天老师的书，也是通过白话的方式叙述了中国古代的圣人们的救世之道。从孔子孟子仁爱的儒家，到墨子博爱的墨家，到杨朱、庄子、老子一毛不拔的到家，最后到君权至上的法家，易老师从各种视角剖析，可以说精彩有余而感悟甚深。其中我最喜欢庄子，庄子就像禅宗，是不能说的，一说便错。<br>接下来会陆续的把这本书的读书感发出来。<br>抄袭庄子的一句话做本文的开头吧。<br>我：媳妇，你看庄子他真是而自由，就像那浪里白条的鲦鱼一样，在水里尽情的游弋，他其实就是享受着天地之间尽情游弋的“鱼”的快乐啊！<br>媳妇：你又不是庄子，你怎么知道庄子的快乐呢？<br>我：你又不是我，你怎么知道我不知道庄子的快乐呢？</p>
<h2 id="Node-js版FizzBuzzWhizz"><a href="#Node-js版FizzBuzzWhizz" class="headerlink" title="Node.js版FizzBuzzWhizz"></a>Node.js版FizzBuzzWhizz</h2><p>和python版本比较，该版本只是把一些方法抽成了函数，并无太大改善。主要是在python版本和java版本花了一些心思设计，不罗嗦，直接上代码，有兴趣的研究下<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 获得用户输入                                                                  </span></div><div class="line"><span class="keyword">var</span> nums = process.argv[<span class="number">2</span>];</div><div class="line"><span class="keyword">if</span> (!nums) die(<span class="string">'please enter three numbers. example: 3,5,7'</span>);</div><div class="line">nums = nums.split(<span class="string">','</span>);</div><div class="line"><span class="keyword">if</span> (nums.length !== <span class="number">3</span>) die(<span class="string">'please enter three numbers. example: 3,5,7'</span>);</div><div class="line">nums.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (!(n <span class="number">0</span> &amp;&amp; n &lt; <span class="number">10</span>)) die(n + <span class="string">' is not an valid number. must be greater than 0 and less than 10'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">die</span> (<span class="params">msg</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(msg);</div><div class="line">  process.exit(<span class="number">-1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">print</span> (<span class="params">msg</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(msg);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">var</span> a = nums[<span class="number">0</span>], b = nums[<span class="number">1</span>], c = nums[<span class="number">2</span>];</div><div class="line"><span class="keyword">var</span> A = <span class="string">'Fizz'</span>, B = <span class="string">'Buzz'</span>, C = <span class="string">'Whizz'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isIn</span> (<span class="params">i, n, s</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> (i.toString().indexOf(n) !== <span class="number">-1</span>)?s:<span class="string">''</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isTimes</span> (<span class="params">i, n, s</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> (i % n === <span class="number">0</span>) ? s : <span class="string">''</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">numberOff</span>(<span class="params">currNum</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> isIn(currNum,a,A) || isTimes(currNum, a, A) + isTimes(currNum, b, B) + isTimes(currNum, c, C) || currNum;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 计算</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="number">100</span>; i++) &#123;</div><div class="line">  print(numberOff(i));</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/05/2014-05-05-java-version-fizzbuzzwhizz/" itemprop="url">
                  Java版FizzBuzzWhizz
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2014-05-05T15:26:00+08:00" content="2014-05-05">
              2014-05-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/maven/" itemprop="url" rel="index">
                    <span itemprop="name">maven</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/maven/TDD/" itemprop="url" rel="index">
                    <span itemprop="name">TDD</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/maven/TDD/fizzbuzzwhizz/" itemprop="url" rel="index">
                    <span itemprop="name">fizzbuzzwhizz</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/maven/TDD/fizzbuzzwhizz/责任链/" itemprop="url" rel="index">
                    <span itemprop="name">责任链</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/maven/TDD/fizzbuzzwhizz/责任链/模板方法/" itemprop="url" rel="index">
                    <span itemprop="name">模板方法</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/maven/TDD/fizzbuzzwhizz/责任链/模板方法/设计模式/" itemprop="url" rel="index">
                    <span itemprop="name">设计模式</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/maven/TDD/fizzbuzzwhizz/责任链/模板方法/设计模式/趣味编程/" itemprop="url" rel="index">
                    <span itemprop="name">趣味编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#个人近况<br>最近忙着替媳妇写论文，还忙招聘，忙写jQuery插件，忙写python，忙这忙那，今天赶紧利用晚上的1个多小时把五一期间做好的Java版本FizzBuzzWhizz博文也写了。有空还把Node.js的也贴上来，不过和Python差不多，到时候就大概贴代码了，不详细说明。</p>
<p>#Java版FizzBuzzWhizz</p>
<h2 id="1-概述"><a href="#1-概述" class="headerlink" title="1 概述"></a>1 概述</h2><p>上个系列博文已经讲述了Python版本的FizzBuzzWhizz的思考、设计和实现思路。那么Java版本的肯定不是在做一个C2C（copy to clipboard）的事情。</p>
<h2 id="2-问题"><a href="#2-问题" class="headerlink" title="2 问题"></a>2 问题</h2><h2 id="2-1-开闭原则"><a href="#2-1-开闭原则" class="headerlink" title="# 2.1 开闭原则"></a># 2.1 开闭原则</h2><p>一个软件实体如类、模块和函数应该对扩展开放，对修改关闭。<br>那么在python中虽然已经把规则的逻辑条理分的很细了，但是所有的规则还是集中在一个函数里面，如果新增加一个规则那么就必然要修改到原来已经实现的代码。那么这样的设计是有风险的，任何的新规则很可能会影响到老规则的逻辑。</p>
<h2 id="2-2-封装"><a href="#2-2-封装" class="headerlink" title="# 2.2 封装"></a># 2.2 封装</h2><p>可以将信息封装为需要的数据对象，将数据与操作分离所带来的种种问题消除，提高了程序的可复用性和可维护性。</p>
<h2 id="2-3-自动构建"><a href="#2-3-自动构建" class="headerlink" title="# 2.3 自动构建"></a># 2.3 自动构建</h2><p>Python版本中并没有对项目进行自动的构建，Java版本中引入Maven来做项目构建管理。</p>
<h2 id="3-设计"><a href="#3-设计" class="headerlink" title="3 设计"></a>3 设计</h2><p>在构思了下，用责任链模式、模板模式、工厂模式来完成这个设计。类设计图如下：<br> <img src="http://i1.tietuku.com/698717c0da7c4af0.jpg" alt=""></p>
<p>其中，IHandler是项目中的核心接口，其只有一个方法handler，是提供给外部的调用的处理方法。在python文章已经介绍，该游戏的规则分为“或”和“与”两种，所以设计中也定义了两种实现功能，其中wordHandler是为接口实现了“或”的特性，而UnitHandler则是实现了“与”的特性。<br>“或”的特性是通过责任链路的模式去实现的，了解servlet的人都知道，filter的filterChain.doFilter(request, response)方法可以将一个请求在一系列的处理类中传递request。本项目中的请求就是报数的数字i。</p>
<h2 id="4-代码"><a href="#4-代码" class="headerlink" title="4 代码"></a>4 代码</h2><p>先看看核心接口IHandler。<br><figure class="highlight java"><figcaption><span>IHandler.java</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IHandler</span> </span>&#123;</div><div class="line"> 	   <span class="function"><span class="keyword">public</span> Word <span class="title">handle</span><span class="params">(<span class="keyword">int</span> number)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>通过这个接口，很好的体现了面对对象多态的特性。<br>在看看两个核心的实现类。<br><figure class="highlight java"><figcaption><span>WordHandler.java</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * User: David</span></div><div class="line"><span class="comment"> * Date: 14-04-18</span></div><div class="line"><span class="comment"> * Time: 下午7:03</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">WordHandler</span> <span class="keyword">implements</span> <span class="title">IHandler</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> IHandler wordHandler;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WordHandler</span><span class="params">(IHandler wordHandler)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.wordHandler = wordHandler;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Word <span class="title">handle</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</div><div class="line">        String result = run(number);</div><div class="line">        Word resultWord = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">if</span>(result == <span class="keyword">null</span> || <span class="string">""</span>.equals(result))&#123;</div><div class="line">            resultWord = wordHandler.handle(number);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            resultWord = Word.getWord(result);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> resultWord;</div><div class="line">    &#125;</div><div class="line">	<span class="comment">//钩子方法，类似Thread中的run方法</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> String <span class="title">run</span><span class="params">(<span class="keyword">int</span> number)</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> IHandler <span class="title">getWordHandler</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> wordHandler;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight java"><figcaption><span>UnitHandler.java</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * User: David Date: 14-05-2 Time: 上午9:42</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UnitHandler</span> <span class="keyword">extends</span> <span class="title">WordHandler</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> IHandler[] unitHandlers;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UnitHandler</span><span class="params">(IHandler wordHandler,IHandler ... unitHandlers)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(wordHandler);</div><div class="line">        <span class="keyword">this</span>.unitHandlers = unitHandlers;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> IHandler[] getUnitHandlers() &#123;</div><div class="line">        <span class="keyword">return</span> unitHandlers;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> String <span class="title">run</span><span class="params">(<span class="keyword">int</span> number)</span> </span>&#123;</div><div class="line">        StringBuilder result = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">for</span> (IHandler handler : getUnitHandlers()) &#123;</div><div class="line">            <span class="keyword">if</span>(handler <span class="keyword">instanceof</span> WordHandler)&#123;</div><div class="line">                result.append(((WordHandler) handler).run(number));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> result.toString();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>个人不是很爱写注释，力求把代码写的简单易懂。WordHandler这个类就是通过在handler方法中调用run这个模板方法，而run方法在子类中去实现，当前handler如果没有结果，则会通过责任链将请求转发给下一个handler。<br>而UnitHandler则是构造函数运行传入任意数量个WordHandler，UnitHandler的run方法则是组合每个子handler的run方法来组合“与”规则，来达到与的效果。<br>具体的handler就不具体举例了，实现方法很简单。直接来看看如何调用吧。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">translate</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">        <span class="comment">//这里还可以用单例工厂模式就创建，这里就不画蛇添足了</span></div><div class="line">        IHandler commonNumberHandler = <span class="keyword">new</span> CommonNumberHandler();</div><div class="line">        IHandler fizzHandler = <span class="keyword">new</span> FizzHandler(<span class="keyword">null</span>);</div><div class="line">        IHandler buzzHandler = <span class="keyword">new</span> BuzzHandler(<span class="keyword">null</span>);</div><div class="line">        IHandler whizzHandler = <span class="keyword">new</span> WhizzHandler(<span class="keyword">null</span>);</div><div class="line">        IHandler fizzBuzzWhizzHandler = <span class="keyword">new</span> UnitHandler(</div><div class="line">                commonNumberHandler, fizzHandler, buzzHandler, whizzHandler);</div><div class="line">        IHandler containOneNumHandler = <span class="keyword">new</span> ContainOneNumHandler(</div><div class="line">                fizzBuzzWhizzHandler);</div><div class="line"></div><div class="line">        Word word = containOneNumHandler.handle(i);</div><div class="line">        <span class="keyword">return</span> word.say();</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>这个静态接口方法中通过组装需要的handler完成题目中所需要实现的游戏规则。handler的创建可以使用工厂模式，这里就不实现了，本次编码的重心并不在滥用设计模式上。</p>
<h2 id="5-测试"><a href="#5-测试" class="headerlink" title="5 测试"></a>5 测试</h2><p>本项目用Junit4来做单元测试，单元测试没什么新意，和Python中差不多。但是代码经过了很多次重构，重构后直接运行单元测试就明确知道代码没有问题，足以体现单元测试在敏捷开发中的重要性，就算不是敏捷开发，单元测试也对提高工作效率减少测试工作量监测返工有很大的作用。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * User: David</span></div><div class="line"><span class="comment"> * Date: 14-04-18</span></div><div class="line"><span class="comment"> * Time: 下午1:30</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="meta">@RunWith</span>(JUnit4.class)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FizzBuzzTest</span> </span>&#123;</div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GIVEN_One_SHOULD_SayOne</span><span class="params">()</span> </span>&#123;</div><div class="line">        assertEquals(<span class="string">"Failure - 1 should be 1"</span>, <span class="string">"1"</span>, WordMaker.translate(<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GIVEN_Three_SHOULD_SayFizz</span><span class="params">()</span> </span>&#123;</div><div class="line">        assertEquals(<span class="string">"Failure - 3 should be Fizz"</span>, Constants.WORD1, WordMaker.translate(<span class="number">3</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GIVEN_Five_SHOULD_SayBuzz</span><span class="params">()</span> </span>&#123;</div><div class="line">        assertEquals(<span class="string">"Failure - 5 should be Buzz"</span>, Constants.WORD2, WordMaker.translate(<span class="number">5</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GIVEN_Fifteen_SHOULD_SayFizzBuzz</span><span class="params">()</span> </span>&#123;</div><div class="line">        assertEquals(<span class="string">"Failure - 15 should be FizzBuzz"</span>, Constants.WORD1+Constants.WORD2, WordMaker.translate(<span class="number">15</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GIVEN_Thirty_SHOULD_SayFizzBuzz</span><span class="params">()</span> </span>&#123;</div><div class="line">        assertEquals(<span class="string">"Failure - 30 should be FizzBuzz"</span>, Constants.WORD1, WordMaker.translate(<span class="number">30</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GIVEN_Seven_SHOULD_SayWhizz</span><span class="params">()</span> </span>&#123;</div><div class="line">        assertEquals(<span class="string">"Failure - 7 should be Whizz"</span>, Constants.WORD3, WordMaker.translate(<span class="number">7</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GIVEN_TwentyThree_SHOULD_SayFizz</span><span class="params">()</span> </span>&#123;</div><div class="line">        assertEquals(<span class="string">"Failure - 23 should be Fizz"</span>, Constants.WORD1, WordMaker.translate(<span class="number">23</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GIVEN_HundredFive_SHOULD_SayFizzBuzzWhizz</span><span class="params">()</span> </span>&#123;</div><div class="line">        assertEquals(<span class="string">"Failure - 105 should be FizzBuzzWhizz"</span>, Constants.WORD1+Constants.WORD2+Constants.WORD3, WordMaker.translate(<span class="number">105</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="6-构建"><a href="#6-构建" class="headerlink" title="6 构建"></a>6 构建</h2><p>完成以后直接用mvn clean test package就好了，构建完成就可以在输入目录找到FizzBuzzWhizz-0.0.1-SNAPSHOT.jar，本文中就不介绍Maven的使用，详细可以参考之前写过的Maven系列博文（可能没有从Iteye迁移到LogDown上），控制台输出日志如下：</p>
<p>[INFO] Scanning for projects…<br>[INFO]<br>[INFO] ————————————————————————<br>[INFO] Building FizzBuzzWhizz 0.0.1-SNAPSHOT<br>[INFO] ————————————————————————<br>[INFO]<br>[INFO] — maven-resources-plugin:2.5:resources (default-resources) @ FizzBuzzWhizz —<br>[debug] execute contextualize<br>[INFO] Using ‘UTF-8’ encoding to copy filtered resources.<br>[INFO] skip non existing resourceDirectory D:\backup\wudw\code_temp_workspace\FizzBuzzWhizz\src\main\resources<br>[INFO]<br>[INFO] — maven-compiler-plugin:2.3.2:compile (default-compile) @ FizzBuzzWhizz —<br>[INFO] Nothing to compile - all classes are up to date<br>[INFO]<br>[INFO] — maven-resources-plugin:2.5:testResources (default-testResources) @ FizzBuzzWhizz —<br>[debug] execute contextualize<br>[INFO] Using ‘UTF-8’ encoding to copy filtered resources.<br>[INFO] skip non existing resourceDirectory D:\backup\wudw\code_temp_workspace\FizzBuzzWhizz\src\test\resources<br>[INFO]<br>[INFO] — maven-compiler-plugin:2.3.2:testCompile (default-testCompile) @ FizzBuzzWhizz —<br>[INFO] Nothing to compile - all classes are up to date<br>[INFO]<br>[INFO] — maven-surefire-plugin:2.10:test (default-test) @ FizzBuzzWhizz —<br>[INFO] Surefire report directory: D:\backup\wudw\code_temp_workspace\FizzBuzzWhizz\target\surefire-reports</p>
<hr>
<h2 id="T-E-S-T-S"><a href="#T-E-S-T-S" class="headerlink" title=" T E S T S"></a> T E S T S</h2><p>Running com.dragonsoft.fbw.FizzBuzzTest<br>Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.132 sec</p>
<p>Results :</p>
<p>Tests run: 8, Failures: 0, Errors: 0, Skipped: 0</p>
<p>[INFO]<br>[INFO] — maven-jar-plugin:2.3.2:jar (default-jar) @ FizzBuzzWhizz —<br>[INFO] Building jar: D:\backup\wudw\code_temp_workspace\FizzBuzzWhizz\target\FizzBuzzWhizz-0.0.1-SNAPSHOT.jar<br>[INFO] ————————————————————————<br>[INFO] BUILD SUCCESS<br>[INFO] ————————————————————————<br>[INFO] Total time: 4.128s<br>[INFO] Finished at: Mon May 05 23:21:47 CST 2014<br>[INFO] Final Memory: 3M/7M<br>[INFO] ————————————————————————</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/02/2014-05-02-python-version-of-fizzbuzzwhizz-b-reconstruction/" itemprop="url">
                  Python版FizzBuzzWhizz(二)--重构
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2014-05-02T14:21:00+08:00" content="2014-05-02">
              2014-05-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Python/设计/" itemprop="url" rel="index">
                    <span itemprop="name">设计</span>
                  </a>
                </span>

                
                
                  . 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Python/设计/fizzbuzzwhizz/" itemprop="url" rel="index">
                    <span itemprop="name">fizzbuzzwhizz</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#6 重构</p>
<h2 id="6-1-缺少常量"><a href="#6-1-缺少常量" class="headerlink" title="6.1 缺少常量"></a>6.1 缺少常量</h2><p>很多信息没有通过常量来读取，导致如果变化修改的成本很高。比如Ha如果我要改成Wa，那么我要修改项目中所有引用到的地方，包括单元测试。<br>那么引入常量类。</p>
<figure class="highlight python"><figcaption><span>const.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding:utf-8 -*-</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConstError</span><span class="params">(Exception)</span>:</span> <span class="keyword">pass</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">_const</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setattr__</span><span class="params">(self, k, v)</span>:</span></div><div class="line">        <span class="keyword">if</span> k <span class="keyword">in</span> self.__dict__:</div><div class="line">            <span class="keyword">raise</span> ConstError</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            self.__dict__[k] = v</div><div class="line">const = _const()</div><div class="line"><span class="comment">#三个转换单词</span></div><div class="line">const.WORD1 = <span class="string">'Fizz'</span></div><div class="line">const.WORD2 = <span class="string">'Buzz'</span></div><div class="line">const.WORD3 = <span class="string">'Whizz'</span></div><div class="line"><span class="comment">#模块名</span></div><div class="line">const.MODULE_NAME = <span class="string">'haHeiAh'</span></div><div class="line"><span class="comment">#方法名</span></div><div class="line">const.METHOD_NAME = <span class="string">'haHeiAh'</span></div><div class="line"><span class="comment">#报数人数</span></div><div class="line">const.NUM_PERSON = <span class="number">100</span></div><div class="line"><span class="comment">#报数间隔，如果不希望间隔请设置个大数字</span></div><div class="line">const.INDENT = <span class="number">15</span></div></pre></td></tr></table></figure>
<p>然后就是把需要用到的地方做个替换。</p>
<h2 id="6-2-不友好"><a href="#6-2-不友好" class="headerlink" title="6.2 不友好"></a>6.2 不友好</h2><p>交互性很差，不懂程序内部基本上无法调用方法。<br>增加交互性输入数字，增加输入信息校验，提供退出方法，提供分屏展现功能，提示信息有不同颜色字体区分。<br> <img src="http://i1.tietuku.com/b82f024cd064476b.jpg" alt=""><br>再看看代码中的实现：<br><figure class="highlight python"><figcaption><span>test.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="keyword">from</span> const <span class="keyword">import</span> const</div><div class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> exit</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">testHaHeiAh</span><span class="params">(p_a=<span class="number">3</span>,p_b=<span class="number">5</span>,p_c=<span class="number">7</span>)</span>:</span></div><div class="line">    moduleName = const.MODULE_NAME</div><div class="line">    methodName = const.METHOD_NAME</div><div class="line">    module = __import__(moduleName)</div><div class="line">    method = getattr(module,methodName)</div><div class="line">    <span class="keyword">print</span> <span class="string">"三个特殊数字为%d、%d和%d"</span> %(p_a,p_b,p_c)</div><div class="line">    method(p_a,p_b,p_c,const.NUM_PERSON)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getInputInt</span><span class="params">(title)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">3</span>):</div><div class="line">        attr = raw_input(<span class="string">"请输入%s："</span> %title).strip()</div><div class="line"></div><div class="line">        <span class="keyword">if</span> len(attr) == <span class="number">0</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">"您输入的%s为空，请重新输入"</span> %title</div><div class="line">            <span class="keyword">continue</span></div><div class="line">        <span class="keyword">elif</span> len(attr) != <span class="number">1</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">"您输入的%s不是个位整数，请重新输入"</span> %title</div><div class="line">            <span class="keyword">continue</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                <span class="keyword">return</span> int(attr)</div><div class="line">            <span class="keyword">except</span> ValueError:</div><div class="line">                <span class="keyword">print</span> <span class="string">"您输入的%s不是数字，请重新输入"</span> %title</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">"连续3次输入错误，程序退出！"</span></div><div class="line">        exit()</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    testHaHeiAh(getInputInt(<span class="string">'第一个数字'</span>),getInputInt(<span class="string">'第二个数字'</span>) ,getInputInt(<span class="string">'第三个数字'</span>) )</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><figcaption><span>haHeiAh.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding:utf-8 -*-</span></div><div class="line"><span class="keyword">from</span> const <span class="keyword">import</span> const</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">haHeiAh</span><span class="params">(num_a,num_b,num_c,num_person)</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"%d个学生开始报数："</span>%num_person</div><div class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> xrange(<span class="number">1</span>,num_person+<span class="number">1</span>):</div><div class="line">        <span class="keyword">if</span> num != <span class="number">1</span> <span class="keyword">and</span> (num<span class="number">-1</span>) %const.INDENT == <span class="number">0</span> :</div><div class="line">            command = raw_input(<span class="string">"继续查看下%d个请按ENTER（回车），退出请输入q按回车:"</span> %const.INDENT )</div><div class="line">            <span class="keyword">if</span> command == <span class="string">'q'</span>:</div><div class="line">                <span class="keyword">break</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"第%s个学生报数%s！"</span> %(str(num) , str(hhaHandle(num,num_a,num_b,num_c)))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hhaHandle</span><span class="params">(num,num_a,num_b,num_c)</span>:</span></div><div class="line">    <span class="keyword">return</span> const.WORD1[<span class="number">0</span> <span class="keyword">if</span> str(num).find(str(num_a)) &gt;= <span class="number">0</span> <span class="keyword">else</span> len(const.WORD1):] <span class="keyword">or</span> const.WORD1[num%num_a*len(const.WORD1)::]+const.WORD2[num%num_b*len(const.WORD2)::] +const.WORD3[num%num_c*len(const.WORD3)::] <span class="keyword">or</span> num;</div></pre></td></tr></table></figure>
<p>#7 再次运行单元测试<br>重构完记得再次运行单元测试。单元测试除了设计驱动外，还有对重构进行保护的作用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">[David@localhost haheiahx]$ python testHaHeiAh.py</div><div class="line">----------------------------------------------------------------------</div><div class="line">Ran 1 test in 0.000s</div><div class="line">OK</div></pre></td></tr></table></figure>
<p>#8 文档<br>最后是补充文档，包括项目介绍、运行环境说明、部署脚本介绍等，具体可以连接到github上查看。这里就不贴出来了。</p>
<p>#9 结束<br>有空的话把Java的思路整理下也写成博文，node.js的就算了。思路和python的差不多。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="David Woo" />
          <p class="site-author-name" itemprop="name">David Woo</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/">
              <span class="site-state-item-count">97</span>
              <span class="site-state-item-name">Artikel</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">195</span>
                <span class="site-state-item-name">Kategorien</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">Tags</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">David Woo</span>
</div>

<div class="powered-by">
  Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>

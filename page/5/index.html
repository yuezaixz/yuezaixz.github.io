<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="大胃吴的闲话唠嗑">
<meta property="og:url" content="http://yoursite.com/page/5/index.html">
<meta property="og:site_name" content="大胃吴的闲话唠嗑">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="大胃吴的闲话唠嗑">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/page/5/"/>

  <title> 大胃吴的闲话唠嗑 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">大胃吴的闲话唠嗑</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">扯扯技术，唠唠闲话</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/07/23/2014-07-23-architecture-design-sharing-records-of-the-company/" itemprop="url">
                  公司架构设计交流分享记录
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-07-23T14:54:00+08:00" content="2014-07-23">
              2014-07-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/架构设计/" itemprop="url" rel="index">
                    <span itemprop="name">架构设计</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>架构交流-李炜</p>
<p>#1 什么是架构设计<br>主讲人分三点阐述：</p>
<ul>
<li>架构是阐述结构与结构之间的关系与通信</li>
<li>还是一个过程，关注过程中人的重要性</li>
<li>关注风险，把实施过程中的风险提前暴露出来，并通过架构设计规避</li>
</ul>
<p>#2 架构设计的过程</p>
<p>##2.1 瀑布<br>在小型且需求明确的项目中，可以使用简单的瀑布模型，也就是系统概念化、系统需求分析、概要设计、详细设计、实施与测试、验收与结项。</p>
<p>##2.2 增量式<br>增量式为先完成整个系统中的某个模块，慢慢的在架构上增量的增加内容。</p>
<p>##2.3 迭代式<br>开始先简单设计，完成一个比较粗糙的原型，再在这个基础上做迭代的扩展。</p>
<p>#3 如何驱动架构设计<br>这个在不同的软件开发过程，不同的架构师，就有不同的理解。主讲人的团队是采用RUP的开发模式，所以他们基本以用例和质量为驱动，以过程为导向。<br>而Scrum敏捷开发中大多数情况是以测试为驱动，以用户故事为导向，而在我当前项目中，软件过程虽然为敏捷，但是执行的比较不彻底，也额米有具体的驱动方式，大多数情况还是跟着业务需要走，所以为业务导向，因此也处于比较被动的驱动状况。</p>
<p>#4 如何验证架构设计</p>
<p>##4.1 技术预研<br>如果各个模块用到的技术存在外部的技术框架，那么需要做前期的技术预研，通过技术、特征二维表的方式，列举出各个技术的优劣，然后通过评审的方式决定。</p>
<p>##4.2 测试<br>通过测试，在特定的测试环境中，用测试DEMO运行的方式，发现架构的问题所在，比如性能的瓶颈是在磁盘吞吐还是并发上。</p>
<p>#5 架构设计关注什么</p>
<p>##5.1 功能需求<br>主讲人拿了调度引擎模块的需求来做案例，主要是需要关注功能需求中哪些因素是变化的，哪些因素是不变的，比如调度引擎的作业和作业之间的逻辑关系，就是变化的因素。<br>还要关注需求的关键点，比如调度引擎的作业可以并发，也可以同步执行。</p>
<p>##5.2 非功能性需求<br>比如，需要关注系统的质量，包括稳定性、安全性、鲁棒性、可扩展性、可维护性、易用性等。</p>
<p>##5.3 约束<br>约束的因素角度，作者大概阐述几点，这些约束就是一个框框，架构师必须在这个框框内衡量，在各种约束中做取舍，做平衡。</p>
<p>###5.3.1 技术环境<br>比如，用户提出必须用JAVA开发。</p>
<p>###5.3.2 业务环境<br>比如，使用的技术或者成果是受保护的专业知识产权。</p>
<p>###5.3.3 构建环境<br>比如，需要根据研发团队和现场交互团队的能力衡量架构实施的难易度。</p>
<p>###5.3.4 使用环境<br>比如用户提出，需要兼容IE6，或者需要在平板上也能正常浏览。</p>
<p>###5.3.5 易用性问题<br>这里的易用性不是指产品经理关注的易用性问题，而是构建、部署的易用性问题。</p>
<p>#6 什么时候开始做架构设计<br>主讲人阐述，在项目启动过程中就需要介入。</p>
<p>#7 怎么表达我们的架构</p>
<p>##7.1 分层<br>大多数情况看到的架构就是系统各个模块之间的分层，通过分层展现他们之前的依赖关系。</p>
<p>##7.2 4+1视图<br>该方法为RUP开发中的工具，个人RUP就是以用例、质量为驱动，基于构件，注意UML等工具建模，以架构为中心、迭代增量。</p>
<p>###7.2.1 逻辑视图<br>如何根据功能需求、非功能需求划分你的模块，梳理各个模块之间的关系与通信机制。</p>
<p>###7.2.2 开发视图<br>关注质量，包括扩展性、重用性、移植性、易用性、易测试性等。</p>
<p>###7.2.3 处理视图<br>处理视图关注进程、线程、对象等运行时概念，以及相关的并发、同步、通信等问题，经常通过时序图方式来做。</p>
<p>###7.2.4 物理视图<br>如何部署，部署到哪些机器上。</p>
<p>###7.2.5 场景视图<br>主讲人未讲，或者我漏了这块。</p>
<p>#8 架构师分类</p>
<p>##8.1 PPT架构师<br>只通过PPT，对系统模块进行简单的分层。</p>
<p>##8.2 集成架构师<br>只是简单的把市面上出现的技术方案集成到一起。</p>
<p>##8.3 创作型架构师<br>真正的架构师应该是才华横溢，像一个作家一样。这点我非常赞同，格雷厄姆的《黑客与画家》也阐述了软件设计是多么具有创造性的一个职业。</p>
<p>#9 如何实现设计<br>主讲人分三点阐述：</p>
<ul>
<li>先做接口，再做抽象类，可以避免包与包的依赖关系</li>
<li>包从下往上设计，接口从上往下设计</li>
<li>包的接口放包外，消除包与包的依赖关系</li>
</ul>
<p>#10 案例<br>模块的类型无非三种，高并发、高吞吐以及高并发高吞吐。<br>在高并发高吞吐的情况下就可以做一种架构，就是把高并发转换成高吞吐，采用反应堆设计模式和广告过滤器模式通过异步的方式做。</p>
<p>##10.1 反应堆设计模式<br>按作者的阐述，我理解就相当于去饭店吃饭，里面已经满客了，外面就有一个服务员（线程）专门负责给来到的客人（请求）排号，排号后安排相应的接待员（处理器）去负责给予点菜。</p>
<p>##10.2 广告过滤器模式<br>这个中间离开了一会，不是很理解，百度也没找到相应的问题，我理解就是通过一层一层的过滤，将信息拦截后再通过一定规则转发到下一层。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/06/30/2014-06-30-chinese-style-project-management-reading-record/" itemprop="url">
                  《中国式项目管理》读记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-06-30T00:02:00+08:00" content="2014-06-30">
              2014-06-30
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/项目管理/" itemprop="url" rel="index">
                    <span itemprop="name">项目管理</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/项目管理/读记/" itemprop="url" rel="index">
                    <span itemprop="name">读记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="《中国式项目管理》读记"><a href="#《中国式项目管理》读记" class="headerlink" title="#《中国式项目管理》读记"></a>#《中国式项目管理》读记</h2><p>#1 概述</p>
<p>##1.1 什么样的项目是成功的<br>该问题的关键不在于费用是否超支，是否超出进度，而在于， <strong>老板（客户）为什么要花钱做这件事 </strong> ，必须从业务角度去思考，而不是从技术实现上思考。 <strong>理解业务动机是项目成功的关键</strong> 。</p>
<p>##1.2 什么有PMP这么复杂的一整套管理理论<br>之前我也一直思考这个问题，项目管理的理论相对于敏捷来说，他过于复杂了，为什么还有人照搬这一套。这本书里很好的解释了这个道理，因为这样的项目成功是可以复制的。<br>也许靠一些牛人，他们用自己独特的管理方式可以实现敏捷，但是这种靠人的工作存在很大的风险。而且一个公司一般不只有一个项目再跑，如果只有一个，完全不需要所谓的流程，但大量的项目，很难保证对每个人的能力和每一个细节都有所把握，那一整套成熟的机制和理论就显得安全可靠。<br><strong>把牛人们的经验转化成流程，这才最有价值</strong> 。敏捷极限编程中的Scrum就是一种比较容易复制、成熟可靠的流程。</p>
<p>##1.3 面对严重技术问题时候怎么办？<br>组织技术人员进行讨论？需找可能的解决方案？找更有经验的专家寻求帮助？这些当然都需要，当然作为一个项目经理，你还必须 <strong>专业地评估、有效的沟通、有力的执行</strong> 。<br>先评估该问题可能造成的影响，成本超支？进度延误？重要的里程碑受到影响？对于客户、下包方、合作伙伴的影响？<br>然后是沟通，这也是评估的目的，比如你可以把你评估的结果和老板沟通，出了什么事，为什么会出，有什么影响，打算怎么做，计划是什么，当前情况什么样，需求什么资源，最重要的是你需要老板出面帮你做什么。<br>最后是执行，执行过程中切记每个事情都必须有人做，但一定不都是你在做，作为项目经理更应该做的是从业务、管理、团队、项目计划、资源协调等层面对项目进行控制。</p>
<p>#2 项目需求</p>
<p>##2.1 需求必须是业务导向的<br>认真思考你的项目目标到底解决了用户哪方面的问题，然后再选择技术方案、指定项目规划、确定验收标准。</p>
<p>##2.2 老板不一定正确<br>老板告诉你的只是一个思路，他所说的想法不一定正确，如果一成不变的按着老板说的走，那么必将走很多弯路。而你需要帮老板去验证他的想法是否正确，然后把自己的想法委婉的说出来，最后一定要说，请问我的想法是否正确。</p>
<p>##2.3 需求是需要确认的<br>虽然没有不变的需求，但是至少在项目启动阶段之前，就必须把需求确认好。如果老板把这事情拖着，那么你要主动推进。</p>
<p>##2.4 弄清楚谁是项目干系人<br>弄清楚谁是项目干系人，需求到底要找谁谈。你必须保证项目干系人在需求上达成一致，而且别弄错了项目干系人。</p>
<p>##2.5 争吵<br>在需求阶段有争吵是难免的，别把事情藏着掖着，有问题就必须提出来，毕竟在需求阶段更改的成本还是最低的。</p>
<p>##2.6 必须需求中有模糊的概念<br>比如，系统很大很安全，那什么程度能达到“很”呢，需要斟酌。</p>
<p>##2.7 引导和聆听<br>在需求讨论中，引导和聆听是必须的沟通技巧，阐述自己的观点只是辅助性的。</p>
<p>#3 项目计划</p>
<p>##3.1 开始阶段必须做好论证和规划<br>在开始阶段，舍得花时间进行论证和规划，不厌其烦的把项目干系人抓来沟通，要顶得住压力把模糊的问题谈清楚。在这个阶段修改方案和项目计划还是来得急的。</p>
<p>##3.2 里程碑节点比验收节点更重要<br>里程碑节点是一个一个的检查点，他并不像验收节点那样是硬性的，但是必须更看重，做好进度上的控制。</p>
<p>##3.3 项目计划必须是现实的<br>必须站在现实的角度上去做计划，不要用太多的假设，什么如果资源满足的情况下，如果客户不变更需求，这些都必须考虑在内，做好风险清单。</p>
<p>##3.4 资源的争取<br>资源冲突在职能型组织是常见的，把资源落实到人头上，要到具体的人，而不是虚席以待，而且需要做好沟通，争取更优更多的资源。</p>
<p>##3.5 达成共识<br>项目计划不能是你认为正确的，还必须和项目干系人、协作部门打成一致，你认为正确的并不是他们认为正确的，站在他们的角度可能有更重要的事情要处理。</p>
<p>##3.6 计划要简洁<br>视图用最小的篇幅、最短的额时间让客户（老板）理解你的意图。</p>
<p>##3.7 风险一定要落实到计划<br>形成风险清单，落实到计划，每周例会检查，确保风险都在控制当中，并且做好风险应对措施。</p>
<p>#4 项目控制</p>
<p>##4.1 风险控制必须是持续的过程<br>当识别到一个风险的时候，把他列入项目风险清单中，每周周会都拿出来讨论，这是安全而有效的方法。<br>当你的老板每周都询问你这个事情的时候，你想忘记他都会很难，你都会去确定该风险<br>当前是否在控制当中。</p>
<p>##4.2 项目启动阶段项目经理的工作<br>在这个阶段，项目经理必须确认的三个事情是需求、方案与工作模式。<br>首先，把需求搞清楚，做什么，为什么做，如何验收，验收的标准是什么？<br>然后，要拿到授权，确认工作团队，把资源落实到位；<br>最后，理清内部分工、工作机制与流程。</p>
<p>##4.3 项目整体计划阶段项目经理的工作<br>在这个阶段。要做的不仅仅是开会和写文档，而是要协调沟通与妥协。例如客户方要求采用新的开发平台，那么这个决定将导致进度延期，那么你必须去了解他有这个想法的初衷、根本想法是什么，是否可以协调沟通呢？<br>还有，你预估的一个里程碑点被领导残忍的压缩了，你也必须去沟通了解这个里程碑点有这个要求的原因是什么？市场需要还是什么？这时候你就可以计划在指定时间内完成需要的交付物，剩下一些东西可以在里程碑后去完善。</p>
<p>##4.4 项目执行阶段项目经理的工作<br>在执行阶段，会有诸多问题，但是切记不要被事情推着走，要主动推进事情。</p>
<ul>
<li>要在过程中寻找节奏感，这节奏感长期考里程碑，短期靠例会。</li>
<li>后看一，前看三，每次例会了解上周做了什么以及之后三周要做什么。</li>
<li><p><strong>周会必须有两周表要讨论，风险清单和问题清单</strong> 。确保问题都在风险表上而不是问题表上。<br>##4.5 关于项目文档<br>很多项目文档在工人层面确实是没有用的东西，但是对于组织来说就是宝贵的过程资产。<br>写文档必须搞清楚写给谁看，目的是什么，管理层最希望看到的文档是什么样的。<br>善于使用一些图标，更易于理解。<br>##4.6 关于协作沟通<br>在中国这个讲人情的地方，并不是你得到了授权，你把老板搬出来就能让别人就范。很多时候还是需要一些应酬，人际沟通是一种润滑剂，缺少了这，你就会被流程卡住的。<br>##4.7 项目成员的跨部门管理<br>项目经理在人的晋升、涨薪方面是很弱势的，所以要让别人听你的，必须有一些手段：</p>
</li>
<li><p>理清楚这个项目能带给他们什么，有时候一个人的意愿比经验更重要；</p>
</li>
<li>要让大家信服你，包括你的技能、处事态度和人品；</li>
<li>和管理层保持沟通（不要直接用老板压别人，要先从道理上让别人知道这是你应该做的事，再用柔性的办法去沟通）</li>
</ul>
<p>项目经理不一定是资源的管理者，但一定是业务的推动者，你的价值，需要靠你自己去证明，不要总抱怨没有资源，必须证明自己的价值。</p>
<p>##4.8 对于项目变更<br>完全没有变更的项目是不存在的，能做的是：</p>
<ul>
<li>在项目需求阶段，尽可能的把需求理清楚；</li>
<li>在项目执行阶段，对一切需求变更做变更流程，如把变更造成的进度影响告知领导，在这种影响的前提下，变更是否审核；</li>
<li>变更后要相应的调整计划与文档。</li>
</ul>
<p>#5 项目团队与沟通</p>
<p>##5.1 项目经理的一天<br>项目经理应该面向全局但同时也要关注细节，一定要找对感觉，闷头做事一定会出问题的。到晚上想及同年做了什么，发现想不起来，那真是“忙晕了”。那什么最重要呢？</p>
<ul>
<li>首先，如果流程除了问题，必须首先解决；</li>
<li>与重要的干系人沟通、协调、妥协……向管理层争取资源</li>
<li>写文档（这同样是非常重要的，必须保证文档与项目现状保持一致）</li>
</ul>
<p>##5.2 工作热情比工作经验更重要<br>调动每一个成员的工作热情，是项目经理必须做的工作，但是这很难。作为一个弱势的管理者，有意愿往往比有经验更重要。<br>有经验的人可以降低项目的技术风险，但是成本高且不容易管理。</p>
<p>##5.3 项目经理在沟通中的作用<br>明确目标、理清模式，是项目经理在沟通中的主要工作。<br>项目团队是临时的，是一个多样性的团队，文化、技能、性格、地域可能都不同，你不可能改变别人，更不可能改变环境，你能做的只是适应环境。</p>
<p>##5.4 沟通中要因人而异<br>当要说服一个技术骨干接手一个项目，但是非常抵触。你应该做什么？画饼？给实际利益？晓之以理（这个项目就你最合适了）？动之以情（兄弟，你一定要帮我一把啊）？都不是，最重要的是你要知道他觉得什么是最重要的，比如原因是他刚结婚，想和媳妇在一起，那么，能不能说服他，让他觉得去的地方也不错，带上媳妇一起去呢？</p>
<p>##5.5 MBTI理论<br>迈尔斯-布里格斯类型指标。</p>
<p>###5.5.1 认知与判断<br>判断型（J）    知觉型（P）<br>做了决定后最为高兴    当各种选择都存在时，感到高兴<br>有“工作原则”：工作第一，玩其次（如果有时间的话）    “玩的原则”：现在享受，然后再完成工作（如果有时间的话）<br>建立目标，准时地完成    随着新信息的获取，不断改变目标<br>愿意知道它们将面对的情况    喜欢适应新情况<br>着重结果（重点在于完成任务）    着重过程（重点在于如何完成工作）<br>满足感来源于完成计划    满足感来源于计划的开始<br>把时间看作有限的资源，认真地对待最后期限    认为时间是可更新的资源，而且最后期限也是有收缩的<br>理论上讲，判断是项目控制的基础，J类型的人在项目管理上有很大的又是，而且大多数人也都会喜欢判断性的人，但是，这样的人在中国的商业环境中却很痛苦，很难将事情处于绝对控制中，应该不变是相对的，变化是绝对的。P型的人才往往有更大的灵活性，能在突发情况的时候能力越强。</p>
<p>###5.5.2 感觉与直觉<br>感觉型（S）    直觉型（N）<br>相信确定和有形的东西    相信灵感或推理<br>对概念和理论兴趣不大，除非它们有着实际的效用    对概念和理论感兴趣<br>重视现实性和常情    重视可能性和独创性<br>喜欢使用和琢磨已知的技能    喜欢学习新技能，但掌握之后很容易就厌倦了<br>留意具体的、特定的事物；进行细节描述    留意事物的整体概况、普遍规律及象征含义；用概括、隐喻等方式进行表述<br>循序渐进地讲述有关情况    跳跃性地展现事实<br>着眼于现实    着眼于未来，留意事物的变化趋势，惯于从长远角度看待事物<br>直觉型的人，相信直觉、关注大局、更加在意时期你发招的趋势和各种可能性。S型的人，相信经验、关注细节、更加在意眼前发生的具体的事情。<br>当你说服一个感觉型人的时候，不能画饼，要讲实际的效益，比如这个项目存在补助，而对于直觉型的人，画饼往往更好。他们看重未来。<br>当你和一个直觉型的老板汇报项目，那么，你把要点说清楚就够了，而和一个感觉型的老板汇报，那么你最好把细节都想清楚了，时刻防止被刨根问底。</p>
<p>###5.5.3 内向与外向<br>外倾型（E）    内倾型(I)<br>与他人相处时精力充沛    独处时精力充沛<br>行动先于思考    思考先于行动<br>喜欢边想边说出声    在心中思考问题<br>易于“读”和了解；随意地分享个人情况    更封闭，更愿意在经挑选的小群体中分享个人的情况<br>说的多于听的    听的比说的多<br>高度热情地社交    不把兴奋说出来<br>反应快，喜欢快节奏    仔细考虑后，才有所反应<br>重于广度而不是深度    喜欢深度而不是广度<br>内向的人，往往需要在心里把事情想清楚，才愿意和别人进行沟通，对于不是很清晰的事情，他未必会和你深入地交流。而对于外向型的人，讨论有时只是进行思考的一种方式，没有充分的讨论，他们很难理清自己的思路。<br>所以当你和一个内向型的人打交道时，最好就是提前把所有资料发给他，总之，你要为对方留出思考的时间，而不要在开会时强求对方表态。</p>
<p>###5.5.4 思维与情感<br>思维型（T）    情感型（F）<br>退后一步思考，对问题进行客观的、非个人立场的分析    超前思考，考虑行为对他人的影响<br>重视符合逻辑、公正、公平的价值；一视同仁    重视同情与和睦：重视准则的例外性<br>被认为冷酷、麻木、漠不关心    被认为感情过多，缺少逻辑性，软弱<br>认为坦率比圆通更重要    认为圆通比坦率更重要<br>只有当情感符合逻辑时，才认为它可取    无论是否有意义，认为任何感情都可取<br>被“获取成就”所激励    被“获得欣赏”所激励<br>很自然地看到缺点，倾向于批评    惯于迎合他人，着重维护人脉资源<br>这是从作决策的方式来看。仅看这个维度的名称，也许你会觉得，思维型的人是理性的，而情感性的人是非理性的，事实上并非如此。两类人都有理性思考的成分，但作决定或下结论的主要依据不一样。情感型的人常从自我的价值观念出发，变通地贯彻规章制度，做出一些自己认定是对的决策，比较关注决策可能给他人带来的情绪体验，人情味较浓。思维型的人则比较注重依据客观事实的分析，一以贯之、一视同仁地贯彻规章制度，不太习惯根据人情因素变通，哪怕做出的决定并不令人舒服。<br>思维型的人说话有时候不会顾及别人的感受，只说在说一个正确的事情，就像贝索斯小时候计算他外婆因为抽烟减寿多少，这是一个可以说是正确的结论，但是，他没有顾及外婆外公的感受，他外公和他说，天赋是天生的，而善良更为重要。<br>思维型的人考虑问题道理很重要，他们关注正确性而不是对方的感受。而情感型的人关注人，他们关注情感，有时候甚至可以在原则上做出让步。</p>
<p>##5.6 问题解决了吗？<br>有时候，让步这个解决问题的方式并不有效。虽然在结果上出于各方压力做出了让步，但是情绪上的问题并没有解决，同样会在情绪上反击你。所以，解决问题的关键在于 <strong>先情绪，后问题</strong> 。</p>
<p>##5.7 学会说No，但必须有技巧<br>刚从事项目经理，为了让干系人都满意，基本上对于别人提出的事情都不会说No，但是，这样往往把自己搞的很累，也把小组的人也都搞的很累。要适当的学会说No，而且还要有技巧，有时候坚持自己的原则，做正确的事，更容易赢得别人的信任。</p>
<p>#6 后记<br>项目经理是一个权力小，责任大的职位，他作为一个职业转型期，是自我价值的重新定位。并从专家转变为业务导向的推进者，他对人在计划、沟通、控制、处理冲突等技能有很好的锻炼。并且能锻炼一个很好的心态和心里素质。<br>一定不要抱怨，你要有强健的内心，为团队传递正能量，你必须让自己有价值。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/06/15/2014-06-15-monday-morning-leadership/" itemprop="url">
                  Monday Morning Leadership 
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-06-15T08:50:00+08:00" content="2014-06-15">
              2014-06-15
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/总结/读后感/" itemprop="url" rel="index">
                    <span itemprop="name">读后感</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/总结/读后感/管理学/" itemprop="url" rel="index">
                    <span itemprop="name">管理学</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/总结/读后感/管理学/领导课/" itemprop="url" rel="index">
                    <span itemprop="name">领导课</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近看了一本领导推荐给我的书，还挺不错的，本文为该书的读后感，结合了我的个人想法。</p>
<h2 id="周一清晨的领导课"><a href="#周一清晨的领导课" class="headerlink" title="周一清晨的领导课"></a>周一清晨的领导课</h2><p>#1 改变<br>从一个普通员工转变为团队领导，首先需要转变以往的做事习惯，做一个领导该做的事情。<br>打个比方，当你作为乘客坐在车上，你可以做你想做的事情，比如听歌、看书，但是，如果有一天你成为了司机，你就不能在做这些了，你需要对自己负责，更要对你车上的每个人的生命负责。<br>当我还是一名普通的开发人员的时候，我可以把我的精力都专注在开发上，当我成为团队开发管理者时候，我没有及时的改变这个身份，仍然把很多时间花在了开发、设计工作上。作为一个司机，首先我没看路，对整个项目组应该做什么、做到什么程度把控不足，就算有时候我自己清晰的知道目标，但是我没有把目标很好的传递给我的乘客，他们坐在我的车上很茫然，不知道下一站是何处。<br>这时候，他们完成的东西也就很茫然，这样团队陷入，甚至他们也不知道自己做的是否符合要求，是否正确。导致我这个司机觉得车内一切正常，而不知道其实车内都已经要着火了，陷入了管理黑洞。<br>因此，在试错失败后，我首先应当做一个改变， <strong>我应当花更多的时间解决问题，而不是责备别人，如果出了问题都应当是我的责任，我应当把眼光投向未来，而不是专注的眼前开发设计上的细节，我要为他人的时间负责</strong> 。</p>
<p>#2 弄清目标<br>首先，应当找出当前的首要问题，知道当前最需要紧急完成的事情是什么，如果有疑问，应当和我的领导和团队成员们一起讨论这个问题。了解领导和团队成员他们所认为的最首要的问题是什么，他们对我的期望是什么？<br>你认为的首要问题必须要和你的领导一致，在很多情况下，这是会有偏差的。就像你的团队成员所认为的很可能也与你认为的有偏差。<br><strong>认清团队的首要问题，如果有人让你的团队做首要问题以外的事情，告诉你的团队成员，他们有权拒绝，不管是谁的要求。</strong></p>
<p>##2.1 从离职中找原因<br><strong>团队成员的离职，大多数情况都是出于对现在领导的不满，请搞清楚他们对你不满的地方</strong>。大多数情况下原因都是：他们的领导目标不清晰；并且缺少对他们进行反馈；让他们的工作变得不可度量。领导最重要的三件事情就是：消除团队成员的迷惑；告诉团队成员获取成功的方法和手段；为顾客提供出色的服务，并盈利。</p>
<p>##2.2 把目标写下来<br>当你把这些都写下来时，你便做出了实施的承诺。如果你只是口头上说你想做什么，就不会对你构成约束。 <strong>把目标写下来，这样你才能记得更清楚</strong> 。</p>
<p>##2.3 很少人指定目标的原因<br><strong>对活到老学到老认同很容易，但除非你订立具体的目标</strong> ，否则将一无所获。很少人制定目标的原因：</p>
<ul>
<li>不知道制定目标的重要性</li>
<li>不知道该如何制定目标</li>
<li>有时候人们因为害怕失败不敢订目标</li>
<li>定目标代表者要离开舒适地带</li>
</ul>
<p>#3 如何对员工负责<br>作为一个管理新手，很容易陷入管理黑洞。7个月的管理工作中，我经常处于不知道团队成员工作状态的情况下，一部分原因是他们有选择的汇报，更重要的一方面是因为，我并没有去关注他们的进度以及没有对他们进行反馈。<br>要改变，首先，对团队成员的 <strong>工作要是可度量的，不要让优秀的员工一直忙碌，而欺上瞒下的人反而游手好闲，解雇那些在其位不谋其职的人</strong> ；<br>然后，要 <strong>指导每个员工，给予足够的反馈和指导</strong> ；<br>再次，要意识到， <strong>自己的受挫、团队成员的失望是因为自己没做好分内的事情，如果团队成员不把自己的迷惑告诉领导，而总是说经理爱听的话，那么我就陷入了管理黑洞</strong> 。</p>
<p>##3.1 对团队成员进行分类<br>大多数团队分三类雇员：</p>
<ul>
<li>超级明星-富有经验和学识，现在岗位上发挥最佳作用的人</li>
<li>中层星-他们也许还不具备超级明星所拥有的经验或者以前是现在由于某些原因失去了争第一的动力</li>
<li>流星-尽量逃避责任，希望担子越轻越好</li>
</ul>
<p>典型团队中各类成员的比例为3：5：2。<br>团队中，有些人不管肩上担子多重，也是超级明星，但也有些人会因为压力被压成中层明星，如果你答谢流星并且少派些工作给他们，那么更多人会沦落到这一组中。<br>因此， <strong>你的职责并不是通过关照业绩最差的雇员，来降低最低限。你应当通过承认并嘉奖超级明显来提高上限</strong> 。<br>可以做一个统计，把你的团队的每个人的名字写下来，给他们划分层次，然后打个分数，最后把他们最近六个月中受到嘉奖都记录下来。看看是否奖符其实。</p>
<p>##3.2 团队成员对领导的期望<br>员工对领导的期望：</p>
<ul>
<li>雇佣优秀的员工并指导每个员工，让他们变得更优秀</li>
<li>解雇那些在其位不谋其职的员工</li>
</ul>
<p>##3.3 总结<br>逃离管理黑洞的方法：</p>
<ul>
<li>与下属保持联系</li>
<li>你的职责并不是通过关照流星来降低最低线</li>
<li>你应当通过承认并嘉奖超级明星来提高最上限</li>
</ul>
<p>#4 坚持正确的行为准则<br>在我做管理的七个月中，很多时候犯了这个错误。因为进度压力，因为资源能力问题，因为现有系统设计束缚。很多问题都存在问题，有的采用临时性的解决办法，很多甚至都忽视过去了。<br>一个团队应当有一套正确的行为准则，如果没有一套行为准则，很难知道什么是对的，就像飞行员使用的意外事故手册，当遇到危机，立马就能知道应该如何应对。如果让飞行员在发生事故时候在想如何应对，这很难。<br>做正确的事并非轻而易举，事实上有时真的很难，但要记住，做正确的事始终都是正确的。当你的团队成员做了不正确的事情，请不要忽视问题，不要因为怕别人认为你没有同情心、死板、教条主义就忽视这个问题，因为，通常来说，经理是团队最后一个知悉问题的人，而且经理所看到的一般只是一小部分而已。像冰山的一角，在睡的上面，你看到的是冰尖，而藏在水下的要大得多，通常都更具有破坏性。因此 <strong>员工往往看到的问题更多，经理忽视问题，那就是拿自己正直的口碑冒险</strong> 。<br><strong>你应该为长期的、持久的成功，而不是为短期的方便来提高最高标准</strong> 。短期内见效很容易。你可以威胁下属、支付更高的心说，或者只是满足他们的需要，就可以赢得短期目标了。长期想见效比较难，需要建立一套大家都必须遵守的行为准则；需要有准确的反馈意见；需要根据下属所做的决策（积极或消极）实施相应的办法。你一切都需要你鼓起勇气，坚持正确的做法。<br>做正确的事并非轻而易举，事实上有时真的很难，但要记住，做正确的事始终都是正确的。忽视问题而不采取正确的行动，问题实际上不会自动消失。 <strong>你必须有所行动，你必须用正确的方式来解决问题</strong> 。<br>所以，之后的管理中，应当花更多的时间在代码、设计、需求的检查上，减少因为忽视问题导致的返工。</p>
<p>#5 需找合适的团队成员<br><strong>一个好的团队成员，他能减少你很多的管理工作</strong> 。因此，需找合适的团队成员，解雇那些不合适的团队成员。并为解雇某个犯错的员工释然，他们的反应一般是：这是别人的错、管理者没有同情心、过失是可以被原谅的，牢记这是他们自己选择了解雇自己，我们只是在执行他的决策而已。<br><strong>公司最重要的财富的合适的员工（right people）</strong> 。招聘应当精挑细选，管理起来就会容易得多，并且让加入你的团队成为一种特权。空缺的职位让你费时费力，你想快点填补。带着这种感情，你会速战速决的选择并非很合适的人。为填补一个职位空缺而降低标准，以后你会为此付出代价的。<br>现在在进度的压力下，往往经常是不得不降低标准来寻找可以干活的人。我认为，可以暂时放低业务和技术上的标准，但是对于行为上的标准不能降低，不能让任何人破坏团队的标准。</p>
<p>#6 管理好时间，提高效率<br>很多部门的同事会说，没有时间学习，一直都处在很忙的状态下。我自己虽然在学习上不会觉得缺少时间，但是，在于一堆各式各样错综复杂的工作上，我总是让自己显得很忙。其实，很多时候是自己没有管理好自己的时间，这些不可控的事情，让自己又觉得焦虑。<br><strong>压力、焦虑和苦恼的主要原因在于，你觉得生活失控了</strong> 。那是因为你好像在把管理时间的问题归咎于不可控制的事务。那么，除了你之外，谁还能花你的时间呢？你要想办法统筹自己的时间，这样就可以控制自己的生活。<br>充分分析，你把时间都花在了什么地方（可以考虑用番茄钟），回顾上两周时间的安排，这样对如何改进，你可以做出有根有据的决策。<br>思考下这两个问题：我们花在主要的事物和错事上的额时间各有多少。可以从做的事情和方式两个角度来分析安排时间，在上两周，我们做了主要的事务吗？做对了吗？</p>
<p>##6.1 更好安排时间<br>可以通过三方面的改进来更好安排时间：</p>
<ul>
<li>理清事务的轻重缓急并进行合理统筹</li>
<li>减少干扰</li>
<li>有效地管理会议</li>
</ul>
<p>##6.2 二八定律<br>大多数情况下，可以用80%的时间做20%重要的事情。</p>
<p>##6.3 做计划<br>每天都留一段不受干扰的时间来做计划，让自己的工作更有条理。像番茄钟工作法中，每天清晨第一件事情就是用一个短番茄钟对今天一天的工作做一个计划。这样能让自己的工作更有条理，还可以减少干扰。事实证明，在没有干扰的情况下工作效率是干扰情况下的2倍还多。<br>让自己更有条理，可以从办公桌开始，混乱的办公桌很容易让人觉得你做事没有条理。</p>
<p>##6.4 集中处理<br>把一些繁杂的事情进行集中处理，比如回复电子邮件、回答测试人员的疑问，可以在每天选择几个固定的时段来完成这种干扰性较严重的工作，把事情放在一起做，不要整天都忙于开始和结束。比如把所有的邮件一次做完，减少从一件事转到做另一件事情的次数。不要让这种上下文切换来影响你的效率，浪费你的脑力。</p>
<p>#7 如何做好领导者<br>作为领导，一定要牢记以下两点：</p>
<ul>
<li>作为领导者，你的业绩是团队共同努力的结果</li>
<li>你对团队的需要甚于团队对你的需要</li>
</ul>
<p><strong>你是主要的装桶人，装桶的最佳方法是良好的沟通</strong></p>
<p>##7.1 对于反馈<br>对于反馈</p>
<ul>
<li>要真诚，如果不诚挚的提出反馈意见，员工会把你当不存在</li>
<li>要把桶装满，反馈意见必须明确。如果不说明赞扬的是谁，桶也不会满，因为他们猜测你的意图是，桶也银耳倾斜</li>
<li>要及时反馈</li>
<li>反馈意见一定要与接受者的价值体系相一致。不要试图以对你很重要、对别人不重要的东西来装满他们的桶</li>
</ul>
<p>##7.2 关心团队成员的工作<br>让下属知道你很在意他们，也很关心他们的工作，一下是12种方法：</p>
<ul>
<li>让员工参与重大决策</li>
<li>记住提桶者及其家人的情况</li>
<li>为员工倒咖啡</li>
<li>将感谢信送到员工家中</li>
<li>送提桶者一张感恩卡片</li>
<li>要超级明星做中层星和流星的良师益友（这个一个双赢策略）</li>
<li>要贴近员工，记录下每次重大的装桶事宜</li>
<li>在公司种一棵树，以示对团队的敬意</li>
<li>建一个存有书籍、录像带和杂志的图书馆</li>
<li>用员工及其家人的照片做一面‘荣誉墙’</li>
<li>遵守装桶的黄金定律：用员工期望的方式来对待他们</li>
<li>与所有员工攻读时光，有时候，只是站在员工身旁，向他们表示你的关心，就会自动地把他们的桶装满</li>
</ul>
<p>##7.3 装桶的方法<br>装桶四中方法：</p>
<ul>
<li>知道首要的事务是什么</li>
<li>提出对业绩的反馈意见</li>
<li>表扬员工</li>
<li>交流对团队的评价</li>
</ul>
<p>##7.4 其他</p>
<ul>
<li>让团队知道他们凝聚在一体有多好</li>
<li>让员工时刻保持清醒，知道他们是否正在赢得目标</li>
</ul>
<p>#8 离开舒适地带<br>当你觉得目前的工作很舒适，那么就要立马逃离这种状态。 <strong>阻止你发挥潜力的劲敌是舒适地带，你想出人头地，就不能放任自己躺在舒适地带上自鸣得意。你要追求进步</strong> 。<br>学习地带有三个房间：阅览室、倾听室和给予室。</p>
<p>##8.1 阅览室<br><strong>读书越多，知识越丰富</strong> 。问题不在于你有没有时间和金钱，在于你能不能每天抽出固定时间来看书。</p>
<p>##8.2 倾听室<br>很多人失败的原因在于他们骄傲自大、过于自负、麻木不仁，他们忘记花时间倾听员工的意见，很快他们就对团队中的每个人的需要和渴望麻木不仁。</p>
<p>##8.3 给予室<br>如果不付出，就不会成功。你教的越多，就会对所教事务更加负责，自己也能对教的东西理解的更深甚至有新的理解。</p>
<p>#9 保持乐观<br><strong>在困惑的时候也要保持乐观，生活中有很多事情都与生活态度、如何面对生活带来的苦恼有关。生活是美好的，即使境况恶化时也依然如此。</strong></p>
<p>#10 一些原则</p>
<p>##10.1 领导学原则</p>
<ul>
<li>正直原则：绩效与领导者获得的信任程度成正比</li>
<li>责任原则：如果领导和下属都为自己的行为负责，绩效便会提高</li>
<li>委托原则：领导者雇佣并提拔有才能的员工，绩效会随之提高</li>
<li>构想原则：如果领导者将自己的构想解释得一清二楚，而且抱有这种构想的原因也令人心悦诚服，绩效便会提高</li>
</ul>
<p>##10.2 同心协力原则</p>
<ul>
<li>交流原则：员工了解自己的职责，并因为取得的成就而获得奖励，他们的绩效便会提高</li>
<li>矛盾解决的原则：领导者排除了压抑下属的障碍后，绩效会提高</li>
<li>乐观原则：绩效与领导的自尊心和态度成正比</li>
<li>改变管理方式的原则：领导崇尚改革，而且积极地致力于改革事务，绩效会随之提高</li>
</ul>
<p>##10.3 投资原则</p>
<ul>
<li>授权原则：当员工要为自己的行为负责时，他们的绩效便会提高</li>
<li>勇气原则：领导直面影响员工的问题的能力越强，业绩越会同比上升</li>
<li>榜样原则：领导成为正面的榜样时，业绩会提升</li>
<li>准备原则：领导越促进自身及员工的成长，绩效水平越高</li>
</ul>
<p>#11 后记<br>《周一清晨的领导课》这本书对我的帮助是挺大的。这9个月的管理工作，我没有少做总结，但是，个人经验的总结往往是片面的、抽象的。这本书中将我自己总结出来的全部都覆盖到了，并且将我的问题解释的更全面、更具体，而且，还提出了很多改进的意见。<br>读万卷书不如行万里路，希望看完这本书后，我能把目前的管理工作做好。<br>对于这本书中托尼的话，首先，我把这本书中学到的东西记录了下来，并且结合了我个人的看法做了写成了该文，也算把学到的东西分享了出去，另外，我也打算做写一份我立马需要做的事情。<br>还有，看完这本书其实有些问题还是有些疑问的，比如正确做事这个章节，有时候，死板的按照行为准则做事，会给团队成员以教条主义的眼光看待。这些疑问，我打算在适当的时候，找有经验的前辈指教。</p>
<p>#12 我当前要做的事情</p>
<ul>
<li>做出改变，不在埋头做事，理清头绪，整理好当前项目开发中的计划，找出近期迭代中的首要问题；</li>
<li>对团队成员负责，让整个团队都有认识一致的首要问题，并且更好的给他们反馈，关心他们的工作，填充他们的不足，和他们共同进步；</li>
<li>将后续总结会中的问题整理成一份行为准则，并且坚持做这些正确的事情；</li>
<li>做好自己的时间管理，做好每天的计划，更好的管理自己的时间，并且用80%的时间做我最应该做的事情；</li>
<li>不要放低标准，招聘适合的团队成员，加强团队；</li>
<li>加强学习，多看书、多倾听、多分享。不要给别人灌输别人不愿意听的想法和知识；</li>
<li>保持乐观，不管境况多糟糕，都要乐观的寻找方法去改变现状。</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/21/2014-05-21-jobs-and-bezos-product-monitoring-subsystem-module-refactoring/" itemprop="url">
                  乔布斯与贝索斯-------公司产品监控子系统监控模块重构
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-05-21T14:12:00+08:00" content="2014-05-21">
              2014-05-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/bezos/" itemprop="url" rel="index">
                    <span itemprop="name">bezos</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/bezos/jobs/" itemprop="url" rel="index">
                    <span itemprop="name">jobs</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/bezos/jobs/设计/" itemprop="url" rel="index">
                    <span itemprop="name">设计</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/bezos/jobs/设计/乔布斯/" itemprop="url" rel="index">
                    <span itemprop="name">乔布斯</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/bezos/jobs/设计/乔布斯/贝索斯/" itemprop="url" rel="index">
                    <span itemprop="name">贝索斯</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/bezos/jobs/设计/乔布斯/贝索斯/干货/" itemprop="url" rel="index">
                    <span itemprop="name">干货</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="旅游"><a href="#旅游" class="headerlink" title="#旅游"></a>#旅游</h2><p>终于差不多可以休息个半个月去旅游下了。作为旅游前的最后一遍博文，就把这周的工作作为主体阐述下，也把最近看的书的一点感悟阐述下。</p>
<h2 id="乔布斯与贝索斯"><a href="#乔布斯与贝索斯" class="headerlink" title="#乔布斯与贝索斯"></a>#乔布斯与贝索斯</h2><p>最近看一网打尽，发现乔布斯和贝索斯还真是很像。虽然，他们人性中都有很多让正常人不好沟通交流的地方，让他们的员工都很怕和他们一起坐电梯，但是，他们的感染力、创新力、决策力、行动力，还是让我们尊称他们为神。<br>首先，他们有产品经理应该有的嗅觉，可以说，乔布斯80年代就已经预测到了二十一世纪的电脑使用方式了，只是他太超前了，当时的主流用户根本没法接受；而贝索斯虽然也有很多失误，但是他大方向上都是没错的，一键下单、推荐引擎、Kindle阅读器等，都是划时代的产品。可以说，乔布斯重定义了电脑和手机，贝索斯重定义了书；<br>然后，他们都具有非常强的现实扭曲力，乔布斯可以告诉你，电脑就是应该这么操作的，手机就应该像我这么用。他觉得你不该有的东西，就不能有。不像安卓手机，尽可能的满足用户的各种需求，最后导致定制化太多，整个安卓平台都是碎片化的。一个好的产品，只需要满足80%主流用户的80%主要需求即可。而贝索斯，他改变了人们不止实现了世界上最大的书店，慢慢的发展成最大的电商平台，最大的综合服务公司，他不断的创新，不断的让你接受他的创新；<br>还有，他们都有很强的决策力和行动力，他们不但能清晰的看到机会，还能将想法很快的付出于行动。他们都崇尚于行动；<br>另外，他们都被董事会提议解雇，最后乔布斯确实被一个来自可口可乐的卖糖水的人赶走了，而贝索斯也差点被一个来自百事可乐卖糖水的赶走，还好贝索斯的感染力比乔布斯好，很多手下还是被他感（xi）染（nao）了，成为了Jeff Reboot；<br>最后，他们都对自己的技术合伙人很冷酷。乔布斯又沃兹，贝索斯有卡芬，这两个奇才除了技术都很牛意外，他们还有个同样的特点，内向，木讷。卡芬至少还争取了，沃兹就显得无所谓了，任由乔布斯一点一点的把他边缘化，最后他也就去做遥控器开发了，不过，挺成功的。<strong>对于乔布斯和贝索斯，在他们的字典里面，没有合作这个词，只有为他们所用</strong>。</p>
<p>他们的名言：</p>
<ol>
<li>Stay hungry stay foolish.</li>
<li>We are our choice.</li>
</ol>
<h2 id="监控模块重构"><a href="#监控模块重构" class="headerlink" title="#监控模块重构"></a>#监控模块重构</h2><p>##原问题<br>原来监控模块的逻辑有两个问题</p>
<ol>
<li>原来的TMtObjItem与TMtObj的对应关系是固定的，比如原有4个监控项，那么就是4：1，就是说，比如一个监控对象是服务器，那么就有4个监测项（连通性、CPU、内存、磁盘）。那么就存在一个问题，如果有两个监控方案对应同一个监控对象，那么他们就存在同步的问题。比如监控方案A修改了CPU使用率的监测阀值，那么监控方案B就必须和A一样，如果B再设置了，就又会把A覆盖了；</li>
<li>按原有的设计，注册监控对象的时候，就一定要创建监控项，因为他与方案是无关的，且还要建立与现有的类型监控方案的关系；</li>
<li>按原有设计，监控项日志记录与监控项绑定，那么，就无法判断每次监测对象的时候是监测了几个对象。</li>
</ol>
<p>##重构设计UML<br><img src="http://i1.tietuku.com/86a31da4f94810e3s.jpg" alt=""></p>
<p>##依赖关系调整</p>
<p>###监控数据结构关系调整<br>去除了原数据结构TMtObjItem，TMTObjNorm，TMtObjThreadhol等对象，取而代之的是TMTSchemeItem、TMtShcemeObj，并且与方案1对n关联，TMtObj对象并不直接持有，但是TMtSchemeObj持有TMtObj作为MetaObj。</p>
<p>###监控日志关系调整<br>让监测对象日志与调度方案日志绑定，这样做数据分析统计的时候，就可以根据查找相应对象最近调度方案来找到最近一次监控的结果，就算只监控了其中几个监测项，也可以发现。</p>
<p>##溯源方式调整<br>在SerialMonitor中，会通过判断方案的类型，如果是类型监测方案就会向上追溯，比如监控数据库，有异常就会去监测是否是服务器存在异常。如果是组合监控方案，就会根据组合监控对象的组合结构，去往下追溯异常源头。</p>
<p>##构造方式<br>原类型监测方案创建时候会去创建TMtObjItem，当创建监控对象的时候还要将新创建的监控对象添加到相应的类型监测方案下。现在只是运行监测方案的时候，会去构造TMtSchemeObj和TMtSchemeItem。</p>
<p>##监控结果记录方式<br>原来的监控结果基本记录在TMtLogObjItem中。现在另外还记在TMtSchemeItem中，方便追溯。</p>
<p>##调用方式<br>SerialMonitor的monitor方法为入口方法，可以争对不同的实现子类实现多态。而其基类的monitorOneItem方法为抽象的逻辑，对溯源、监控、记录日志、监控监控项状态等行为进行了调用。这些行为依赖于相应的接口，这些接口可以有不同的子类实现，通过策略模式与模板模式实现了具体监控的多态。</p>
<p>##重构中发现的问题<br>代码的重构可以用单元测试来防止错误，那么，现有很多数据都是通过存储过程来分析统计的。对于存储过程这块没有相应的单元测试方法，为了验证重构有没有带来影响，我只能辛苦的造数据，而且测试完以后觉得还是存在隐患，因为覆盖度根本不够。<br>或许有人会说，那么就不用存储过程，吧分析统计写到java里面，将控制权把握在手上呗。但是，这要看场景。因为我们的业务线比较长，甚至到了新疆内蒙等地方，如果把分析统计这种会根据实际需要变的业务逻辑写到程序中，那么必定导致开发人员的维护工作大大增加，有的时候不得不出差到现场去解决问题。那么，如果用存储过程，我只要定义好需要的数据，存储过程怎么去统计和分析，都是现场的运维人员可控的。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/20/2014-05-20-everythis-is-in-our-store-2/" itemprop="url">
                  Everythis is store书载(2)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-05-20T14:32:00+08:00" content="2014-05-20">
              2014-05-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/" itemprop="url" rel="index">
                    <span itemprop="name">Amazon</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/" itemprop="url" rel="index">
                    <span itemprop="name">bezos</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/一网打尽/" itemprop="url" rel="index">
                    <span itemprop="name">一网打尽</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/一网打尽/EverythisIsStore/" itemprop="url" rel="index">
                    <span itemprop="name">EverythisIsStore</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>有一次散步时，卡芬问贝佐斯，既然他们现在已经实现了一些早期目标，为何还极力向外扩张。贝佐斯回答：“当公司规模还非常弱小时，其他大公司会随时出现，并且极力抢夺你的果实。因此我们必须平衡竞争力量，来和那些老牌图书销售商抗衡。”</p>
<p>每天一睁眼就要有忧患意识，但不用关注我们的对手，因为他们不会给我们送钱。让我们更关注顾客吧，各位一定要脚踏实地。</p>
<p>首次公开募股前，贝佐斯和他的这位老搭档一同散步，告诉他公司需要更强的技术管理人员，然后想任命他为亚马逊的首席技术官。这听起来像是升职了，但实际上，卡芬将变成一个顾问的角色，既不需要做预算，也不需要负直接责任。卡芬想了几天，没答应，但贝佐斯知道卡芬的性格，然后说“让它过去吧”,就再也没提这事了。</p>
<p>这时，两个承诺发生了冲突。贝佐斯曾向卡芬承诺，可以永久保留他的工作。但亚马逊的创始人还向公司和投资人承诺，他将会提高应聘标准，亚马逊的命运与招募的技术人员的能力息息相关。瑞克·达尔泽尔和乔尔·施皮格尔两人擅长于公司政治；而卡芬是一位性格内向的电脑奇才，有些过于理想化，缺乏领导才能事实上，他已经不再插手员工招聘和壮大自己部门的工作了。但他却默默地为亚马逊奉献了自己，并且帮助亚马逊确立了世界地位。回首当年，贝佐斯的电子表格上就是一串虚无缥缈的数字而已。</p>
<p>年来的历程却感到有些酸楚。他把贝佐斯不让他参与亚马逊决策一事称为“是对信任的一种背叛”，忘了当初两人共同创业时的艰辛。卡芬说，他得到的是“一生中最令他失望的一次遭遇”。</p>
<p>这些不满是许多亚马逊老员工相同境遇的浓缩版。由于贝佐斯令人信服的信条，使得所有员工都怀有一种信念，他们确实也得到了丰厚的回报。但这位眼神坚定的创始人最终还是把他们解雇了，取而代之的是拥有新观念和更多经验的人。公司前进中，再也看不到这些老员工的身影了，这实在让人心酸，好像是他的孩子离开了家，又搬到了另一个家。最终，Bezos向卡芬坦言，亚马逊只有一个真正的父亲。</p>
<p>当我们看到获得市场领先地位的可能性很大时，做投资决定就要大胆，而不要畏首畏尾。这些投资有些会获得回报，有些则不能，但我们从二者中都会吸取宝贵的经验。</p>
<p>贝佐斯强调亚马逊日常运行中的节俭习惯。他让员工付停车费，并要求所有高管出差坐经济舱。</p>
<p>贝佐斯吸取了沃尔顿自传中的精华，而且沿用沃尔玛创始人的节俭作风以及“崇尚行动”的做法，并使其融入了亚马逊的文化中。</p>
<p><strong>沃尔玛式的传奇在今天这个时代还能重现吗？我的答案是，当然还会。或许现在就有人正在跃跃欲试——或许有成千上万的人在做——他们有足够多的创意支持其一路走下去。假如有人非常热切地追求自己心中的梦想，虽然期间会经历很多的失败，但也要锲而不舍地坚持下去。这全仰仗一个人的态度和能力，要不断研究和探寻商业管理的秘诀。</strong></p>
<p>杰夫·贝佐斯就具备了山姆·沃尔顿所描绘的那些品质。他一直不愿意让亚马逊屈从于任何官僚的慵懒作风，希望不断有新的想法涌现，想方设法改进网站的过去做法，以吸引更多的顾客，始终走在对手的前头。</p>
<p>谁也不能跟杰夫·贝佐斯合作，而只能替他卖命。</p>
<p>Bezos把亚马逊定义为一家以顾客为中心的公司，而并非以竞争者为核心的公司。</p>
</blockquote>
<p><em>但后来事实证明，Bezos在易趣的竞争下，单纯为了竞争，下了很多昏招。</em></p>
<blockquote>
<p><strong>五项狠心价值：顾客至上（ customer   obsession）、 勤俭节约（ frugality）、 崇尚行动（ bias   for   action）、 主人翁精神（ ownership） 和人才招聘的高标准（ high   bar   talent）。 后来又加上一条：创新（ innovation ）</strong></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/20/2014-05-20-implementation-of-davidpotter/" itemprop="url">
                  DavidPotter的实现、cucumber实现BDD开发
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-05-20T12:25:00+08:00" content="2014-05-20">
              2014-05-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/" itemprop="url" rel="index">
                    <span itemprop="name">UML</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/" itemprop="url" rel="index">
                    <span itemprop="name">BDD</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/" itemprop="url" rel="index">
                    <span itemprop="name">TDD</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/设计/" itemprop="url" rel="index">
                    <span itemprop="name">设计</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/设计/KataPotter/" itemprop="url" rel="index">
                    <span itemprop="name">KataPotter</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/设计/KataPotter/cucumber/" itemprop="url" rel="index">
                    <span itemprop="name">cucumber</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/设计/KataPotter/cucumber/责任链设计模式/" itemprop="url" rel="index">
                    <span itemprop="name">责任链设计模式</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UML/BDD/TDD/设计/KataPotter/cucumber/责任链设计模式/面向接口/" itemprop="url" rel="index">
                    <span itemprop="name">面向接口</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="DavidPotter实现"><a href="#DavidPotter实现" class="headerlink" title="#DavidPotter实现"></a>#DavidPotter实现</h2><p><img src="http://i1.tietuku.com/13ad8e00f1cf9723s.png" alt=""><br><a href="https://github.com/yuezaixz/DavidPotter" target="_blank" rel="external">代码Github地址</a></p>
<p>##包结构<br><img src="http://d2.freep.cn/3tb_140520204718v75v531911.jpg" alt=""></p>
<ol>
<li>按照UML设计图，进行了包结构划分；</li>
<li>每个分包中基本都含有接口和实现类；</li>
<li>每个包职责分明，遵循单一原则；</li>
</ol>
<p>##实现<br>不具体说明所有代码，具体分析几个主要的类。</p>
<p>###Basket<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Basket</span> </span>&#123;</div><div class="line"></div><div class="line">    Map&lt;String, SeriesseriesMap = <span class="keyword">new</span> HashMap&lt;String, Series&gt;();</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> IBasketFactory factory;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">Basket</span><span class="params">(<span class="keyword">final</span> Series... inputSeries)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">final</span> Series serie : inputSeries) &#123;</div><div class="line">            <span class="keyword">this</span>.seriesMap.put(serie.getSeriesName(), serie);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNoEmptySeriesSize</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (Series serie : seriesMap.values()) &#123;</div><div class="line">            <span class="keyword">if</span> (!serie.isEmpty()) &#123;</div><div class="line">                num++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> num;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Price <span class="title">howMany</span><span class="params">()</span></span>;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">areThereAnyBooksLeft</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (Series serie : seriesMap.values()) &#123;</div><div class="line">            <span class="keyword">if</span> (!serie.isEmpty()) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">bookNum</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> bookNum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (Series serie : seriesMap.values()) &#123;</div><div class="line">            bookNum += serie.length();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> bookNum;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">push</span><span class="params">(String name, Book... books)</span> </span>&#123;</div><div class="line">        Series series = seriesMap.get(name);</div><div class="line">        <span class="keyword">if</span> (series == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (Book book : books) &#123;</div><div class="line">            series.push(book);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">popForEachSeriesBox</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (Series serie : seriesMap.values()) &#123;</div><div class="line">            <span class="keyword">if</span> (!serie.isEmpty()) &#123;</div><div class="line">                serie.pop();</div><div class="line">                num++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> num;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Basket <span class="title">pop</span><span class="params">(<span class="keyword">int</span> bookNum)</span> </span>&#123;</div><div class="line">        Basket emptyBasket = factory.getEmptyBasket();</div><div class="line">        <span class="keyword">int</span> noEmptySeriesSize = getNoEmptySeriesSize();</div><div class="line">        <span class="keyword">if</span> (noEmptySeriesSize &gt;= bookNum) &#123;</div><div class="line">            <span class="keyword">for</span> (Series serie : seriesMap.values()) &#123;</div><div class="line">                <span class="keyword">if</span> (!serie.isEmpty()) &#123;</div><div class="line">                    emptyBasket.push(serie.getSeriesName(), serie.pop());</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> emptyBasket;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Book <span class="title">popByName</span><span class="params">(<span class="keyword">int</span> seriesName)</span> </span>&#123;</div><div class="line">        Series series = seriesMap.get(seriesName);</div><div class="line">        <span class="keyword">return</span> series.isEmpty() ? <span class="keyword">null</span> : series.pop();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span>[][] convertBasketToTwoDArray();</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> seriesMap.toString();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(<span class="keyword">final</span> Object obj)</span> </span>&#123;</div><div class="line">        Basket target = (Basket) obj;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.seriesMap.equals(target.seriesMap);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>该类为购物车的抽象类，内部的数据结构通过系列名称和系列数据结构的Map来实现，是该codejourney的核心数据结构之一。<br>该类将一些购物车的特征性方法封装，比如获取购物车中的图书类数，是否还有书，剩余书的数量，向购物车内新增图书，    将购物车中所有类别书各取出一本，取出指定本书，根据书的类名取出图书。<br>另外，还对一些方法进行了抽象，比如当前购物车所有书籍折前价格，打印当前购物车的情况，将当前购物车转换成二维数组的数据结构，这些抽象方法通过子类来分别实现。因为这些方法都是面向具体实现的。</p>
<p>###Series<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Series</span> <span class="keyword">implements</span> <span class="title">ISeries</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Book[] books = <span class="keyword">new</span> Book[<span class="number">16</span>];</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String seriesName;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Series</span><span class="params">(String seriesName)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.seriesName = seriesName;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Series</span><span class="params">(String seriesName,Book ... books)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.seriesName = seriesName;</div><div class="line">        <span class="keyword">this</span>.books = books;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSeriesName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> seriesName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSeriesName</span><span class="params">(String seriesName)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.seriesName = seriesName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> size == <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">// 将数组中的数据置为null, 方便GC进行回收</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</div><div class="line">            books[size] = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        size = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">length</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> size;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">push</span><span class="params">(Book data)</span> </span>&#123;</div><div class="line">        <span class="comment">// 判断是否需要进行数组扩容</span></div><div class="line">        <span class="keyword">if</span> (size &gt;= books.length) &#123;</div><div class="line">            resize();</div><div class="line">        &#125;</div><div class="line">        books[size++] = data;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 数组扩容</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">resize</span><span class="params">()</span> </span>&#123;</div><div class="line">        Book[] temp = <span class="keyword">new</span> Book[books.length * <span class="number">3</span> / <span class="number">2</span> + <span class="number">1</span>];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</div><div class="line">            temp[i] = books[i];</div><div class="line">            books[i] = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        books = temp;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Book <span class="title">pop</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> (Book) books[--size];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        sb.append(<span class="string">"MyArrayStack: ["</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</div><div class="line">            sb.append(books[i].toString());</div><div class="line">            <span class="keyword">if</span> (i != size - <span class="number">1</span>) &#123;</div><div class="line">                sb.append(<span class="string">", "</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        sb.append(<span class="string">"]"</span>);</div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>该类内部数据结构为数组，通过数组实现了一个简易的类似栈，可以向栈内pop和push图书。是该codejourney的核心数据结构之一。</p>
<p>###PotterStrategy<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PotterStrategy</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = Logger.getLogger(PotterStrategy.class.getName());</div><div class="line">    </div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;StringPOTTER_SERIES_NAME_LIST = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">    <span class="keyword">static</span>&#123;</div><div class="line">        POTTER_SERIES_NAME_LIST.add(<span class="string">"Harry Potter and the Philosopher's Stone"</span>);</div><div class="line">        POTTER_SERIES_NAME_LIST.add(<span class="string">"Harry Potter and the Chamber of Secrets"</span>);</div><div class="line">        POTTER_SERIES_NAME_LIST.add(<span class="string">"Harry Potter and the Prisoner of Azkaban"</span>);</div><div class="line">        POTTER_SERIES_NAME_LIST.add(<span class="string">"Harry Potter and the Goblet of Fire"</span>);</div><div class="line">        POTTER_SERIES_NAME_LIST.add(<span class="string">"Harry Potter and the Order of Phoenix"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Price PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT = <span class="keyword">new</span> Price(<span class="number">800</span>);</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_SERIES_NUMBER = <span class="number">5</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Price CHEAPER_BY_FIVE_THREE_PATTERN = <span class="keyword">new</span> Price(<span class="number">40</span>);</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> FIVE_THREE_PATTERN_FIVE = <span class="number">5</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> FIVE_THREE_PATTERN_THREE = <span class="number">3</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_NUMBER_OF_COPIES_FOR_EACH_SERIES = <span class="number">10</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> DISCOUNT_FOR_TWO_SERIES = <span class="number">0.95</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> DISCOUNT_FOR_THREE_SERIES = <span class="number">0.9</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> DISCOUNT_FOR_FOUR_SERIES = <span class="number">0.8</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> DISCOUNT_FOR_FIVE_SERIES = <span class="number">0.75</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] differentSeriesCount = <span class="keyword">new</span> <span class="keyword">int</span>[PotterStrategy.MAX_NUMBER_OF_COPIES_FOR_EACH_SERIES];</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PotterStrategy</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">// To turn on logging, set level to be Level.INFO.</span></div><div class="line">        LOGGER.setLevel(Level.OFF);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasFiveThreePattern</span><span class="params">(Basket shoppingBasket)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span>[][] basketTwoDArray = shoppingBasket.convertBasketToTwoDArray();</div><div class="line">        countDifferentSeries(basketTwoDArray);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; differentSeriesCount.length - <span class="number">1</span>; i++) &#123;</div><div class="line">            LOGGER.info(<span class="string">"==Going to check differentSeriesCount["</span> + i + <span class="string">"]: "</span> + differentSeriesCount[i] + <span class="string">"; differentSeriesCount["</span> + (i+<span class="number">1</span>) + <span class="string">"]: "</span> + differentSeriesCount[i+<span class="number">1</span>]);</div><div class="line">            <span class="keyword">if</span> (differentSeriesCount[i] == FIVE_THREE_PATTERN_FIVE &amp;&amp; differentSeriesCount[i+<span class="number">1</span>] == FIVE_THREE_PATTERN_THREE) &#123;</div><div class="line">                LOGGER.info(<span class="string">"==Found five three pattern."</span>);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">countDifferentSeries</span><span class="params">(<span class="keyword">int</span>[][] basketTwoDArray)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; differentSeriesCount.length; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; basketTwoDArray.length; j++) &#123;</div><div class="line">                count += basketTwoDArray[j][i];</div><div class="line">            &#125;</div><div class="line">            differentSeriesCount[i] = count;</div><div class="line">            count = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        printDifferentSeriesCount(differentSeriesCount);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printDifferentSeriesCount</span><span class="params">(<span class="keyword">int</span>[] differentSeriesCount)</span> </span>&#123;</div><div class="line">        LOGGER.info(<span class="string">"==different series count: "</span> + Arrays.toString(differentSeriesCount));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getSeriesNumOfBookName</span><span class="params">(<span class="keyword">int</span> seriesNumOfBook)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> POTTER_SERIES_NAME_LIST.get(seriesNumOfBook-<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>该类的作用主要是提供一些常量（比如折扣、价格、书的类别及名字）及静态方法（判断是否存在5-3的情况和一些日志打印静态方法）。</p>
<p>###handler<br>最核心的处理逻辑还是封装在handler组件中。IHandler为核心接口。使用的是责任链设计模式，这点和FizzBuzzWhizz类似。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IHandler</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(ICalculate calc, PotterStrategy discountStrategy)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PotterHandler</span> <span class="keyword">implements</span> <span class="title">IHandler</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> IHandler nextHandler;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PotterHandler</span><span class="params">(IHandler priceHandler)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.nextHandler = priceHandler;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(ICalculate calc, PotterStrategy discountStrategy)</span> </span>&#123;</div><div class="line">        run(calc, discountStrategy);</div><div class="line">        IHandler nextHandler = getNextHandler();</div><div class="line">        <span class="keyword">if</span> (nextHandler != <span class="keyword">null</span>) &#123;</div><div class="line">            nextHandler.handle(calc, discountStrategy);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(ICalculate calc, PotterStrategy discountStrategy)</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> IHandler <span class="title">getNextHandler</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> nextHandler;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>通过实现该接口的抽象类，该抽象类又用了模板设计模式，将handler方法的责任链处理逻辑封装。子类只需要知道如何实现每个子链条的处理逻辑即可。<br>例如该项目的难点，5-3折扣同时出现的情况下，改用4-4折扣会更优惠，由于，优惠的价格固定为0.4元，所以当这种情况，就调用FiveThreePatternHandler。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FiveThreePatternHandler</span> <span class="keyword">extends</span> <span class="title">PotterHandler</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FiveThreePatternHandler</span><span class="params">(IHandler wordHandler)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(wordHandler);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(ICalculate calc, PotterStrategy discountStrategy)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (calc.hasFiveThreePattern()) &#123;</div><div class="line">            calc.setCalculatedPrice(calc.getCalculatedPrice().minus(PotterStrategy.CHEAPER_BY_FIVE_THREE_PATTERN));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>###price<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Price</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">double</span> price;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Price</span><span class="params">(<span class="keyword">final</span> <span class="keyword">double</span> price)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.price = price;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> price;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="string">"Price: "</span> + Double.toString(price);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(<span class="keyword">final</span> Object obj)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> ((Price) obj).price == price;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Double(price).hashCode();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">lowestPrice</span><span class="params">(<span class="keyword">final</span> Price other)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Price(Math.min(price, other.price));</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">add</span><span class="params">(<span class="keyword">final</span> Price other)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Price(price + other.price);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">minus</span><span class="params">(<span class="keyword">final</span> Price other)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Price(price - other.price);</div><div class="line">    &#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">mul</span><span class="params">(<span class="keyword">final</span> Price other)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Price(price * other.price);</div><div class="line">    &#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">mul</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> mulNum)</span> </span>&#123;</div><div class="line">	    <span class="keyword">return</span> <span class="keyword">new</span> Price(price * mulNum);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> Price <span class="title">mul</span><span class="params">(<span class="keyword">final</span> <span class="keyword">double</span> mulNum)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Price(price * mulNum);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>该类主要用于对价格封装，把加减乘除的方法都封装。</p>
<p>#calc<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICalculate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Price <span class="title">getCalculatedPrice</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">setCalculatedPrice</span><span class="params">(Price calculatedPrice)</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">calculate</span><span class="params">()</span></span>;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printCalc</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">fillSeriesBoxAndCalculatePrice</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">putIntoBasket</span><span class="params">(String seriesName, <span class="keyword">int</span> numberOfBook)</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">putIntoBasket</span><span class="params">(<span class="keyword">int</span> seriesNumberOfBook, <span class="keyword">int</span> numberOfBook)</span></span>;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">areThereAnyBooksLeft</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">hasFiveThreePattern</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">printBasket</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>该接口封装了很多方法，有些方法可以直接是链式引用，比如hasFiveThreePattern，会通过调用持有的Strategy的相应方法来实现。那接着让我们看看该类的实现类。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PriceCaclulate</span> <span class="keyword">implements</span> <span class="title">ICalculate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Price calculatedPrice = <span class="keyword">new</span> Price(<span class="number">0</span>);</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> IHandler handler ;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> PotterStrategy potterStrategy;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> Basket potterBasket;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PriceCaclulate</span><span class="params">()</span> </span>&#123;</div><div class="line">        IHandler maxDiffenentSeriesHandler = <span class="keyword">new</span> MaxDifferentSeriesHandler(<span class="keyword">null</span>);</div><div class="line">        potterStrategy = <span class="keyword">new</span> PotterStrategy();</div><div class="line">        handler = <span class="keyword">new</span> FiveThreePatternHandler(</div><div class="line">                maxDiffenentSeriesHandler);</div><div class="line">        potterBasket = BasketFactoryBean.getPotterBasketFactoryInstance().getEmptyBasket();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printCalc</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"购物车中的哈利波特故事书"</span>+<span class="keyword">this</span>.calculatedPrice);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Price <span class="title">getCalculatedPrice</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> calculatedPrice;</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCalculatedPrice</span><span class="params">(Price calculatedPrice)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.calculatedPrice = calculatedPrice;</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">calculate</span><span class="params">()</span> </span>&#123;</div><div class="line">        handler.handle(<span class="keyword">this</span>, <span class="keyword">this</span>.potterStrategy);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fillSeriesBoxAndCalculatePrice</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> seriesNum = potterBasket.popForEachSeriesBox();</div><div class="line">        <span class="keyword">switch</span> (seriesNum) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">            calculatedPrice = calculatedPrice</div><div class="line">                    .add(PotterStrategy.PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">            calculatedPrice = calculatedPrice</div><div class="line">                    .add(PotterStrategy.PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT</div><div class="line">                            .mul(<span class="number">2</span>).mul(PotterStrategy.DISCOUNT_FOR_TWO_SERIES));</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">3</span>:</div><div class="line">            calculatedPrice = calculatedPrice</div><div class="line">                    .add(PotterStrategy.PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT</div><div class="line">                            .mul(<span class="number">3</span>).mul(</div><div class="line">                                    PotterStrategy.DISCOUNT_FOR_THREE_SERIES));</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">4</span>:</div><div class="line">            calculatedPrice = calculatedPrice</div><div class="line">                    .add(PotterStrategy.PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT</div><div class="line">                            .mul(<span class="number">4</span>)</div><div class="line">                            .mul(PotterStrategy.DISCOUNT_FOR_FOUR_SERIES));</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">5</span>:</div><div class="line">            calculatedPrice = calculatedPrice</div><div class="line">                    .add(PotterStrategy.PRICE_FOR_EACH_BOOK_WITHOUT_DISCOUNT</div><div class="line">                            .mul(<span class="number">5</span>)</div><div class="line">                            .mul(PotterStrategy.DISCOUNT_FOR_FIVE_SERIES));</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(</div><div class="line">                    <span class="string">"the number of series should be within "</span></div><div class="line">                            + PotterStrategy.MAX_SERIES_NUMBER);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">()</span> </span>&#123;</div><div class="line">        calculatedPrice = <span class="keyword">new</span> Price(<span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">putIntoBasket</span><span class="params">(String seriesName, <span class="keyword">int</span> numberOfBook)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numberOfBook; i++) &#123;</div><div class="line">            potterBasket.push(seriesName, <span class="keyword">new</span> Book());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">putIntoBasket</span><span class="params">(<span class="keyword">int</span> seriesNumOfBook, <span class="keyword">int</span> numberOfBook)</span> </span>&#123;</div><div class="line">        </div><div class="line">        String seriesName = PotterStrategy.getSeriesNumOfBookName(seriesNumOfBook);</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numberOfBook; i++) &#123;</div><div class="line">            potterBasket.push(seriesName, <span class="keyword">new</span> Book());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">areThereAnyBooksLeft</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> potterBasket.areThereAnyBooksLeft();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasFiveThreePattern</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> potterStrategy.hasFiveThreePattern(potterBasket);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printBasket</span><span class="params">()</span> </span>&#123;</div><div class="line">        potterBasket.print();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>该类依赖了Strategy、Price、Handler、Basket。该类是对外的API接口，使用该组件不需要对组件的内部实现有什么了解。只要知道接口，已经具体需要的实现类，然后调用相应API即可。</p>
<p>###调用<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">ICalculate cacluate = <span class="keyword">new</span> PriceCaclulate();</div><div class="line">cacluate.putIntoBasket(PotterStrategy.getSeriesNumOfBookName(<span class="number">1</span>), <span class="number">1</span>);</div><div class="line">cacluate.putIntoBasket(PotterStrategy.getSeriesNumOfBookName(<span class="number">2</span>), <span class="number">1</span>);</div><div class="line">cacluate.putIntoBasket(PotterStrategy.getSeriesNumOfBookName(<span class="number">3</span>), <span class="number">2</span>);</div><div class="line">cacluate.putIntoBasket(PotterStrategy.getSeriesNumOfBookName(<span class="number">4</span>), <span class="number">1</span>);</div><div class="line">cacluate.putIntoBasket(PotterStrategy.getSeriesNumOfBookName(<span class="number">5</span>), <span class="number">2</span>);</div><div class="line"></div><div class="line">cacluate.printBasket();</div><div class="line">cacluate.calculate();</div><div class="line">cacluate.printCalc();</div></pre></td></tr></table></figure></p>
<p>如上所说，只要调用接口的相应实现子类，然后添加书籍（添加书籍的方法也做好了封装），然后调用相应的API即可。</p>
<p>##单元测试<br>这次项目的单元测试采用的是一种叫做cucumber的BDD工具，该工具在Ruby业内挺流行的，Java还不是应用广泛，在国内可能找相应的文章都不容易。<br>什么是BDD？TDD是一种通过测试用例来进行设计、代码驱动的开发方式，但是，这种方式是由程序员作为主导的，一般测试和产品经理并看不懂单元测试，只能说产品经理通过描述，让测试转化为测试用例，再通过程序员编写单元测试来实现。<br>那么，cucumber就解决了TDD的这一问题，直接通过产品经理设置场景，测试在场景内加入Example数据，再通过程序员来实现。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">Feature: Kata Potter</div><div class="line"> 出版社要促销一套哈利波特图书，该套图书共5集，每集单册购买价8元。</div><div class="line"> 若任意两集各买一本，打95折；若任意三集各买一本，打9折；若任意四集各买一本，打8折；</div><div class="line"> 若所有这五集都各买一本，打75折。上述优惠之外再购买的单册还是按8元一本计价。</div><div class="line"> 比如五集各买一本之外再加一本第一集，五本书打75折，这本另加的第一集按8元计价。</div><div class="line"> 若有人第一集买2本，第二集买2本，第三集买2本，第四集买1本，第五集买1本。</div><div class="line"> 问打折后最低的优惠价是多少钱？提示，不是51.6元，而是51.2元。</div><div class="line"></div><div class="line">  Scenario Outline: David的Potter测试</div><div class="line">    Given 开始我先要初始化我的购物车</div><div class="line">    And 我购买 &lt;Harry Potter and the Philosopher&apos;s Stone本 1st 系列书</div><div class="line">    And 我购买 &lt;Harry Potter and the Chamber of Secrets本 2nd 系列书</div><div class="line">    And 我购买 &lt;Harry Potter and the Prisoner of Azkaban本 3rd 系列书</div><div class="line">    And 我购买 &lt;Harry Potter and the Goblet of Fire本 4th 系列书</div><div class="line">    And 我购买 &lt;Harry Potter and the Order of Phoenix本 5th 系列书</div><div class="line">    When 我计算购物车的总价</div><div class="line">    Then 我最少应该付 &lt;lowest price&gt;</div><div class="line"></div><div class="line">  Examples: 最基本的测试</div><div class="line">    | Harry Potter and the Philosopher&apos;s Stone | Harry Potter and the Chamber of Secrets | Harry Potter and the Prisoner of Azkaban | Harry Potter and the Goblet of Fire | Harry Potter and the Order of Phoenix | lowest price |</div><div class="line">    |                    0                     |                    0                    |                      0                   |                  0                  |                   0                   |       0      |</div><div class="line">    |                    1                     |                    0                    |                      0                   |                  0                  |                   0                   |       800    |</div><div class="line">    |                    0                     |                    1                    |                      0                   |                  0                  |                   0                   |       800    |</div><div class="line">    |                    0                     |                    0                    |                      1                   |                  0                  |                   0                   |       800    |</div><div class="line">    |                    0                     |                    0                    |                      0                   |                  1                  |                   0                   |       800    |</div><div class="line">    |                    0                     |                    0                    |                      0                   |                  0                  |                   1                   |       800    |</div><div class="line">    |                    2                     |                    0                    |                      0                   |                  0                  |                   0                   |       1600   |</div><div class="line">    |                    0                     |                    3                    |                      0                   |                  0                  |                   0                   |       2400   |</div><div class="line"></div><div class="line">  Examples: 简单的打折测试</div><div class="line">    | Harry Potter and the Philosopher&apos;s Stone | Harry Potter and the Chamber of Secrets | Harry Potter and the Prisoner of Azkaban | Harry Potter and the Goblet of Fire | Harry Potter and the Order of Phoenix | lowest price |</div><div class="line">    |                    1                     |                    1                    |                      0                   |                  0                  |                   0                   |       1520   |</div><div class="line">    |                    1                     |                    0                    |                      1                   |                  0                  |                   1                   |       2160   |</div><div class="line">    |                    1                     |                    1                    |                      1                   |                  0                  |                   1                   |       2560   |</div><div class="line">    |                    1                     |                    1                    |                      1                   |                  1                  |                   1                   |       3000   |</div><div class="line"></div><div class="line">  Examples: 复合折扣测试</div><div class="line">    | Harry Potter and the Philosopher&apos;s Stone | Harry Potter and the Chamber of Secrets | Harry Potter and the Prisoner of Azkaban | Harry Potter and the Goblet of Fire | Harry Potter and the Order of Phoenix | lowest price |</div><div class="line">    |                    2                     |                    1                    |                      0                   |                  0                  |                   0                   |       2320   |</div><div class="line">    |                    2                     |                    2                    |                      0                   |                  0                  |                   0                   |       3040   |</div><div class="line">    |                    2                     |                    1                    |                      2                   |                  1                  |                   0                   |       4080   |</div><div class="line">    |                    1                     |                    2                    |                      1                   |                  1                  |                   1                   |       3800   |</div><div class="line"></div><div class="line">  Examples: 复杂折扣测试</div><div class="line">    | Harry Potter and the Philosopher&apos;s Stone | Harry Potter and the Chamber of Secrets | Harry Potter and the Prisoner of Azkaban | Harry Potter and the Goblet of Fire | Harry Potter and the Order of Phoenix | lowest price |</div><div class="line">    |                    2                     |                    2                    |                      2                   |                  1                  |                   1                   |       5120   |</div><div class="line">    |                    5                     |                    5                    |                      4                   |                  5                  |                   4                   |       14120   |</div></pre></td></tr></table></figure></p>
<p>上为本例中的场景。Given为给定的条件，AND是与的情况，WHEN是进行的操作，Then是结果，Examples是测试用例，&lt;&gt;中的内容会去测试用例中拿。让我们看看对应的代码怎么写。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PotterStepdefs</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> ICalculate calc = <span class="keyword">new</span> PriceCaclulate();</div><div class="line"></div><div class="line">    <span class="meta">@Given</span>(<span class="string">"^开始我先要初始化我的购物车$"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">I_clear_my_shopping_basket</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        calc.initialize();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Given</span>(<span class="string">"^我购买 (\\d+) 本 (\\d+)(?:st|nd|rd|th) 系列书$"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">I_buy_copies_of_book</span><span class="params">(<span class="keyword">int</span> numberOfBook,<span class="keyword">int</span> seriesNumberOfBook)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        System.out.println(<span class="string">"wudw"</span>+seriesNumberOfBook);</div><div class="line">        calc.putIntoBasket(seriesNumberOfBook, numberOfBook);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@When</span>(<span class="string">"^我计算购物车的总价$"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">I_calculate_the_price</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        calc.calculate();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Then</span>(<span class="string">"^我最少应该付 (\\d+)$"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">I_should_get_the_lowest_price</span><span class="params">(<span class="keyword">int</span> expectedPrice)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        <span class="keyword">int</span> price = (<span class="keyword">int</span>) (calc.getCalculatedPrice().getPrice());</div><div class="line">        assertEquals(<span class="string">"错误 - 计算结果与期望值不一致"</span>, expectedPrice, price);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>每个方法上有GIVEN、WHEN、THEN等，内部有相应的正则，会对应前面行为描述文件中的内容，正则()刮号中匹配的{1}、{2}等，都为成为注释方法中的参数。然后按描述文件中的顺序执行。<br>直接看看单元测试的结果吧。<br><img src="http://d3.freep.cn/3tb_140520204143venn531911.jpg" alt=""><br>还可以生成测试报告。<br><img src="http://d2.freep.cn/3tb_140520204143phb5531911.jpg" alt=""><br>有没觉得很好用？</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/18/2014-05-18-everythis-is-store-davidpotter-design/" itemprop="url">
                  Everythis is store----DavidPotter的设计
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-05-18T12:29:00+08:00" content="2014-05-18">
              2014-05-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/" itemprop="url" rel="index">
                    <span itemprop="name">Amazon</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/" itemprop="url" rel="index">
                    <span itemprop="name">bezos</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/设计/" itemprop="url" rel="index">
                    <span itemprop="name">设计</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/设计/责任链/" itemprop="url" rel="index">
                    <span itemprop="name">责任链</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/设计/责任链/KataPotter/" itemprop="url" rel="index">
                    <span itemprop="name">KataPotter</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/设计/责任链/KataPotter/一网打尽/" itemprop="url" rel="index">
                    <span itemprop="name">一网打尽</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一网打尽"><a href="#一网打尽" class="headerlink" title="一网打尽"></a>一网打尽</h2><p>##Bezos新看法<br>最近在看《Everything is store》这本书，暂时只看到Amazon新世纪前的艰难处境，这让我看到了Bezos的另一面：他吝啬，不给员工交保险；他主观，他认为员工就应该为了亚马逊的千秋万代不停的工作；他强势，他和乔布斯一样有不可思议的现实扭曲能力；他敏捷，他发现商机后往往是立马行动，不留下一点拖沓；他精明，善于在规则中发现漏洞，并钻这个空子；他谨慎，几乎没有人知道他的计划，包括他的合伙人和投资商；他无情，他让员工放弃家庭为他工作；他厚道，就算离开原有公司，也遵守着约定，并没有带走原公司的员工；他有感染力，他可以放开心的大笑；他是毒药，他的大笑让你失去防备。<br>一点载记，来自于《Everything is store》</p>
<blockquote>
<p>亚马逊当时还没有那么大的销售量，贝佐斯却为当初克服困难的勇气而津津乐道。他说：“我们发现了批发商订购规则的一个漏洞，他们的系统是这样设计的，你没有必要真买10本书，但你必须至少订10本书。我们发现有一本书，是描写‘地衣’的，系统里面有，但脱销了。我们开始订购1本我们想要的书，还有另外9本‘地衣’。然后他们会运来我们需要的那本书，并附上一张纸条，‘抱歉，我们的书脱销了。’”</p>
<p>如果一位有潜力的应聘者想在工作和家庭之间寻找平衡，那他就大错特错了，贝索斯肯定会把他拒之门外。</p>
<p>渐渐地，CEO向他的员工展示真是的自我，感染人的大笑、秃秃的头顶和神经质的举止。他异乎寻常的自信，比想象中还要固执。他近乎偏执地认为，员工都要不知疲倦得卖命，并且经常要大发豪言壮语。他一直雄心勃勃，但却行事谨慎，一些计划有时甚至连卡芬都蒙在鼓里。</p>
<p>Bezos最终命令他们停止这样做，因为这（员工通过服务器查看订单的每日增长情况）给服务器增加了更多的压力。当亚马逊第一次突破单日5000美元的订单时，拉夫乔伊建议搞个聚会，Bezos也没答应。他说：“将来会有很多有意义的事情，我不想这样庆祝”。</p>
<p>你可以超时工作、勤奋工作、动脑工作，但在亚马逊，你必须三选二。</p>
<p>Bezos再一次强调紧迫性：领先的企业现在要保持这种紧迫的状态，只有保持领先地位才能为顾客停工最优质的服务。</p>
<p>当然，这意味着亚马逊的每位员工都必须加倍努力。今后就没有任何公休日可言了，包括周末。在这里没人说你不能休周末，也没有人认为你可以休周末。</p>
</blockquote>
<h2 id="DavidPotter"><a href="#DavidPotter" class="headerlink" title="DavidPotter"></a>DavidPotter</h2><p>##设计<br>上篇博文中已经说了题目的含义。但是后来设计的时候觉得，如果按那样设计，一个购物车，有x本书，用n种折扣处理，处理后可能会出现y（y根据剩余书系列类别书和n决定）种情况的新购物车，然后再回头开始，用n中折扣处理。<br>我觉得这样设计带来的时间复杂度提升太严重了。而且这种设计只是为了未来可能的扩展要求。因此，我用一种简单的方式实现，暂时之前只有最后两层出现5本书折扣和3本书折扣的时候会出现用2次四折处理会便宜0.4元，就对这个特殊情况，我用一个特殊的handler处理下就好了。之后如果折扣变更有新的需要，用责任链设计模式也可以很方便的热拔插进一个新的handler。</p>
<p>##类图<br><img src="http://i1.tietuku.com/13ad8e00f1cf9723s.png" alt=""><br>可以看出，设计都是面向抽象，而不是具体实现。计算器Calc依赖于计算策略、购物车、购物车工厂、处理器，购物车依赖于书的系列，系列再依赖于书。处理器使用责任链的方式组合。</p>
<p>##其他<br>这篇文章暂就介绍到这里，下篇再具体介绍代码。另外这次的代码实现还会用BDD的方式来完成。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/14/2014-05-14-i-think-bezos/" itemprop="url">
                  我眼里的Bezos&Amazon----Code Journey for Kata Potter
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-05-14T13:58:00+08:00" content="2014-05-14">
              2014-05-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/" itemprop="url" rel="index">
                    <span itemprop="name">Amazon</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/" itemprop="url" rel="index">
                    <span itemprop="name">bezos</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/天道酬勤/" itemprop="url" rel="index">
                    <span itemprop="name">天道酬勤</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/天道酬勤/KataPotter/" itemprop="url" rel="index">
                    <span itemprop="name">KataPotter</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Amazon/bezos/天道酬勤/KataPotter/CodeJourney/" itemprop="url" rel="index">
                    <span itemprop="name">CodeJourney</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="近况"><a href="#近况" class="headerlink" title="近况"></a>近况</h2><p>感觉现在忙的事情越来越多了。给我家媳妇调毕业论文的日子结束了，紧接上来的就是给媳妇找房子租。然后V1.0版本差不多搞定了，立项、整体计划、下个阶段需求、设计等事情也连绵不绝。然后因为用户开始试用，V1.0版本很多的问题开始暴露，要搜集问题分析问题，紧急的还要打补丁解决，一些用户还需用定制一些特殊功能。<br>忙的事情实在多，只能拼凑一些晚上时间来做做Code Journey，再利用各种班车上、午间、饭后时间看书。<br>所以今天博文就是写最近我看的Bezos传记和Kata Potter的编程之旅，Kata Potter暂时未实现，只是有了一些思路，在设计中。</p>
<h2 id="Bezos-amp-Amazon"><a href="#Bezos-amp-Amazon" class="headerlink" title="Bezos&amp;Amazon"></a>Bezos&amp;Amazon</h2><p>#Amazon<br>亚马逊开始时候不过就是个网络书商，靠从出版商那里批发图书转卖挣其中的利润。什么当当网之类的不过都是亚马逊的中国制造——山寨。从普通网络书店，到地球上最大的书店，到最大的综合网络零售商，最后到今天这样一个综合性的网络服务商。<br>亚马逊崛起的平缓而持续，得益于Bezos。</p>
<p>#Bezos<br>Bezos的经历告诉我们一个事情，天道不一定酬勤，但是会决定你成为一个怎样的人。就像我去年考系统集成项目管理认证，两个月的高压工作下学习，虽然最后差之毫厘，但是这个过程中，<strong>我已经得到了这样的能力与见识，我已经将自己变成了一个不一样的人。外在的评估与期待只是一个结果而已，但是绝不应该是目的</strong>。<br>如果你真的早已知晓你所希望成就的一切（说到这里可能又会被认为是成功学），并努力一直将生命向这个方向推动，不懈怠，专注思考，穷尽一切可能，你一定会得到你所想要得到的。虽然至于得到多少，能不能闻达于天下，仍然取决于概率，但是这种主动至少能够帮助你战胜概率。在机会来临前，如果你能做好准备，你才有资格去丰收。我不信儒家思想中的天命，天命不过是未来的一种不确定性，会掌控和颠覆我们的生活，但是想一想，这种不确定性在人的一生这七八十年的样本区间里，就被概率抹平了，大部分的你们终会回归预期轨迹。虽然没几个人能达到Bezos的高度，但是主动至少能给我们获得成功的概率，这概率大小就取决于我们的努力有多少以及我们定义的成功有多高。</p>
<p>以下为Bezos2010年在普林斯顿大学的演讲，<a href="http://c.blog.sina.com.cn/profile.php?blogid=bec49e8b8900143l" target="_blank" rel="external">全文</a></p>
<blockquote>
<p>对我来说，这真是个困难的选择（指辞去对冲基金的工作去创建亚马逊），最终，我决定放手一搏。因为，万一试了以后失败，我并不会后悔；但如果不去试试看，我可能永远都会耿耿于怀。考虑了很久，我最后选择了一条比较不安全的路，去追随我的热情。今天，对于这个选择，我感到非常自豪。</p>
<p>我要斗胆做个预测。当你们活到八十岁，在某个安静的沉思时刻，回到内心深处，想起自己的人生故事时，最有意义的部份，将会是你所做过的那些选择。人生到头来，我们的选择，决定了我们是什么样的人（We are our choices.）。替你们自己写一篇精彩的人生故事吧。</p>
</blockquote>
<h2 id="Kata-Potter"><a href="#Kata-Potter" class="headerlink" title="Kata Potter"></a>Kata Potter</h2><p>#Problem Description<br> Once upon a time there was a series of 5 books about a very English hero called Harry. (At least when this Kata was invented, there were only 5. Since then they have multiplied) Children all over the world thought he was fantastic, and, of course, so did the publisher. So in a gesture of immense generosity to mankind, (and to increase sales) they set up the following pricing model to take advantage of Harry’s magical powers.</p>
<p>One copy of any of the five books costs 8 EUR. If, however, you buy two different books from the series, you get a 5% discount on those two books. If you buy 3 different books, you get a 10% discount. With 4 different books, you get a 20% discount. If you go the whole hog, and buy all 5, you get a huge 25% discount.</p>
<p>Note that if you buy, say, four books, of which 3 are different titles, you get a 10% discount on the 3 that form part of a set, but the fourth book still costs 8 EUR.</p>
<p>Potter mania is sweeping the country and parents of teenagers everywhere are queueing up with shopping baskets overflowing with Potter books. Your mission is to write a piece of code to calculate the price of any conceivable shopping basket, giving as big a discount as possible.</p>
<p>For example, how much does this basket of books cost?<br>  2 copies of the first book<br>  2 copies of the second book<br>  2 copies of the third book<br>  1 copy of the fourth book<br>  1 copy of the fifth book</p>
<p>(answer: 51.20 EUR) </p>
<p>#含义<br>原题目很长，大意就是出版社要促销一套哈利波特图书，该套图书共5集，每集单册购买价8元。若任意两集各买一本，打95折；若任意三集各买一本，打9折；若任意四集各买一本，打8折；若所有这五集都各买一本，打75折。上述优惠之外再购买的单册还是按8元一本计价。比如五集各买一本之外再加一本第一集，五本书打75折，这本另加的第一集按8元计价。若有人第一集买2本，第二集买2本，第三集买2本，第四集买1本，第五集买1本。问打折后最低的优惠价是多少钱？提示，不是51.6元，而是51.2元。</p>
<p>#思路<br>现在我想了一个办法，就是一个DiscountHandler，集成了95折、9折、8折、75折的handler，然后有一个购物车，从购物车用不同的handler去处理，然后会剩下剩余的购物车（这个购物车会有多种情况，比如1、2、3、4、5、3、4、5在8折策略后可能会是5、3、4、5，也可能是1、3、4、5），然后再把剩余的购物车用DiscountHandler去处理。<br>具体实现，还需要用业余时间去设计实现。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/12/2014-05-12-you-should-figure-out-what-you-want-to/" itemprop="url">
                  用户应该想清楚要什么，产品经理应该清楚用户需要什么
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-05-12T14:30:00+08:00" content="2014-05-12">
              2014-05-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/产品/" itemprop="url" rel="index">
                    <span itemprop="name">产品</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/产品/设计/" itemprop="url" rel="index">
                    <span itemprop="name">设计</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/产品/设计/极简/" itemprop="url" rel="index">
                    <span itemprop="name">极简</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#话题<br>最近关于Thinkpad new X1的争论非常多，很多人抱着“贬”的态度。对于这款有着独创式的键盘，如果用习惯传统键盘的人使用恰里，就会出现光标乱飞、页面乱切、时不时休眠、时不时关闭页面，各种键需要拿着放大镜去找……而且很多特殊功能需要查说明书才能发现。<br>贬的就不用说了，各种骂设计师脑残，各种骂又贵有JB难用，各种骂要换Mac，各种喊9700买的本全新的7900出。<br>但是也有人持褒的态度，意思是Mac的键盘也不好用啊，你们应该抛弃久的习惯使用这更高（搞）效（笑）的操作……</p>
<p>#拙见<br>我对于新事物从来都是比较好奇的，不过这9700的东西我是买不起了，只能围观看看。<br>随便举个X1的创新，比如CAPS LOCK键被去掉了，取而代之的是home 和end，原来的大写锁变成点击Shift两下。这个设计主要是因为我们的小拇指太短，正常键盘上无法点击到home和end键，所以设计师说那就给你们放近一点，不用谢，请叫我雷锋。但是使用的人估计只会大喊，你妹啊，刚刚想输入个大写字母，怎么就跳到页顶去了。然后据说Shift两下后大小写锁定状态的灯很烂，基本不知道现在处于什么状态。<br>别的功能就不一一列举，反正我看到的所有介绍，基本上都可以用“坑爹两个字形容”。</p>
<p>#极简<br>我想，X1的设计师估计是想达到乔老爷子极简的境界，这种多一分太多少一分不足的境界，真是很难把握的。首先要改变传统使用者的习惯，这就很需要乔老爷子那种扭曲现实的能力，强势的给你灌输这货就是应该这样操作的。然后就是很难符合每个人口味，毕竟每个人的需求不一样，这功能在路人甲那可能是渣渣，而在路人乙那确实瑰宝。<br>按产品设计的原则来说，80%主流用户的80%需求就是产品极简的界限，那么这种调查要怎么做呢？这得对产品经理的自觉有多大的要求啊。至少，X1这牛是没画好。</p>
<p>#电话线还是无线<br>产品设计最终目的还是解决问题，那么就要找到用户需求的本质，他到底是需要5米长的电话线还是一个无线电话，又或者说是要飞机还是更快的火车。这样产品设计的例子是在太多了，但是我这新手从前人已有事迹上来马后炮当然是坐着说话不腰疼，实际操作中是很难。我也做产品设计，但是我清楚的感觉到对于用户的需求的极简设计很难把握。比如用户想要一个更方便的监控资源配置，我要设计出他真实想要的，我一定需要了解到他产生这个想法时候的情景环境，这时候我就幻想自己是一个运维管理员，对着资源清单配置了一整天，想象那种烦躁的心情，想象这时候我想要的是什么？<br>除了情景环境，还要的就是Idea，比如刚刚那个情景，我想到的就是导入、批量设置、可视化配置，但是这些都稍微能改善一些问题，但是没有解决根源问题，还是有复杂的配置。</p>
<p>#工具论<br>其实，不管什么样的设计，他都不过是一个解决用户问题的工具，首先他要能解决问题。设计的再好，如果不能再用户所在情境下解决特定的问题，都是错误设计，或者过度设计。所以我觉得X1他没能解决用户的问题。在我看来Thinkpad面向的还是商务用户，他们不像程序员那样喜欢一直把手停留在键盘上，所以并不需要两只手范围内完成所有的操作，而且X1的很多设计都过于复杂，并没有加快商务人士的工作效率。在没有提高效率的前提下增加了他们的学习成本，就算老板肯为这昂贵的笔记本买单，使用者也不大愿意使用吧？</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/05/08/2014-05-08-transfer-went-from-seven-values-of-zhang-xiaolong-said/" itemprop="url">
                  [转]从张小龙的七大价值观说开去
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-05-08T14:45:00+08:00" content="2014-05-08">
              2014-05-08
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://www.csdn.net/article/2014-05-07/2819654-WeiXin-Group-zhangxiaolong" target="_blank" rel="external">原文地址</a></p>
<p>#摘要<br>腾讯公司宣布由张小龙担任微信事业群总裁。微信的成功让人们开始越来越多的关注他，可以说他的每一句话、每一句理念都影响着中国大量互联网从业者。文中笔者收集了张小龙给产品经理的一些建议，希望对你有所启迪。<br>近日，腾讯公司宣布成立微信事业群（WeiXin Group，简称WXG），由“微信之父”、腾讯高级副总裁张小龙担任事业群总裁，并向公司总裁刘炽平汇报工作。</p>
<p>#概述<br>据悉，微信事业群将负责包括微信基础平台、微信开放平台，以及微信支付拓展、O2O等微信延伸业务的发展，并包括邮箱、通讯录等产品开发和运营，致力于打造微信大平台，为用户和合作伙伴创造更多价值。腾讯内部未来将包括七个事业群组，分别为WXG（微信事业群）、SNG（社交网络事业群）、CDG（企业发展事业群）、IEG（互动娱乐事业群）、MIG（移动互联网事业群）、OMG（网络媒体事业群）和TEG（技术工程事业群）。<br>有人在知乎上问：腾讯的张小龙是一个什么样的人？大家的回答绫罗万千，无不夸赞这位优秀的产品经理。谈及微信，张小龙称对人性的把握最重要。微信的成功让人们开始越来越多的关注他，可以说他的每一句话每一个做产品的理念都开始影响中国大量互联网从业者。为此，笔者收集了张小龙给产品经理的一些建议，希望对你有所启迪。</p>
<p>#七大价值观</p>
<p>微信事业群的成立意味着微信已完成第一阶段的孵化，从产品升级为腾讯战略级的业务体系。张小龙总结了微信团队的七大理念，希望新团队能继续保持和发扬。他指出，</p>
<ul>
<li>要做对用户有价值的事情；</li>
<li>保持我们自身的价值观，因为它会体现在我们的产品和服务中；</li>
<li>保持小团队，保持敏捷；</li>
<li>学习速迭代比过去的经验更重要；</li>
<li>系统思维；</li>
<li>让用户带来用户，口碑赢得口碑；</li>
<li>思辨胜于执行。</li>
</ul>
<p>事实上，张小龙并不认为自己说的每一句话都值得产品经理研究，他甚至坦言，成功的产品经理是很难复制的。推荐阅读：<a href="http://play.cn/base/news/view/54938.htm" target="_blank" rel="external">优秀的产品经理难以复制</a>、<a href="http://www.leiphone.com/7-24-allen-zhang-wechat.html" target="_blank" rel="external">通过微信谈产品》完整版</a></p>
<p>#对产品经理要求：一千一百十<br>一千指每月在微博、QQ空间等谈论相关行业话题需要和他们互动一千次，点赞也算；一百指每月相关行业的重要分析文章看一百篇；十指每月需要与客户、消费者互动十次，最好是深度访谈。</p>
<p>#产品经理的方法论与价值观<br>回顾微信的演化历史之后，张小龙几乎分析了有关移动互联网产品的所有关键点，包括了其产品经理的素养，产品设计原则、思路与方法论等等。全文最令笔者感触的一句话是：它没有人造物的冰冷生硬，而有一种温暖的人性存在。<br>产品经理的主流应该是服务于未来。先于人众接触新技术新知识，并把这种认知转化为产品，利用产品提供现代人类社会中的各种人群。尽一切可能，降低学习成本，利用人类的本能设计产品，使得人群得以顺利“滑入”新的产品使用场景。</p>
<p>移动互联网产品经理的素养应包括：敏锐感知潮流变化、、放弃理性思维、海量的实践、博而不专的积累、负责的态度。</p>
<p>#APP产品经理必须要懂的30条原则</p>
<p>手机是肢体的延伸，和人是一体的；而PC是外物，即外部环境。移动互联网产品不是简单的PC到手机的移植。做没有Web的移动互联网产品该怎么做？这对中国IT人来说是全新的课题。这里整理出的30条原则，可以看到对于APP产品设计和推广的清醒认识。</p>
<ul>
<li>时尚是驱动力 </li>
<li>重视“屌丝”用户群 </li>
<li>从日常体验中发现本质 </li>
<li>需求是满足人们的贪嗔痴 </li>
<li>需求的本质往往可以归结为心理诉求</li>
</ul>
<p>#微信背后的产品观：移动互联网产品经理要放弃理性思维</p>
<p>一个亿级用户的产品经理，无需做到透彻思考人性和产品的所有方面，得出定性结论，但依然可以做出成功的产品。</p>
<p>一个成功的产品经理，需要在极端现实主义和极端理想主义之间取得平衡，把它们作为整体一并接受下来，彻底去除其中的相对性，丝毫不会觉得其中的矛盾和冲突之处。</p>
<p>#产品之上的世界观</p>
<p>微信的平台化发展方向是否真的会让这个原本简洁的产品变得臃肿？在国际化发展方向上，微信面临的问题真的是文化差异壁垒吗？腾讯高级副总裁、微信产品负责人张小龙给出了自己的回复。张小龙认为，一个东西是不是很臃肿并不取决于它有多少功能，而取决于它最终展现出来的，在体验上是不是用户觉得很臃肿。</p>
<p>他表示，做产品不是从文化角度出发，而是从需求出发。微信国际化路线上能否成功，未必是由文化因素决定，而是对当地的用户和需求是否够了解。</p>
<p>#怎样做简单的产品经理？</p>
<p>怎样看待简单是美？张小龙的理解是，简单是一种审美观，它不是一种完全理性的结论。不是说尽可能做得简陋一点，而是说你脑袋里是不是有一种观念在这里。当你看到一个界面上密密麻麻铺满了按钮，你就知道这东西一点都不美，想要把它给简化一下。</p>
<p>产品经理应该像上帝那样了解人性 ，我们喜欢简单，因为上帝创造宇宙的时候，定下来的规则也非常简单。</p>
<p>#张小龙的腾讯内部邮件<br><strong>微信BG的兄弟姐妹们</strong>，</p>
<p>想必大家都已看到公司发文的消息：今天，微信BG正式成立，将负责以微信为基础建设移动互联网社交、开放与O2O平台，为用户提供即时通信与线上娱乐、生活 和商业化的综合性服务，创造更多价值。这意味着 <code>微信已完成第一阶段的孵化，从产品升级为腾讯战略级的业务体系，全面助力公司在移动互联网领域发挥更大作用</code>。</p>
<p>2010年10月微信立项，2011年1月微信发布第一版。我们从QQ邮箱团队分出一支10个人的小团队开始起步，成长到现在的微信BG。微信的用户量，也成长到几亿之大。我们欣喜看到移动互联时代，微信融入了几亿人日常的线上生活， 让时间和空间在这个时代有了新的涵义。在此，我要特别感谢每位微信同学的全力付出，并且为大家在这三年里面创造的微信之旅感到骄傲！</p>
<p>新的BG，也吸纳了ECC和财付通的一些团队。欢迎新同学的加入！</p>
<p>作为一个新的业务团队，我也希望之前微信团队的一些理念能继续保持和发扬。这些理念，其实也是公司一直倡导的。在这里总结几点。</p>
<p>##做对用户有价值的事情。</p>
<p>我们经常会在各种权衡中做取舍，在任何时候，我们都要想，这个事情是不是从用户价值本身出发的来考虑的。如果我们想的策略和用户价值有违背，哪怕舍弃短期利益，也应该维护用户价值。让用户看到你的努力，而不是同事和上级。</p>
<p>##保持我们自身的价值观，因为它会体现在我们的产品和服务中。</p>
<p>解决纷争时，它会帮我们做出决定。如果我们认为用户不能被骚扰，我们就不会在产品中做出骚扰用户的行为。如果我们没有一致的价值观，我们的产品和服务就会割裂为利益的集合体。不做个人价值观和产品价值观的双面人。</p>
<p>##保持小团队，保持敏捷。</p>
<p>希望我们在BG成立规模变大后，还能保持小团队心态，避免陷入官僚化和流程化里面。我们曾经禁止写PPT，认为那是形式化的体现。这有些武断，但目标是效率的最大化。我们还将继续限制招聘的人员数目，只招聘最优秀的人员加入团队。对一个优秀团队来说，人员也是少比多好。</p>
<p>##学习和快速迭代比过去的经验更重要。</p>
<p>移动互联网变化太快，我们的产品和业务思路，也希望是面向新的环境而产生。</p>
<h2 id="系统思维。"><a href="#系统思维。" class="headerlink" title="系统思维。"></a>系统思维。</h2><p>记住我们的愿景：连接人，连接企业，连接物体。让它们组成有机的自运转的系统，而不是构建分割的局部的商业模式。我们专注于基于连接能力的平台，并将平台开 放给第三方接入，和第三方一起建造基于微信的人和服务的生态系统。系统思维也会帮助我们建造透明公正的商业体系，让系统在规则下运转，避免人为的干预。</p>
<p>##让用户带来用户，口碑赢得口碑。</p>
<p>用互联网的网状传递效应来推动产品和服务。一个例子是一个小小的飞机大战可以引发一场手机游戏的风暴。我们处在一个人人互联的时代，如果我们能让一个用户说好，这个口碑就会传播出去。将我们的创造力体现在各个细节中。创意不是宏图大略，而在于我们每天工作的点点滴滴，用户都能感知到。</p>
<p>##思辨胜于执行。</p>
<p>执行力很重要，但更希望我们的日常工作是一个思辨的过程。我们提倡争论，在工作中通过辩理来找到正确的解决方法，而非为了团队利益或者人际关系放弃思辨能力甚至思辨习惯。进步来自思辨。</p>
<p>这些朴素的价值观，希望能融入到我们团队的日常工作中。</p>
<p>过去的三年，是微信从无到有的成长的三年。未来的三年，希望微信能成长为一个真正的具备开放能力的系统，并培育出健康的生态。</p>
<p>“微信因你而美“，这是我们去年年会的主题，也以此来感谢大家。在新的微信BG下，相信我们会一起努力，让我们的产品和服务做得更好！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="David Woo" />
          <p class="site-author-name" itemprop="name">David Woo</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/">
              <span class="site-state-item-count">91</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">195</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">David Woo</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>

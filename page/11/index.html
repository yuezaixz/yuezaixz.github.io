<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="大胃吴的闲话唠嗑">
<meta property="og:url" content="http://yoursite.com/page/11/index.html">
<meta property="og:site_name" content="大胃吴的闲话唠嗑">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="大胃吴的闲话唠嗑">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/page/11/"/>

  <title> 大胃吴的闲话唠嗑 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">大胃吴的闲话唠嗑</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">扯扯技术，唠唠闲话 交流email-xiao303178394@gmail.com</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-首页">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            menu.首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-文章">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            menu.文章
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/26/2014-01-26-an-array-of-negative-thinking-is-the-javascript-a/" itemprop="url">
                  是否该持否定性思维---javascript中的数组（一）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-01-26T04:18:00+08:00" content="2014-01-26">
              2014-01-26
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/javascript/个人随笔/" itemprop="url" rel="index">
                    <span itemprop="name">个人随笔</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/javascript/个人随笔/否定性思维/" itemprop="url" rel="index">
                    <span itemprop="name">否定性思维</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/javascript/个人随笔/否定性思维/自我反思/" itemprop="url" rel="index">
                    <span itemprop="name">自我反思</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/javascript/个人随笔/否定性思维/自我反思/数组/" itemprop="url" rel="index">
                    <span itemprop="name">数组</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>总算回到家了，一下车立马和小伙伴们吃久违的邵武紫溪粉去，不说有多好吃，吃的是一种回忆，人们泛着小舟逆流而上时，浪水也不断把我们打回到过去，而我们也努力在这间歇体验那曾经的美好，之后又继续摇起船桨奋力前进，直到有一天我们再也回不到过去了。<br>成长总是伴随着一些忧伤的，就像曾经的我也考公务员，最终结果是进入面试后差了0.6分。这次回来各种亲戚还依然惦记着我的公务员，不断问我，什么时候再考啊。其实我心里已经不想考了，我对公务员想法已经转变了，我认为让一个社会的优秀人才都去做公务员本来就是一种时代的退步，更何况公务员消减一半也丝毫不会影响政府工作。<br>但是，当我不断对一个东西持否定态度的时候我就要开始考虑一个问题了，我这是陷入否定性思维的泥沼了吗？否定性思维就是一个人总喜欢对任何事物持否定态度。哎，这人这么有钱，一定是黑商；这女明星这么红，一定是给潜规则了，一定有干爹；互联网金融一定是泡沫，你们这些人就等着泡沫破灭吧……这种人喜欢用否定别人的方式来让自己的失败变的理顺当然。当一个事物出现，有些人很好，他们想办法应对这种改变；而又有一部分人就喜欢做否定者，不断的否定他们，就想把你的智商拉到和他一样的水平线上，然后以他丰富的白痴经验打败你。或许他们的否定是对的，但是，他们这样的人我认为是不会成功的。<br>所以我就陷入沉思了，我是因为自己没考上，然后才持否定态度吗？我觉得，真不是，至少不完全是。我没有继续考，也主要是因为这个公务员这个稳定的米缸在我看来一是很无趣，让生活失去目标，二是这个米缸的好日子也差不多到头了吧，米缸里面的米已经被大批大批的老鼠吃的差不多了哦。不想谈政治，只是突发奇想的思考了下自己是否变成了一个否定者了，很好的是，我还不完全是，但是，公务员怎么怎么样又关我何事要我去唠叨呢？所以避免言多有失，我还是少说话，多敲代码吧。</p>
<p>————————————分割线———————————–<br>util篇的第二篇暂时不准备写，因为我觉得还有很多各重要的知识应该要先好好巩固下，比如javascript的数组对象。内容比较多，分几篇博文来写吧。<br>在Javascript中，我经常用[]的方式来便捷的创建数组（当然也可以用Array构造函数），但是我并不了解他。由于项目中有用到，所以特地找了一些资料学习了下。本文就是javascript数组的学习笔记。</p>
<p>#1 概述<br>数组对象继承自Object.prototype，对数组执行typeof操作符返回‘object’而不是‘array’。然而执行[] instanceof Array返回true。此外，还有类数组对象使问题更复杂，如字符串对象，arguments对象。arguments对象不是Array的实例，但却有个length属性，并且值能通过索引获取，所以能像数组一样通过循环操作。</p>
<p>#2 数组原型的方法</p>
<ul>
<li>循环.forEach</li>
<li>断言.some和.every</li>
<li>.join和.concat的区别</li>
<li>栈和队列.pop，.push，.shift和.unshift</li>
<li>模型映射.map</li>
<li>查询.filter</li>
<li>排序.sort</li>
<li>计算.reduce和.reduceRight</li>
<li>复制.slice</li>
<li>万能的.splice</li>
<li>查找.indexOf</li>
<li>in操作符</li>
<li>reverse</li>
</ul>
<h2 id="2-1-循环foreach"><a href="#2-1-循环foreach" class="headerlink" title="2.1 循环foreach"></a>2.1 循环foreach</h2><p>该方法IE9+上才支持。所以现在公司不允许使用该函数。<br>使用形式：[].foreach(callback)<br>回调函数传入三个参数如下：</p>
<ul>
<li>value 当前操作的数组元素</li>
<li>index 当前操作元素的数组索引</li>
<li>array 当前数组的引用</li>
</ul>
<figure class="highlight javascript"><figcaption><span>testForeach.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[<span class="string">'_'</span>, <span class="string">'t'</span>, <span class="string">'a'</span>, <span class="string">'n'</span>, <span class="string">'i'</span>, <span class="string">'f'</span>, <span class="string">']'</span>].forEach(<span class="function"><span class="keyword">function</span> (<span class="params">value, index, array</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.push(<span class="built_in">String</span>.fromCharCode(value.charCodeAt() + index + <span class="number">2</span>))</div><div class="line">    &#125;, out = [])</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(out.join(<span class="string">''</span>));</div><div class="line"><span class="built_in">console</span>.log(out);</div></pre></td></tr></table></figure>
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[David@localhost arraytest]$ node testForeach.js</div><div class="line">awesome</div><div class="line">[ 'a', 'w', 'e', 's', 'o', 'm', 'e' ]</div></pre></td></tr></table></figure>
<p>可以传递可选的第二个参数(上例中的out)，作为每个调用函数的上下文（this）。<br>我们不能打断foreach，如果需要打断，需要用到some和every，请继续往下看。</p>
<h2 id="2-2-可退出循环some、every"><a href="#2-2-可退出循环some、every" class="headerlink" title="2.2 可退出循环some、every"></a>2.2 可退出循环some、every</h2><p>在java中，你可能会用到break去跳出循环，那么再javascript中要怎么做呢？<br>Some和every使用形式：[].some(callback)/ [].every(callback)，回调函数传入三个参数与foreach相同。当回调函数返回true时候some就会中断，some的返回结果也就会true，代表找到了寻找的元素，而every想法，当false时候中断，但是every要注意的是，如果要every返回true，需要所有的遍历元素都返回true。<br><figure class="highlight javascript"><figcaption><span>testSomevery.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">    <span class="keyword">if</span>(tempStr === value)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">excludeStr</span>(<span class="params">tempStr</span>)</span>&#123;</div><div class="line"><span class="keyword">return</span> tempArray.every(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,array</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(tempStr === value)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> param = process.argv[<span class="number">2</span>];</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"Array ["</span>+tempArray+<span class="string">"] contains string '"</span>+param+<span class="string">"'? "</span>+includeStr(param));</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"Array ["</span>+tempArray+<span class="string">"] exclude string '"</span>+param+<span class="string">"'? "</span>+excludeStr(param));</div></pre></td></tr></table></figure></p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[David@localhost arraytest]$ node testSomeEvery.js David</div><div class="line">Array [David,Wu,Love,TY,forever,hahaha] contains string 'David'? true</div><div class="line">Array [David,Wu,Love,TY,forever,hahaha] exclude string 'David'? false</div><div class="line">[David@localhost arraytest]$ node testSomeEvery.js ty</div><div class="line">Array [David,Wu,Love,TY,forever,hahaha] contains string 'ty'? false</div><div class="line">Array [David,Wu,Love,TY,forever,hahaha] exclude string 'ty'? true</div><div class="line">[David@localhost arraytest]$ node testSomeEvery.js Ty</div><div class="line">Array [David,Wu,Love,TY,forever,hahaha] contains string 'Ty'? false</div><div class="line">Array [David,Wu,Love,TY,forever,hahaha] exclude string 'Ty'? true</div></pre></td></tr></table></figure>
<h2 id="2-3-Join，数组插入分隔符"><a href="#2-3-Join，数组插入分隔符" class="headerlink" title="2.3 Join，数组插入分隔符"></a>2.3 Join，数组插入分隔符</h2><p>join(分隔符)方法创建一个字符串，会将数组里面每个元素用分隔符连接。如果没有提供分隔符，默认的分隔符为“,”。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[David@localhost arraytest]$ node</div><div class="line"> var tempArray = [&apos;David&apos;,&apos;Wu&apos;,&apos;Love&apos;,&apos;TY&apos;,&apos;forever&apos;,&apos;hahaha&apos;];</div><div class="line">undefined</div><div class="line"> tempArray.join();</div><div class="line">&apos;David,Wu,Love,TY,forever,hahaha&apos;</div><div class="line"> tempArray.join(&apos;&apos;);</div><div class="line">&apos;DavidWuLoveTYforeverhahaha&apos;</div><div class="line"> tempArray.join(&apos; &apos;);</div><div class="line">&apos;David Wu Love TY forever hahaha&apos;</div></pre></td></tr></table></figure></p>
<h2 id="2-4-Concat-数组浅复制"><a href="#2-4-Concat-数组浅复制" class="headerlink" title="2.4 Concat,数组浅复制"></a>2.4 Concat,数组浅复制</h2><p>concat方法创建一个新数组，其是对原数组的浅拷贝。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> var David = &#123;firstname:&apos;david&apos;,lastname:&apos;wu&apos;&#125;</div><div class="line">undefined</div><div class="line">/ var src = [1,2,3,David]</div><div class="line">undefined</div><div class="line">/var target = src.concat()</div><div class="line">undefined</div><div class="line">/src === target</div><div class="line">false</div><div class="line">/src[3] === a</div><div class="line">/src[3] === David</div><div class="line">true</div><div class="line">/target[3] === David</div><div class="line">true</div></pre></td></tr></table></figure></p>
<p>===在比较对象的时候是比较引用（值类型是比较值，比如number,string等是值类型，而一般对象都是引用类型，比较引用），就是是否为同一个指针的指向，也就是内存地址是否相同。所以拷贝后的target与src比较返回false，因为target是拷贝后的结果。<br>但是，因为是浅拷贝，所以数组内的元素还是用相同的指针指向，所以是相同的。<br>Concat还能加入不限制个数参数，参数可以是值，也可以是一个数组，都会把它加入到数组的末端。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">src.concat(target)</div><div class="line">[ <span class="number">1</span>,</div><div class="line">  <span class="number">2</span>,</div><div class="line">  <span class="number">3</span>,</div><div class="line">  &#123; <span class="attr">firstname</span>: <span class="string">'david'</span>, <span class="attr">lastname</span>: <span class="string">'wu'</span> &#125;,</div><div class="line">  <span class="number">1</span>,</div><div class="line">  <span class="number">2</span>,</div><div class="line">  <span class="number">3</span>,</div><div class="line">  &#123; <span class="attr">firstname</span>: <span class="string">'david'</span>, <span class="attr">lastname</span>: <span class="string">'wu'</span> &#125; ]</div><div class="line">src.concat(<span class="string">'tang'</span>,<span class="string">'ying'</span>,<span class="string">'hahaha'</span>)</div><div class="line">[ <span class="number">1</span>,</div><div class="line">  <span class="number">2</span>,</div><div class="line">  <span class="number">3</span>,</div><div class="line">  &#123; <span class="attr">firstname</span>: <span class="string">'david'</span>, <span class="attr">lastname</span>: <span class="string">'wu'</span> &#125;,</div><div class="line">  <span class="string">'tang'</span>,</div><div class="line">  <span class="string">'ying'</span>,</div><div class="line">  <span class="string">'hahaha'</span> ]</div></pre></td></tr></table></figure>
<h2 id="2-5-Pop、push实现栈"><a href="#2-5-Pop、push实现栈" class="headerlink" title="2.5 Pop、push实现栈"></a>2.5 Pop、push实现栈</h2><p>使用push可以压入一个元素或者一个数组。<br>而用pop则移除数组的末尾元素，并移除。如果数组是空返回返回void 0（undefined）。用这两个方法可以实现LIFO的栈数据结构。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Stack</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>._statck=[]&#125;</div><div class="line">Undefined</div><div class="line">Stack.prototype.next = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>._statck.pop();&#125;</div><div class="line">[<span class="built_in">Function</span>]</div><div class="line">Stack.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params">arrayx</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>._statck.push(arrayx);&#125;</div><div class="line">[<span class="built_in">Function</span>]</div><div class="line">stack = <span class="keyword">new</span> Stack()</div><div class="line">&#123; <span class="attr">_statck</span>: [] &#125;</div><div class="line">stack</div><div class="line">&#123; <span class="attr">_statck</span>: [] &#125;</div><div class="line">stack.add(<span class="number">1</span>);</div><div class="line"><span class="number">1</span></div><div class="line">stack.add(<span class="string">'David'</span>);</div><div class="line"><span class="number">2</span></div><div class="line">stack.add(<span class="string">'Wu'</span>);</div><div class="line"><span class="number">3</span></div><div class="line">stack.add(<span class="string">'tang'</span>);</div><div class="line"><span class="number">4</span></div><div class="line">stack.add(<span class="string">'ying'</span>);</div><div class="line"><span class="number">5</span></div><div class="line">stack</div><div class="line">&#123; <span class="attr">_statck</span>:</div><div class="line">   [ <span class="number">1</span>,</div><div class="line">     <span class="string">'David'</span>,</div><div class="line">     <span class="string">'Wu'</span>,</div><div class="line">     <span class="string">'tang'</span>,</div><div class="line">     <span class="string">'ying'</span> ] &#125;</div><div class="line">stack.next()</div><div class="line"><span class="string">'ying'</span></div><div class="line">stack.next()</div><div class="line"><span class="string">'tang'</span></div><div class="line">stack.next()</div><div class="line"><span class="string">'Wu'</span></div><div class="line">stack.next()</div><div class="line"><span class="string">'David'</span></div><div class="line">stack.next()</div><div class="line"><span class="number">1</span></div><div class="line">stack</div><div class="line">&#123; <span class="attr">_statck</span>: [] &#125;</div></pre></td></tr></table></figure>
<p>这里可以用apply稍微改造下该方法。至于apply是什么，可以参考该文章<a href="http://www.cnblogs.com/KeenLeung/archive/2012/11/19/2778229.html" target="_blank" rel="external">Apply方法详解</a>。</p>
<figure class="highlight javascript"><figcaption><span>Stack.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Stack</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>._stack = [];</div><div class="line">&#125;</div><div class="line"></div><div class="line">Stack.prototype.next = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._stack.pop();</div><div class="line">&#125;</div><div class="line">Stack.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._stack.push.apply(<span class="keyword">this</span>._stack,<span class="built_in">arguments</span>);</div><div class="line">&#125;</div><div class="line"><span class="built_in">module</span>.exports = Stack;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">var Stack = require(&apos;./Stack&apos;)</div><div class="line">undefined</div><div class="line">stack = new Stack();</div><div class="line">&#123; _stack: [] &#125;</div><div class="line">stack.add(&apos;David&apos;,&apos;Wu&apos;,1988,1114)</div><div class="line">4</div><div class="line">stack.next();</div><div class="line">1114</div><div class="line">stack</div><div class="line">&#123; _stack: [ &apos;David&apos;, &apos;Wu&apos;, 1988 ] &#125;</div><div class="line">stack.next();</div><div class="line">1988</div><div class="line">stack.next();</div><div class="line">&apos;Wu&apos;</div><div class="line">stack</div><div class="line">&#123; _stack: [ &apos;David&apos; ] &#125;</div><div class="line">&gt;</div></pre></td></tr></table></figure>
<h2 id="2-6-shift和unshift实现队列"><a href="#2-6-shift和unshift实现队列" class="headerlink" title="2.6 shift和unshift实现队列"></a>2.6 shift和unshift实现队列</h2><p>用unshift 和 shift可以很好的模拟FIFO（先进先出）队列。</p>
<figure class="highlight javascript"><figcaption><span>Queue.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Queue</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>._queue = [];</div><div class="line">&#125;</div><div class="line"></div><div class="line">Queue.prototype.next = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._queue.shift();</div><div class="line">&#125;</div><div class="line">Queue.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._queue.unshift.apply(<span class="keyword">this</span>._queue,<span class="built_in">arguments</span>);</div><div class="line">&#125;</div><div class="line"><span class="built_in">module</span>.exports = Queue;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var Queue = require(&apos;./Queue&apos;);var queue = new Queue();</div><div class="line">undefined</div><div class="line">queue.add(1,3,5,7);</div><div class="line">4</div><div class="line">queue</div><div class="line">&#123; _queue: [ 1, 3, 5, 7 ] &#125;</div><div class="line">queue.next()</div><div class="line">1</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/23/2014-01-23-programming-language-status-technical-people-in-transition/" itemprop="url">
                  编程语言现状、技术人转型
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-01-23T13:05:00+08:00" content="2014-01-23">
              2014-01-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/个人随笔/" itemprop="url" rel="index">
                    <span itemprop="name">个人随笔</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/个人随笔/项目管理/" itemprop="url" rel="index">
                    <span itemprop="name">项目管理</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#项目Deadline<br>终于一年要是个头了，明早稍微准备下演示需要的数据，明天下午进行演示后，今年的工作就到这里了。今天还被通知说年终要年后花，对于这个在研发组内通知后基本上哀声一片，我只能说，大家先不管这些，把现在的工作做好，把明天的演示做好，至于之后有什么不满在慢慢谈。<br>回家后整理了下行李，本来是想好好休息下的。没想到手贱点了下InfoQ就又开始看技术了，看就看又强迫症看完后做了点记录，然后长叹一声，好吧，事已至此，那我干脆也把刚刚做的记录整理成博文，就当做放松吧。（我的放松方式果然是很奇葩）</p>
<p>Infoq原文 <a href="http://www.infoq.com/cn/interviews/chen-hao-talk-language-situation-technicians-transformation--personal-growth?utm_source=infoq&amp;utm_medium=videos_homepage&amp;utm_campaign=videos_row2" target="_blank" rel="external">陈皓谈语言现状、技术人转型、个人成长</a></p>
<h1 id="1-语言现状"><a href="#1-语言现状" class="headerlink" title="1 语言现状"></a>1 语言现状</h1><h2 id="什么样的公司能招到牛人"><a href="#什么样的公司能招到牛人" class="headerlink" title="什么样的公司能招到牛人"></a>什么样的公司能招到牛人</h2><p>第一个，当然是好的福利待遇，根据需求层次来说，物质肯定是拍第一位的，之后才是人生安全需求、自我实现需求等。</p>
<h2 id="没钱怎么招牛人"><a href="#没钱怎么招牛人" class="headerlink" title="没钱怎么招牛人"></a>没钱怎么招牛人</h2><p>一个人去面试一个团队必须有自己的亮点，同样一个团队招人也必须有自己的亮点。大公司招人有优秀的福利、待遇，小公司资源紧缺，招人更需要一种自由的环境。<br>什么是自由的化境呢？就是小公司应该让牛人们可以自由发挥自己的特长，技术驱动、更灵活动态化的元编程语言等，都是吸引牛人的地方。小公司用一些冷门的技术更容易招到大牛，像国内有个Lisp大牛就选择了创业小团队，因为那里能自由的使用Lisp。而大公司更愿意使用经过时间考验的成熟技术，比如Java有企业级Web开发解决方案J2EE，J2EE有Servlet容器，前端有JSP等，控制层有Servlet，模型层有Bean，数据持久层有JDBC，还有社区支持，有很多高效的框架技术。</p>
<h2 id="小公司难道不花工资吗"><a href="#小公司难道不花工资吗" class="headerlink" title="小公司难道不花工资吗"></a>小公司难道不花工资吗</h2><p>牛人也是要生活的。小公司虽然资源紧缺，但是更应该把资金用在刀刃上。招的能力不够的人不能解决问题还会带来问题。所以小公司更要招好的人，大公司还能浪费一点。</p>
<h2 id="什么是好的人才"><a href="#什么是好的人才" class="headerlink" title="什么是好的人才"></a>什么是好的人才</h2><p>也许招不来薪水很高的大牛，但是总会有有理想的人、有热情的人。<br>有能力的人、有热情的人、有潜力的人才是好的人。有热情的人都愿意把时间花在开源社区，更何况花在有亮点能实现自我价值的团队呢？</p>
<h2 id="什么样的团队招不来牛人"><a href="#什么样的团队招不来牛人" class="headerlink" title="什么样的团队招不来牛人"></a>什么样的团队招不来牛人</h2><p>又没物质的待遇，又没精神的升华，那这样的公司肯定招不来牛人。（这句话是废话）</p>
<h1 id="2-对开源的想法"><a href="#2-对开源的想法" class="headerlink" title="2 对开源的想法"></a>2 对开源的想法</h1><p>linux形式的开源优于GNU，Github现在也是LInux这样形式的开源。<br>Linux就是很自由，你可以商用，你也可以什么，你可以不同意我的代码，你自己把它拿去拷贝一份，你想怎么改怎么改，但是你开源就好，然后你那边精彩过 去你回到我这边来，他是一个分布式的一个开源，就是集市，集市的意思是每个人都可以成为一个主干，代码上可以成为一个主干，你也许干的好了你可以把我灭 了，就这个意思，你可以成为我的一个竞争对手。然后GNU它是以教堂的，教堂就是有点集权的，或者说是独裁的这种方式，他说你所有的代码提交必须通过我自 己，我说了那个进，那个不进，这是GNU的方式，所以我比较喜欢这种更为松散的，更为民主的，或者说更为自由的这种公司，这种创业性公司像 37signal有很强的价值观，完全跟其他人不一样，然后现在像Linux这种。但是我觉得现在的开源更接近于像Linux这样的这种方式，以Linux的这种方式我比较喜欢。</p>
<h1 id="3技术转型"><a href="#3技术转型" class="headerlink" title="3技术转型"></a>3技术转型</h1><h2 id="转型的建议"><a href="#转型的建议" class="headerlink" title="转型的建议"></a>转型的建议</h2><p>转型是在一个事情上坚持、执着的副产品。不要为了创业创业，为了转型而转型。博客是写给自己看的，而不是为了出名。等你执着了特别长的时间后，把事情干的比别人出色了以后，这个机会自然而然就出现了， 既得技则优则不惑， 你技术好了，很自然的别人会来请教你，别人会来听你的，事实上你也在做一些管理上的工作了。</p>
<h2 id="如何开始管理"><a href="#如何开始管理" class="headerlink" title="如何开始管理"></a>如何开始管理</h2><h2 id="保持coding"><a href="#保持coding" class="headerlink" title="# 保持coding"></a># 保持coding</h2><p>切忌外行管理内行。要管理技术团队，还是要和技术团队一起去做事情，至少花30%的时间在coding上。 你不写代码就管不了别人。</p>
<h2 id="技术影响力"><a href="#技术影响力" class="headerlink" title="# 技术影响力"></a># 技术影响力</h2><p>然后你必须要有技术影响力。什么叫影响力？影响力就 是那种别人遇到技术问题的时候，或者遇到一些难题时候会来请教你的这种现象，不是说是我当了一个职位比你高的人，我来把我的观念强迫接受下来，不是这样， 这不叫影响力。</p>
<h1 id="4如何看信息碎片化SNS"><a href="#4如何看信息碎片化SNS" class="headerlink" title="4如何看信息碎片化SNS"></a>4如何看信息碎片化SNS</h1><p>看完就会忘掉，不会沉淀下来。微博用来传播新闻八卦比较好。总之微博、微信太浪费时间了。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ul>
<li>专注技术到一定程度，机会自然会出现</li>
<li>锻炼影响力</li>
<li>做好自己</li>
<li>小公司需要有个性，有亮点，同时也不能太亏待了员工</li>
<li>去中心化的开源</li>
<li>别浪费时间在微博上</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/22/2014-01-22-web-age-of-venture-nodejs-util-module-a/" itemprop="url">
                  互联网时代如何创业----Node.js的Util模块（一）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-01-22T13:18:00+08:00" content="2014-01-22">
              2014-01-22
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近打车应用的斗争已经从群雄逐鹿，到现在快的和滴滴打车双雄争霸的市场格局了。但是，两家创业公司的斗争实际并没有那么简单，他们背后是“财付通VS支付宝”，“微信VS来往”，“理财通VS余额包”，最幕后的黑手就是“腾讯VS阿里巴巴”。<br>本文不想过多篇幅来写两家巨头是如何烧钱大战的，不过他们把补贴做到了一种极端上，靠着疯狂砸广告、大力补贴司机、变态似的补贴用户等行为，可以说把整个市场都占据了。打车软件作为最容易被市场接受的LBS服务之一，是巨头们测试其O2O能力和渗透率的绝佳工具，也为未来更多O2O业务提供接口，所以才这么的疯狂。<br>因此，对于两家初创公司，都靠着背后的干爹烧着钱，让别的创业公司基本上没活路，但是别忘了黄花梨做的椅子终究是要让人坐在屁股底下的。也预示着大多数创业公司的最终结果——被收购。<br>那么，在巨头们垄断式的市场里，如何脱颖而出呢？以下的内容基本上是读KK（凯文凯利）的文章的个人理解，理解有误的话请见谅。<br>KK说了，最具有破坏力的竞争来自于边缘而非中心。边缘是不被看好的市场。赢利低、不稳定、未经验证、市场狭小、风险系数极高。小公司不得不进入这样的市场。<br>就像上篇博文中提到的，蒸汽船开始时候故障多、昂贵等等原因都一度是他成为了摆设，但是经过几十年的改造，他把原来的造船行业全部打败了。60年代底特律的第一代汽车被一个叫本田的日本人用自动化的汽车打败了。IBM作为电脑公司也被微软这样做软件的公司不断蚕食，而微软如今又不得不面对一个做搜索引擎的公司（谷歌）的竞争。这些边缘公司却可以逐步打败那些老家伙，都是因为他们没有从正面进行较量，而是从老家伙们没有涉足的边缘进行发展（因为老家伙们需要完善现有产品，强化现有优势）。<br>作为一个赛车游戏的忠实粉丝，我深刻的知道想要超车必须从弯道，所有追赶都是没用的（除非你用外挂，你的车比别人快的多，也就是你有干爹的意思）。微创新这会，就是大公司用来扼杀小公司的手段，一定不是小公司用来颠覆大公司的武器。<br>360是从瑞星看不上眼的免费杀毒市场起家的，苹果是从IBM看不上眼的PC机起家的，微软也是从IBM看不上眼的操作系统起家，谷歌是从微软看不上眼的网络服务起家。但是现在的大公司都聪明了，像打车市场一出现点苗头，就被他们盯上了，所以，在这个时代想要从巨头们的眼皮底下做出点雷声大雨点更大的事情，就是一个字，难！<br>03年有几家闷声做大事的互联网公司是有起色，不过那真的就是巨头们不愿意涉及的边缘行业。谁能扎到下一个缝隙，爬到巨头们的头上呢？2014，让我们拭目以待。<br>————————–分割线—————————</p>
<h1 id="常用工具Util"><a href="#常用工具Util" class="headerlink" title="常用工具Util"></a>常用工具Util</h1><p>util 是一个 Node.js 核心模块，提供常用函数的集合，用于弥补核心 JavaScript 的功能过于精简的不足。Util模块的函数比较多，今天先说两个。</p>
<h2 id="1-util-inherits"><a href="#1-util-inherits" class="headerlink" title="1 util.inherits"></a>1 util.inherits</h2><p>util.inherits(constructor, superConstructor)是一个实现对象间原型继承的原型复制函数。JavaScript 的面向对象特性是基于原型的，与常见的基于类的不同。不像Java中的对面对象特性是基于类的，可以用extends来实现继承，Javascript中需要通过原型复制来实现。这个问题可能要牵扯到javascript的原型概念，下次专门写一篇博文介绍javascript的原型。<br>先简单的打个比方，类就相当于一个模具，通过模具产生对象。而原型就好比达芬奇的蒙娜丽莎，其他艺术家通过高超的技艺复杂成一个一个对象。<br>看下面继承的例子：<br><figure class="highlight javascript"><figcaption><span>testInherits.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> util = <span class="built_in">require</span>(<span class="string">'util'</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Base</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="keyword">this</span>.name = <span class="string">'base'</span>;</div><div class="line"><span class="keyword">this</span>.base = <span class="number">1991</span>;</div><div class="line"><span class="keyword">this</span>.sayHello = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Hello '</span> + <span class="keyword">this</span>.name);</div><div class="line">&#125;;</div><div class="line">&#125;</div><div class="line">Base.prototype.showName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Sub</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="keyword">this</span>.name = <span class="string">'sub'</span>;</div><div class="line">&#125;</div><div class="line">util.inherits(Sub, Base);</div><div class="line"><span class="keyword">var</span> objBase = <span class="keyword">new</span> Base();</div><div class="line">objBase.showName();</div><div class="line">objBase.sayHello();</div><div class="line"><span class="built_in">console</span>.log(objBase);</div><div class="line"><span class="keyword">var</span> objSub = <span class="keyword">new</span> Sub();</div><div class="line">objSub.showName();</div><div class="line"><span class="comment">//objSub.sayHello();</span></div><div class="line"><span class="built_in">console</span>.log(objSub);</div></pre></td></tr></table></figure></p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[David@localhost javascriptStudy]$ node testInherits.js</div><div class="line">base</div><div class="line">Hello base</div><div class="line">&#123; name: 'base', base: 1991, sayHello: [Function] &#125;</div><div class="line">sub</div><div class="line">&#123; name: 'sub' &#125;</div></pre></td></tr></table></figure>
<p>Javascript的对象分三种：原型对象、构造对象、实例对象。<br>objSub是实例对象，如果//objSub.sayHello();不注释则会报错，因为只能继承Base原型的属性，不能继承Base构造对象的属性。<br>具体关于原型，还是请看之后写的关于原型的博文吧，想简单的解释实在太绕了。</p>
<h2 id="2-util-inspect"><a href="#2-util-inspect" class="headerlink" title="2 util.inspect"></a>2 util.inspect</h2><p>util.inspect(object,[showHidden],[depth],[colors])是一个将任意对象转换为字符串的方法，通常用于调试和错误输出。它至少接受一个参数 object，即要转换的对象。<br>showHidden 是一个可选参数，如果值为 true，将会输出更多隐藏信息。<br>depth 表示最大递归的层数，如果对象很复杂，你可以指定层数以控制输出信息的多少。如果不指定depth，默认会递归2层，指定为 null 表示将不限递归层数完整遍历对象。<br>如果color 值为 true，输出格式将会以 ANSI 颜色编码，通常用于在终端显示更漂亮的效果。<br>从下面例子可以看出，就算有toString方法，也不会直接调用他来转换对象。<br><figure class="highlight javascript"><figcaption><span>testInspect.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> util = <span class="built_in">require</span>(<span class="string">'util'</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="keyword">this</span>.name = <span class="string">'byvoid'</span>;</div><div class="line"><span class="keyword">this</span>.toString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">&#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> Person();</div><div class="line"><span class="built_in">console</span>.log(util.inspect(obj));</div><div class="line"><span class="built_in">console</span>.log(util.inspect(obj, <span class="literal">true</span>));</div></pre></td></tr></table></figure></p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[David@localhost javascriptStudy]$ node testInspect.js</div><div class="line">&#123; name: 'byvoid', toString: [Function] &#125;</div><div class="line">&#123; toString:</div><div class="line">   &#123; [Function]</div><div class="line">     [caller]: null,</div><div class="line">     [arguments]: null,</div><div class="line">     [length]: 0,</div><div class="line">     [prototype]: &#123; [constructor]: [Circular] &#125;,</div><div class="line">     [name]: '' &#125;,</div><div class="line">  name: 'byvoid' &#125;</div></pre></td></tr></table></figure>
<h2 id="3-其他"><a href="#3-其他" class="headerlink" title="3 其他"></a>3 其他</h2><p>util还提供了util.isArray()、util.isRegExp()、util.isDate()、util.isError() 四个类型测试工具，以及 util.format()、util.debug() 等工具。有兴趣的读者可以访问 <a href="http://javascript.org/api/util.html" target="_blank" rel="external">API</a>了解详细内容。有空我也会把util这个工具继续写下去。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/21/2014-01-21-a-message-reply-department-manager/" itemprop="url">
                  一封回复部门经理的邮件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-01-21T10:59:00+08:00" content="2014-01-21">
              2014-01-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/学习/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/学习/个人随笔/" itemprop="url" rel="index">
                    <span itemprop="name">个人随笔</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今早部门经理发了一封邮件，意在督促大家在2014年多学习新的技术。然后作为一个话痨，我就花了半个小时时间回复了该邮件，就像跟随党中央号召似的，响应了部门经理的号召。下面就大概把这篇邮件贴出来把（有部分内容删除）。</p>
<p>#邮件内容<br>大家好：<br>这是一个长篇大论，我敲了半个小时吧，忙的人选择性忽略吧。错别字请见谅，没有校审。<br>郭经理推荐的几个技术是不错了。所谓8小时内求生存，8小时外求发展。大家是该多学习学习新的东西，逃离舒适区。300年前蒸汽船诞生，但是当时他贵而且容易发生故障，所有的帆船产商基本都对这庞然大物不敢兴趣，但是仅仅50年，经过蒸汽船的不断改善，所有帆船产生都没市场了。再说的近一点，上世纪60年代，第一代汽车使底特律的汽车工人都算社会的中上层人士，而后来一个叫本田的日本人用自动化汽车让底特律破产了。再说我们身边一点，不说basic等语言了，就说delphi啊，10年前delphi可谓是工资最高的程序员，java5年前也很不错，但是如今最吸金的程序员莫过于objective-c（这里有位童鞋就站出来反驳了，说不能太看重金钱。其实我举吸金这个例子不是说明哪种语言好，只是说明下时代变更有多块，现在不用5年就会发生一次大变更了）。说这么多废话只是想说，别像米缸里的老鼠一样，吃光了米缸里的米后才发现，已经无法跳出米缸了。<br>不过我觉得这些都太大了，特别是云这国内真很难有人能真正接触到，Hadoop学习和生产环境的差别也非常大，我觉得容易着手去学习的，应该是一些比较具体的东西。<br>比如郭飞刚刚也提到的NoSQL，MongoDB伴随着Node.js的兴起，很多网络服务商都开始使用了。并且他是一个开源的NoSql数据库，相比传统关系型数据库，文档性数据库轻巧、灵活，非常适合在数据规模很大、事务性不强的场合下使用。MongoDb这种对象库，没有表、行的概念，也没有固定的模式和结构，MongoDb的文档结构为Json串，用Node.js查询数据甚至没有数据转换的时间。<br>JAVA8今年3月也要发布了，Java从7开始也一直在努力摆脱静态强类型编译型语言的束缚，JAVA8的LAMDA表达式能做到什么程度还不而为知，但是我觉得现在的JVM是越来越强大了，JDK6U23以后用HOTSPOT替代了JIT后，运行速度更快了。而且JVM毕竟可以能运行JAVA，还能运行Ruby、Python、Groovy，甚至半年前新冒头的Vert.x，让node.js可以运行在JVM上了，真是让我和我的小伙伴们的吓傻了。<br>然后说说动态元编程语言（元数据是描述数据的数据，元编程就是可以在运行时改变其特性的语言，java也努力通过代理、反射的方式在实现这种功能）。麦卡锡在上世纪50年代的一篇论文可以说是里程碑式的，因为该论文中提到的很多特性都在JAVA中有很好的体现，但是唯独缺少了宏。Lisp语言就在这方面有很好的实现。现在Ruby、python、javascript可以算当前最好的元编程语言。所以我很建议去学学这几门语言。Java程序员可能比较适合学习scala，因为他也运行在JVM上，而且可以和JAVA有很好的兼容。</p>
<p>此致<br>敬礼</p>
<hr>
<p>2014-01-21<br>吴迪玮<br>厦门市巨龙信息科技有限公司  研发五部</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/20/2014-01-20-new-year-nodejs-global-object/" itemprop="url">
                  辞旧迎新---javascript的全局对象
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-01-20T12:40:00+08:00" content="2014-01-20">
              2014-01-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/javascript/Node-js/" itemprop="url" rel="index">
                    <span itemprop="name">Node.js</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/javascript/Node-js/互联网/" itemprop="url" rel="index">
                    <span itemprop="name">互联网</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/javascript/Node-js/互联网/互联网思维/" itemprop="url" rel="index">
                    <span itemprop="name">互联网思维</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/javascript/Node-js/互联网/互联网思维/去中心化/" itemprop="url" rel="index">
                    <span itemprop="name">去中心化</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/javascript/Node-js/互联网/互联网思维/去中心化/全局对象/" itemprop="url" rel="index">
                    <span itemprop="name">全局对象</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>上周六，公司的尾牙终于结束了。由于公司的尾牙的排练，也落下了不上工作，本周也是当前项目的关键一周，还有很多工作要做，因此这时候想撇开过去说辞旧迎新还是有点早的。但是，我就是一个标题党，我今天要说的辞旧迎新和你们想的肯定完全不一样，谁能猜到我要说的是什么呢？我要说的其实就是，工业时代的过去，互联网时代的到来。<br>自蒸汽机以来250年间，工业思维一直主导着我们的社会，“中心化”、“集中化”、“标准化”、“控制化”等工业品生产领域的概念不仅成为社会管理的方法，也成为商业运作的准则。但是，互联网恰恰相反，是去中心的、异质的、多元的和感性的，它天然就有民主的特性，不巧地解构掉了工业思维。<br>互联网的本质不是用一个更好的管理去打败原来的管理，也不是用创新去打败原来的创新，更不是用更好的技术去打败原来的技术。而是用人类本能的兴趣爱好，而是以一种工作坊的工作方式，去打败以前的大工业时代。互联网是用了很多去中心化的结点效应，产生了集体智慧，群体智慧。<br>也许有人不理解这种去中心化的结点效应是什么？那仔细听了，让我来告诉你。其实嘛，我也不懂，我最多算大概懂个意思。其实我们也已经在这种去中心化的结点效应中生活了好久了，只是没人告诉你这么回事，也就不以为然了。比如我现在写博文就是这样的意思，为整个社区的协同创作做贡献。任何参与者，均可提交内容，网民共同进行内容协同创作或贡献。<br>而twitter则把这个事情做到了一个极致。也许写博文还需要的时间比较多，那发个twitter就简单多了，可以简单的就是一个图片，或者简单的就是一个字。使得为互联网生产或贡献内容更加简便、更加多元化，从而提升了网民参与贡献的积极性、降低了生产内容的门槛。最终使得每一个网民均成为了一个微小且独立的信息提供商，使得互联网更加扁平、内容生产更加多元化。碎片化的信息同样也符合快节奏现代人的阅读习惯。</p>
<p>先就写这些，最近几篇估计都会乱侃互联网时代的改变。<br>———————–分割线————————-</p>
<h1 id="全局对象"><a href="#全局对象" class="headerlink" title="全局对象"></a>全局对象</h1><p>全局对象在javascript中比较特殊，在程序中随时都能访问，类似Java中的静态变量，随时都能 ClassName.STATIC_VAR_NAME 来访问。熟悉客服端JS的应该都知道window，他就是全局对象，而javascript中的全局对象是global，所有的全局变量都是global的属性。<br>在javascript中可以直接访问全局对象的属性，比如在客户端javascript中我们访问最多的就是document变量。而javascript中，console、process是访问较多的全局变量。</p>
<p>##1 定义全局变量<br>满足以下条件则为全局变量：</p>
<ul>
<li>在最外层定义的变量；</li>
<li>全局对象的属性；</li>
<li>隐式定义的变量（未定义直接赋值的变量）。</li>
</ul>
<p>注意：一定要避免最后一种情况，即未使用 var 定义变量。因为全局变量会污染命名空间，提高代码的耦合风险。</p>
<p>##2 常用的全局变量</p>
<p>###2.1 Process<br>process 是一个全局变量，即 global 对象的属性。它用于描述当前 Node.js 进程状态的对象，提供了一个与操作系统的简单接口。<br>下面将会介绍 process 对象的一些最常用的成员方法。</p>
<p>####2.1.1 process.argv<br>process.argv是命令行参数数组，第一个元素是 node，第二个元素是脚本文件名，从第三个元素开始每个元素是一个运行参数。<br>看以下例子：<br><figure class="highlight javascript"><figcaption><span>argv.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(process.argv);</div></pre></td></tr></table></figure></p>
<p>在控制台执行的结果为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[David@localhost javascriptStudy]$ node argv.js 19881114 name=David -V XMUT</div><div class="line">[ &apos;node&apos;,</div><div class="line">  &apos;/home/David/workspace/javascriptStudy/argv.js&apos;,</div><div class="line">  &apos;19881114&apos;,</div><div class="line">  &apos;name=David&apos;,</div><div class="line">  &apos;-V&apos;,</div><div class="line">  &apos;XMUT&apos; ]</div></pre></td></tr></table></figure></p>
<p>####2.1.2 process.stdout<br>标准输出流，通常我们使用的 console.log() 向标准输出打印字符，而 process.stdout.write() 函数提供了更底层的接口。下面这个例子我直接在控制台输出了。<br><figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[David@localhost javascriptStudy]$ node -e 'process.stdout.write("aaa")'</div><div class="line">aaa</div></pre></td></tr></table></figure></p>
<p>####2.1.3 process.stdin<br>标准输入流，初始时它是被暂停的，要想从标准输入读取数据，你必须恢复流，并手动编写流的事件响应函数。<br><figure class="highlight javascript"><figcaption><span>testStdin.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">process.stdin.resume();</div><div class="line">process.stdin.setEncoding(<span class="string">'utf8'</span>);</div><div class="line">process.stdin.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">process.stdout.write(<span class="string">'read from console: '</span> + data.toString());</div><div class="line"><span class="keyword">if</span>(data.toString().substring(<span class="number">0</span>,<span class="number">3</span>) == <span class="string">'bye'</span>)&#123;</div><div class="line">    process.stdin.emit(<span class="string">'end'</span>);</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line">process.stdin.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  process.stdout.write(<span class="string">'end!'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[David@localhost javascriptStudy]$ node testStdin.js</div><div class="line">我是David!</div><div class="line">read from console: 我是David!</div><div class="line">bye</div><div class="line">read from console: bye</div><div class="line">end!</div></pre></td></tr></table></figure>
<p>还有一种方式就是把输入写到文件中重定向，比如我创建一个文件叫in，里面内容是“我是吴迪玮，我是中国人！”。然后执行下面命令。In中的内容会重定向输出到out中去。</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[David@localhost javascriptStudy]$ cat in</div><div class="line">我是吴迪玮，是个中国人！</div><div class="line">[David@localhost javascriptStudy]$ cat out</div><div class="line">cat: out: 没有那个文件或目录</div><div class="line">[David@localhost javascriptStudy]$ node testStdin.js &lt; in out</div><div class="line">[David@localhost javascriptStudy]$ cat out</div><div class="line">read from console: 我是吴迪玮，是个中国人！</div></pre></td></tr></table></figure>
<p>####2.1.4 process.nextTick(callback)<br>process.nextTick(callback) 的功能是为事件循环设置一项任务，Node.js 会在下次事件循环调响应时调用 callback。<br>先解释下下次时间循环响应时调用是什么意思。<br>任何javascript应用都是一个单线程，任何时刻都只有一个事件在执行，因此javascript应用应该尽可能缩短事件的执行时间。process.nextTick(callback)提供了一个这样的工具，可以吧复杂的工作拆散，变成一个一个较小的时间。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">args, callback</span>) </span>&#123;</div><div class="line">somethingComplicated(args);</div><div class="line">process.nextTick(callback);</div><div class="line">&#125;</div><div class="line">doSomething(<span class="function"><span class="keyword">function</span> <span class="title">onEnd</span>(<span class="params"></span>) </span>&#123;</div><div class="line">compute();</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>上面的程序中，somethingComplicated和compute都执行时间较长，因此，后面的process.nextTick(callback);会把耗时的操作拆分，减少每个时间的执行时间，提高响应速度。<br>你也可以使用setTimeout()函数来达到貌似同样的执行效果：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">args, callback</span>) </span>&#123;</div><div class="line">somethingComplicated(args);</div><div class="line">setTimeout(callback, <span class="number">0</span>);</div><div class="line">&#125;</div><div class="line">doSomething(<span class="function"><span class="keyword">function</span> <span class="title">onEnd</span>(<span class="params"></span>) </span>&#123;</div><div class="line">compute();</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>但是 <strong>注意</strong> ：不要使用setTimeout（fn,0）来代替，nextTick效率高的多。</p>
<p>#####2.1.4.1 process.nextTick()和setTimeout(fn, 0)的不同<br>在内部的处理机制上，process.nextTick()和setTimeout(fn, 0)是不同的，process.nextTick()不是一个单纯的延时，他有更多的<a href="https://gist.github.com/mmalecki/1257394" target="_blank" rel="external">特性</a>。<br>更精确的说，process.nextTick()定义的调用会创建一个新的子堆栈。在当前的栈里，你可以执行任意多的操作。但一旦调用netxTick，函数就必须返回到父堆栈。然后事件轮询机制又重新等待处理新的事件，如果发现nextTick的调用，就会创建一个新的栈。</p>
<p>#####2.1.4.2 nextTick()的具体用途<br>可以参考该文，戳<a href="http://www.oschina.net/translate/understanding-process-next-tick?cmp" target="_blank" rel="external">这里</a></p>
<p>####2.1.5 其他<br>除此之外process还展示了process.platform、process.pid、process.execPath、process.memoryUsage() 等方法，以及 POSIX进程信号响应机制。有兴趣的读者可以查看<a href="http://javascript.org/api/process.html" target="_blank" rel="external">API</a>了解详细内容。</p>
<p>###2.2 Console</p>
<p>####2.2.1  console.log()<br>两个简单例子带过。<br><figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[David@localhost javascriptStudy]$ node -e 'console.log("abcd%shijk","efg")'</div><div class="line">abcdefghijk</div><div class="line">[David@localhost javascriptStudy]$ node -e 'console.log("abcd%dhijk","1234")'</div><div class="line">abcd1234hijk</div></pre></td></tr></table></figure></p>
<p>####.2.2.2 console.error()<br>标准错误流输出，用法同上。</p>
<p>####2.2.3 console.trace()<br>向标准错误流输出当前调用栈。<br><figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[David@localhost javascriptStudy]$ node -e 'console.trace()'</div><div class="line">Trace</div><div class="line">    at Object.eval (eval at &lt;anonymous(eval:1:82))</div><div class="line">    at Object.&lt;anonymous(eval:1:70)</div><div class="line">    at Module._compile (module.js:449:26)</div><div class="line">    at evalScript (node.js:358:25)</div><div class="line">    at startup (node.js:77:7)</div><div class="line">    at node.js:699:3</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/13/2014-01-13-nodejs-solution-on-vertxjvm/" itemprop="url">
                  vert.x,JVM上的Node.js解决方案
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-01-13T14:23:00+08:00" content="2014-01-13">
              2014-01-13
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/jvm/" itemprop="url" rel="index">
                    <span itemprop="name">jvm</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/jvm/vertx/" itemprop="url" rel="index">
                    <span itemprop="name">vertx</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近忙的已经要混乱了。项目赶的死，主持人排练赶的死，各种红包炸弹赶的死，女朋友也还是要陪的，恨不出变出几个我来帮我去做这些事情，我就躺在被窝睡觉好了。今天的博文就分享下我用坐班车上班的时间看的一篇文章吧，说的主要是Node.js在JVM上的替代者，原文请戳这里<a href="http://www.infoq.com/cn/news/2012/05/vertx" target="_blank" rel="external">vert.x——JVM上的Node.js替代者</a>.<br><strong>PS.本文斜体部分为引用原文。</strong></p>
<h2 id="其他参考资料"><a href="#其他参考资料" class="headerlink" title="# # 其他参考资料:"></a># # 其他参考资料:</h2><p><a href="http://vertx.io/" target="_blank" rel="external">vert.x官网</a><br><a href="http://en.wikipedia.org/wiki/Vert.x" target="_blank" rel="external">维基</a></p>
<p>#什么是Vert.x</p>
<h2 id="官网解释"><a href="#官网解释" class="headerlink" title="官网解释"></a>官网解释</h2><p>Vert.x is a lightweight, high performance application platform for the JVM that’s designed for modern mobile, web, and enterprise applications.</p>
<h2 id="渣翻译"><a href="#渣翻译" class="headerlink" title="渣翻译"></a>渣翻译</h2><p>Vert.x是一个为智能手机、WEB、企业级应用设计的运行于JVM的轻量级高性能的应用平台。</p>
<h2 id="原文解释"><a href="#原文解释" class="headerlink" title="原文解释"></a>原文解释</h2><p>Vert.x是一个用于下一代异步、可伸缩、并发应用的框架，旨在为JVM提供一个Node.js的替代方案。开发者可以通过它使用JavaScript、Ruby、Groovy、Java、甚至是混合语言来编写应用。</p>
<p>#相比Node.js<br>首先，他的开发流程与node.js是非常类似的。但是，vert.x的性能与可伸缩性都远远超越了node.js。同样是基于EDA事件驱动编程，Vert.x.竟然比Node.js快。<a href="http://architects.dzone.com/articles/inside-vertx-comparison-javascript" target="_blank" rel="external">Inside Vert.x. Comparison with Node.js. | Architects Zone</a>一文测试如下：<br><img src="http://www.cubrid.org/files/attach/images/220547/772/629/vertx_javascript_performance_comparison_200_ok.png" alt=""></p>
<p>#为什么Vert.x如此快</p>
<h2 id="事件驱动编程模型"><a href="#事件驱动编程模型" class="headerlink" title="事件驱动编程模型"></a>事件驱动编程模型</h2><p>和Node.js一样，Vert.x提供一个事件驱动编程模型，使用Vert.x作为服务器时，程序员只要编写事件处理器event handler即可。当TCP socket有数据时，event handler立即被创建调用，另外它还可以在以下几种情况激活： ‘当事件总线Event Bus接受到消息时,’ ‘当接收到HTTP消息时,’ 当一个连接断开时’,’ ‘当计时器超时时.’</p>
<h2 id="事件循环"><a href="#事件循环" class="headerlink" title="事件循环"></a>事件循环</h2><p><em>一个vert.x实例会管理着一个小的线程集合，每个线程针对服务器上的一个可用内核。基本上每个线程都实现了一个事件循环。当部署一个vert.x应用实例（又叫做verticle）时，服务器会选择一个事件循环分配给该实例。接下来针对该实例的任务都会通过该线程进行分配。由于在某一时刻可能会有成千上万个verticle在运行，因此在同一时刻会将单个事件循环指定给多个verticle。</em><br>Vert.x 内部有一个线程池. Vert.x会根据CPU核数匹配线程池的数目。<br>每个线程执行一个Event Loop。Event Loop能确保事件在循环中轮回。例如，它会确证socket是否有数据可读事件，如果有， Vert.x 将调用相应的event handler。</p>
<h2 id="消息传递"><a href="#消息传递" class="headerlink" title="消息传递"></a>消息传递</h2><p><em>Verticle可与运行在相同或不同vert.x实例中的其他verticle进行通信，这是通过消息事件总线实现的，它类似于Erlang的actor模型。消息传递旨在让系统能够在多个可用核心上进行扩展而无需以多线程的方式来执行verticle代码。<br>事件总线是分布式的，并不只会跨越服务器，还会渗透进客户端的JavaScript以处理“实时”的Web应用。</em><br>一个Vert.x中有很多Verticles， Verticles之间使用事件总线Event Bus联系. Verticle类似Erlang/scala中的actor模型（actor模型大概解释就是一个用于消息传递和共享数据的模型，具体我也不是很懂）。</p>
<h2 id="共享数据"><a href="#共享数据" class="headerlink" title="共享数据"></a>共享数据</h2><p>消息传递当然有用，但是它并不总是并发环境最好的，缓存受到普遍使用， Vert.x提供一个分享的缓存Map。而node.js中则需要通过消息传递来在进程间交换数据。</p>
<p>#其他特性</p>
<ul>
<li>TCP/SSL服务器与客户端</li>
<li>HTTP/HTTPS服务器与客户端</li>
<li>WebSockets/SockJS支持</li>
</ul>
<p>#代码<br>如下代码展示了Web服务器是如何通过vert.x来处理静态文件的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">// JavaScript</div><div class="line">load(&apos;vertx.js&apos;)</div><div class="line">vertx.createHttpServer().requestHandler(function(req) &#123;</div><div class="line">  var file = req.path === &apos;/&apos; ? &apos;index.html&apos; : req.path;</div><div class="line">  req.response.sendFile(&apos;webroot/&apos; + file);</div><div class="line">&#125;).listen(8080)</div><div class="line"></div><div class="line"># Ruby</div><div class="line">require &quot;vertx&quot;</div><div class="line">Vertx::HttpServer.new.request_handler do |req|</div><div class="line">  file = req.uri == &quot;/&quot; ? &quot;index.html&quot; : req.uri</div><div class="line">  req.response.send_file &quot;webroot/#&#123;file&#125;&quot;</div><div class="line">end.listen(8080)</div><div class="line"></div><div class="line">// Groovy</div><div class="line">vertx.createHttpServer().requestHandler &#123; req -&gt;</div><div class="line">  def file = req.uri == &quot;/&quot; ? &quot;index.html&quot; : req.uri</div><div class="line">  req.response.sendFile &quot;webroot/$file&quot;</div><div class="line">&#125;.listen(8080)</div><div class="line"></div><div class="line">// Java</div><div class="line">import org.vertx.java.core.Handler;</div><div class="line">import org.vertx.java.core.http.HttpServerRequest;</div><div class="line">import org.vertx.java.deploy.Verticle;</div><div class="line">public class Server extends Verticle &#123;</div><div class="line">  public void start() &#123;</div><div class="line">    vertx.createHttpServer().requestHandler(new Handler() &#123;</div><div class="line">      public void handle(HttpServerRequest req) &#123;</div><div class="line">        String file = req.path.equals(&quot;/&quot;) ? &quot;index.html&quot; : req.path;</div><div class="line">        req.response.sendFile(&quot;webroot/&quot; + file);</div><div class="line">      &#125;</div><div class="line">    &#125;).listen(8080);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>#再见<br>先写到这里吧，困了睡觉去了。最近几天有空就写写博文吧。Z.Z zzzZZZ</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/11/2014-01-11-how-to-use-google/" itemprop="url">
                  How to use 谷歌
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-01-11T02:28:00+08:00" content="2014-01-11">
              2014-01-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/工具/" itemprop="url" rel="index">
                    <span itemprop="name">工具</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/工具/谷歌/" itemprop="url" rel="index">
                    <span itemprop="name">谷歌</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/工具/谷歌/搜索/" itemprop="url" rel="index">
                    <span itemprop="name">搜索</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/工具/谷歌/搜索/个人心得/" itemprop="url" rel="index">
                    <span itemprop="name">个人心得</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本来今早是要写博文的，然后起床弹了会吉他然后就停不下来了。这种时候写一篇技术博文是很不负责的，那就侃一侃如何正确的使用谷妹吧，哦不，是谷歌！本文其实在公司已经做过分享，这里稍微把当时的PPT整理成md格式吧。歹势啊，写完还想玩吉他呢，就不做太大更正了。<br>这里我只介绍下我用谷歌搜索的一些命令的心得，针对的方面也就是程序猿可能经常需要用到的。</p>
<p>#搜索引擎的命令大全：</p>
<h2 id="1、-双引号"><a href="#1、-双引号" class="headerlink" title="1、    双引号"></a>1、    双引号</h2><p>这个最基本的，把搜索词放在双引号中，代表完全匹配搜索，也就是说搜索结果返回的页面包含双引号中出现的所有的词，连顺序也必须完全匹配。比如百度”spring mvc”,比较简单，就不做多余的介绍了；</p>
<p><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175283/cUDcqjTiQlM9kySWCoT3_1.jpg" alt="1.jpg"></p>
<h2 id="2、-减号"><a href="#2、-减号" class="headerlink" title="2、    减号"></a>2、    减号</h2><p>减号代表搜索不包含减号后面的词的页面。使用这个指令时减号前面必须是空格，减号后面没有空格，紧跟着需要排除的词。如下图，就去掉博客专栏的相关搜索结果。<br><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175283/6PUK5KArSyC7DqykIV7X_2.jpg" alt="2.jpg"></p>
<h2 id="3、-星号"><a href="#3、-星号" class="headerlink" title="3、    星号"></a>3、    星号</h2><p>这个也很基础，缩略若干字，也就是通配符的意思。如下图，任然可以搜索出springmvc的结果。<br><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175283/jY6jZbBToa2zGtCbPhRw_3.jpg" alt="3.jpg"></p>
<h2 id="4、-Inurl"><a href="#4、-Inurl" class="headerlink" title="4、    Inurl"></a>4、    Inurl</h2><p>inurl: 指令用于搜索查询词出现在url 中的页面。如下图<br><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175283/va07aLy0QCagB4F82GWZ_4.jpg" alt="4.jpg"></p>
<h2 id="5、-同理-，allinurl-pig-yang，如图，不多解释"><a href="#5、-同理-，allinurl-pig-yang，如图，不多解释" class="headerlink" title="5、    同理 ，allinurl:pig+yang，如图，不多解释"></a>5、    同理 ，allinurl:pig+yang，如图，不多解释</h2><p><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175283/plPlFgsRNqURymRRKNcq_5.jpg" alt="5.jpg"></p>
<h2 id="6、-Inanchor-与-allinanchor"><a href="#6、-Inanchor-与-allinanchor" class="headerlink" title="6、    Inanchor 与 allinanchor"></a>6、    Inanchor 与 allinanchor</h2><p>使用方法与inurl类似，只是返回的结果是导入链接锚文字中包含搜索词的页面，我用的不多，不介绍。</p>
<h2 id="7、-Intitle与-allintitle"><a href="#7、-Intitle与-allintitle" class="headerlink" title="7、    Intitle与 allintitle"></a>7、    Intitle与 allintitle</h2><p>使用方法与inurl类似，只是指令返回的是页面title 中包含关键词的页面。</p>
<p><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175283/qAphtsQCTuSB4tcCkDJj_7.jpg" alt="7.jpg"></p>
<h2 id="8、-Filetype"><a href="#8、-Filetype" class="headerlink" title="8、    Filetype"></a>8、    Filetype</h2><p>这个下载的时候特别有用，直接指定连接的格式，如下图<br><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175283/7stmIkCQCe3rE5iKPfOg_8.jpg" alt="8.jpg"></p>
<h2 id="9、-Site"><a href="#9、-Site" class="headerlink" title="9、    Site"></a>9、    Site</h2><p>指定是那个站点的，也很有用，如下图，在CSDN站点搜索相关内容<br><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175283/LglyGdMlQXUJXINmFh6I_9.jpg" alt="9.jpg"></p>
<h2 id="10、-Related"><a href="#10、-Related" class="headerlink" title="10、    Related"></a>10、    Related</h2><p>这个用的不是很理解，我觉得是搜索有共同外部链接的网站，就是比如下图，巨龙的首页有的外部链接与下列搜索结果页面有相同的外部链接指向。这个对程序猿作用不大，个人就是有兴趣就试了下。我觉得用于搜索潜在客户比较有用.<br><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175283/HXAZmjfdTieEe34f8moL_10.jpg" alt="10.jpg"></p>
<h2 id="11、-组合搜索"><a href="#11、-组合搜索" class="headerlink" title="11、    组合搜索"></a>11、    组合搜索</h2><p>随便上几张图举几个栗子吧<br><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175283/E7vpa9wSUuyrP8i6DJLp_11.jpg" alt="11.jpg"></p>
<p>后缀是.csdn.net，内容又springmvc，类型是pdf的链接。<br><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175283/k2eM1rERzanNcB9TAvAj_11-2.jpg" alt="11-2.jpg"></p>
<p>#其他<br>掌握命令以后还要积累关键字。每个专业领域内都有一些专业术语，而这些术语出现在媒体或口语中都是俗称，要想查到高质量的结果，就要有把术语和俗称进行转换的能力。另外，经过长期检验，有一些专家和记者非常靠谱，在搜索问题时同时加入他们的名字，得到的结果质量会高很多。掌握了工具和关键字后，要知道二者如何配合使用。比如需要查找一份政府文件，如果知道准确的文件名，就可以加半角引号进行精确检索；但如果不知道准确名 称，就可以用site语法只在政府网站内用相关关键字查询，而不是在全网大海捞针。什么时候需要扩大搜索范围，什么时候需要缩小搜索范围，是使用具体语 法，还是减少或增加关键字，都需要经验的积累。如果每次搜索时都有意识的、层层推进的而不是盲目的，分析问题的能力也会有提高。</p>
<p>#再见<br>玩吉他去了，明天应该要陪女朋友一整天，不会写博文，后天是周一会挺忙的。估计要空两天了。so ,goodbye~</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/09/2014-01-09-relationships-a-brief-talk-on-synchronized/" itemprop="url">
                  企业的人际关系---浅淡java的synchronized
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-01-09T23:12:00+08:00" content="2014-01-09">
              2014-01-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/个人随笔/" itemprop="url" rel="index">
                    <span itemprop="name">个人随笔</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/个人随笔/多线程/" itemprop="url" rel="index">
                    <span itemprop="name">多线程</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/个人随笔/多线程/synchronized/" itemprop="url" rel="index">
                    <span itemprop="name">synchronized</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/个人随笔/多线程/synchronized/人际关系/" itemprop="url" rel="index">
                    <span itemprop="name">人际关系</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#人机关系的故事</p>
<h2 id="领导和前任领导"><a href="#领导和前任领导" class="headerlink" title="领导和前任领导"></a>领导和前任领导</h2><p>最近有朋友给我抱怨说，他们新任领导和上任领导怎么勾心斗角、明争暗斗的。让我突然觉得新任领导和上任领导的关系就和婆媳关系一样。新任领导必然要否认上任领导，这样就会到处给别人说团队业绩、效率是怎么在自己的英明领导下快速提升。而团队成员在和前任领导聊天时候就必然会说“哎呀，那个XXX啊，就是个渣啊，和您在的时候简直就没得比啊，差的多的多了啊”。这样你来我往，这两任领导之前关系再好现在也好不起来了。</p>
<h2 id="官僚化"><a href="#官僚化" class="headerlink" title="官僚化"></a>官僚化</h2><p>又想到之前阿伯伯公司的一个朋友说，你别看我们是世界500强，企业里官僚化的可严重了。进阿伯伯首先就要认准领导，拍好领导马屁。一帮招你进去的那个领导就决定了你在公司的地位。如果他没什么本事，你在公司也就没什么机会了。如果他把你招进去没多久然后他就空降到别的部门去了，而且还不带上你，那你就更惨了，新任的领导一般对于前朝旧臣是不会重用的。</p>
<h2 id="笑里藏刀"><a href="#笑里藏刀" class="headerlink" title="笑里藏刀"></a>笑里藏刀</h2><p>再想到之前，大学同学在公司中的一个比较好的同事，和他表面上好兄弟同甘共苦，但是背地里不断和领导揭他的短，然后好的机会，有油水的大便宜都占了，脏活累活苦活都给了他。</p>
<p>#IT企业<br>这样的故事还很多，但是至少我工作三年是没碰到这么邪恶的了。所以我就有了这么一个观点，互联网公司甚至IT企业的人际关系简单。为什么这么说呢，我觉得有两个原因，首先就是互联网公司发展快，大家活都没时间干了，哪里有时间吵架啊。还有就是IT企业人员流动快，还没形成官僚化气氛的时候，团队已经更新了。</p>
<p>#总之<br>当然这些都是我的瞎扯，不过大家进入社会后，在人际关系上一定还是要小心的。我是一个爱开玩笑的人，但是我开玩笑也一定会有分寸。开不起玩笑的人我是万万不会和他开玩笑的。总之，亲君子，远小人吧。</p>
<p>————————————————分割线—————————————–</p>
<p>#Synchronized详解</p>
<h2 id="1-概述"><a href="#1-概述" class="headerlink" title="1 概述"></a>1 概述</h2><p>synchronized标示符为java内置了语言级的同步原语，这简化了Java中多线程同步的使用，使用了synchronized关键字就可以轻松地解决多线程共享数据同步问题。<br>那synchronized如何对共享数据进行同步呢。<br>本篇文章就不花大篇幅介绍锁的概念，就简单介绍下java对象锁的两个特性，互斥特性和可见特性。</p>
<h2 id="2-锁"><a href="#2-锁" class="headerlink" title="2 锁"></a>2 锁</h2><p>要进行多线程同步操作，就必须要一个锁，常用的方式为对象锁和类锁。</p>
<h2 id="2-1-对象锁"><a href="#2-1-对象锁" class="headerlink" title="# 2.1 对象锁"></a># 2.1 对象锁</h2><p>如果此对象的对象锁已被其他调用者占用，另一个同步方法/同步块要获得该对象锁则需要等待此对象锁被释放。</p>
<h2 id="2-2-类锁"><a href="#2-2-类锁" class="headerlink" title="# 2.2 类锁"></a># 2.2 类锁</h2><p>类似于对象锁。静态方法用synchronized描述符是获取类锁，同步块中也可以使用synchronized(xxx.getClass()/Xxx.class)方法来获取类锁。<br>其实该锁也就是个对象锁，因为Xxx.class其实就是Xxx类的一个静态对象，只是对于该类所有的对象，这个静态对象是唯一的，所以不管Xxx类有多少个实例对象xxx，都可以用该锁来实现同步。</p>
<h2 id="2-3-互斥性"><a href="#2-3-互斥性" class="headerlink" title="# 2.3 互斥性"></a># 2.3 互斥性</h2><p>互斥锁就是当Synchronized描述的方法或块获取了对象锁，那其他再视图操作该对象锁的同步块或同步方法就会被阻塞，直到对象锁被释放。</p>
<h2 id="2-4-可见性"><a href="#2-4-可见性" class="headerlink" title="# 2.4 可见性"></a># 2.4 可见性</h2><p>可见性就是同步块或同步方法每次使用变量的时候都会读取变量修改后的最新值。</p>
<h2 id="3-例子"><a href="#3-例子" class="headerlink" title="3 例子"></a>3 例子</h2><p>解释太多概念不如直接通过代码来理解下。</p>
<h2 id="3-1-同步方法，不能被多个线程同时调用"><a href="#3-1-同步方法，不能被多个线程同时调用" class="headerlink" title="# 3.1 同步方法，不能被多个线程同时调用"></a># 3.1 同步方法，不能被多个线程同时调用</h2><h2 id="3-1-1-代码"><a href="#3-1-1-代码" class="headerlink" title="# # 3.1.1 代码"></a># # 3.1.1 代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Hello "</span> + name + <span class="string">"!现在时间是:"</span> + getCurrentTime());</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Thread.sleep(<span class="number">5000</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> TestSynchronized syncObject = <span class="keyword">new</span> TestSynchronized();</div><div class="line">        Thread t1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                syncObject.sayHello(Thread.currentThread().getName());</div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"线程1号"</span>);</div><div class="line">        Thread t2 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                syncObject.sayHello(Thread.currentThread().getName());</div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"线程2号"</span>);</div><div class="line">t1.start();</div><div class="line">        t2.start();</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<h2 id="3-1-2-输出"><a href="#3-1-2-输出" class="headerlink" title="# # 3.1.2 输出"></a># # 3.1.2 输出</h2><figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Hello 线程1号!现在时间是:2014年01月09日09时50分57秒</div><div class="line">Hello 线程2号!现在时间是:2014年01月09日09时51分02秒</div></pre></td></tr></table></figure>
<h2 id="3-1-3-分析"><a href="#3-1-3-分析" class="headerlink" title="# # 3.1.3 分析"></a># # 3.1.3 分析</h2><p>两次输出相隔五秒可以看出，synchronized描述的方法，单一个线程占用的时候，别的线程是无法访问该方法的。</p>
<h2 id="3-2-一个对象的一个同步方法被一个线程占用，该对象的其他同步方法也不能被其他线程调用"><a href="#3-2-一个对象的一个同步方法被一个线程占用，该对象的其他同步方法也不能被其他线程调用" class="headerlink" title="# 3.2 一个对象的一个同步方法被一个线程占用，该对象的其他同步方法也不能被其他线程调用"></a># 3.2 一个对象的一个同步方法被一个线程占用，该对象的其他同步方法也不能被其他线程调用</h2><h2 id="3-2-1-代码"><a href="#3-2-1-代码" class="headerlink" title="# # 3.2.1 代码"></a># # 3.2.1 代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Hello "</span> + name + <span class="string">"!现在时间是:"</span> + getCurrentTime());</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Thread.sleep(<span class="number">5000</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sayHi</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Hi "</span> + name + <span class="string">"!现在时间是:"</span> + getCurrentTime());</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Thread.sleep(<span class="number">5000</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> TestSynchronized syncObject = <span class="keyword">new</span> TestSynchronized();</div><div class="line">        Thread t1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                syncObject.sayHello(Thread.currentThread().getName());</div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"线程1号"</span>);</div><div class="line">        Thread t2 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                syncObject.sayHi (Thread.currentThread().getName());</div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"线程2号"</span>);</div><div class="line">		 t1.start();</div><div class="line">        t2.start();</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<h2 id="3-2-2-输出"><a href="#3-2-2-输出" class="headerlink" title="# # 3.2.2 输出"></a># # 3.2.2 输出</h2><figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Hi 线程2号!现在时间是:2014年01月09日10时02分36秒</div><div class="line">Hello 线程1号!现在时间是:2014年01月09日10时02分41秒</div></pre></td></tr></table></figure>
<h2 id="3-2-3-分析"><a href="#3-2-3-分析" class="headerlink" title="# # 3.2.3 分析"></a># # 3.2.3 分析</h2><p>两次输出相隔五秒可以看出，synchronized描述的方法，单一个线程占用的时候，别的线程不但无法访问该方法的还无法调用该对象实例的其他方法。<br>也说明synchronized描述方法的时候锁的对象就是调用的对象。</p>
<h2 id="3-3-一个对象的一个同步方法被一个线程占用，该对象的其他同步块也不能被其他线程调用"><a href="#3-3-一个对象的一个同步方法被一个线程占用，该对象的其他同步块也不能被其他线程调用" class="headerlink" title="# 3.3 一个对象的一个同步方法被一个线程占用，该对象的其他同步块也不能被其他线程调用"></a># 3.3 一个对象的一个同步方法被一个线程占用，该对象的其他同步块也不能被其他线程调用</h2><h2 id="3-3-1-代码"><a href="#3-3-1-代码" class="headerlink" title="# # 3.3.1 代码"></a># # 3.3.1 代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Hello "</span> + name + <span class="string">"!现在时间是:"</span> + getCurrentTime());</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Thread.sleep(<span class="number">5000</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sayHi</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Hi "</span> + name + <span class="string">"!现在时间是:"</span> + getCurrentTime());</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Thread.sleep(<span class="number">5000</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHaha</span><span class="params">(String name)</span> </span>&#123;</div><div class="line"></div><div class="line">        System.out.println(name + <span class="string">"，哈哈哈，你已经进入了大笑三声方法中了,接下来即将进入同步块！"</span> + <span class="string">"现在时间是:"</span></div><div class="line">                + getCurrentTime());</div><div class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</div><div class="line">            System.out.println(<span class="string">"这里是大笑三声同步块 "</span> + name + <span class="string">"!现在时间是:"</span></div><div class="line">                    + getCurrentTime());</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                Thread.sleep(<span class="number">5000</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        ;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> TestSynchronized syncObject = <span class="keyword">new</span> TestSynchronized();</div><div class="line">        Thread t1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                syncObject.sayHello(Thread.currentThread().getName());</div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"线程1号"</span>);</div><div class="line">        Thread t2 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                syncObject.sayHi (Thread.currentThread().getName());</div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"线程2号"</span>);</div><div class="line">Thread t4 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                syncObject.sayHaha(Thread.currentThread().getName());</div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"线程(5-1)号"</span>);</div><div class="line">		 t1.start();</div><div class="line">		 t2.start();</div><div class="line">        t4.start();</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<h2 id="3-3-2-输出"><a href="#3-3-2-输出" class="headerlink" title="# # 3.3.2 输出"></a># # 3.3.2 输出</h2><figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Hello 线程1号!现在时间是:2014年01月09日10时15分27秒</div><div class="line">线程(5-1)号，哈哈哈，你已经进入了大笑三声方法中了,接下来即将进入同步块！现在时间是:2014年01月09日10时15分27秒</div><div class="line">Hi 线程2号!现在时间是:2014年01月09日10时15分32秒</div><div class="line">这里是大笑三声同步块 线程(5-1)号!现在时间是:2014年01月09日10时15分37秒</div></pre></td></tr></table></figure>
<h2 id="3-3-3-分析"><a href="#3-3-3-分析" class="headerlink" title="# # 3.3.3 分析"></a># # 3.3.3 分析</h2><p>从提示可以看出，线程4开始时候就已经调用了sayHaha方法，但是无法进入该方法的同步块，因为对象实例的锁已经被线程1占用了。<br>虽然等到线程1把锁释放了，但是线程2也在等待。所以线程1释放锁后线程2先占用了锁，等线程2释放了锁后，线程4才获得了对象锁，才开始执行sayHaha方法的同步块。</p>
<h2 id="3-4-不同类实例的对象锁不互斥"><a href="#3-4-不同类实例的对象锁不互斥" class="headerlink" title="# 3.4 不同类实例的对象锁不互斥"></a># 3.4 不同类实例的对象锁不互斥</h2><h2 id="3-4-1-代码"><a href="#3-4-1-代码" class="headerlink" title="# # 3.4.1 代码"></a># # 3.4.1 代码</h2><p>与3.1代码其他部分不变，就加入<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">……</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayWawa</span><span class="params">(String name)</span> </span>&#123;</div><div class="line"></div><div class="line">        System.out.println(name + <span class="string">"，哈哈哈，你已经进入了大哭三声方法中了,接下来即将进入同步块！"</span> + <span class="string">"现在时间是:"</span></div><div class="line">                + getCurrentTime());</div><div class="line">        <span class="keyword">synchronized</span> (name) &#123;</div><div class="line">            System.out.println(<span class="string">"这里是大哭三声同步块 "</span> + name + <span class="string">"!现在时间是:"</span></div><div class="line">                    + getCurrentTime());</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                Thread.sleep(<span class="number">5000</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        ;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">……</div><div class="line">Thread t5 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                syncObject.sayWawa(Thread.currentThread().getName());</div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"线程5号"</span>);</div><div class="line">……</div><div class="line">t5.start();</div></pre></td></tr></table></figure></p>
<h2 id="3-4-2-输出"><a href="#3-4-2-输出" class="headerlink" title="# # 3.4.2 输出"></a># # 3.4.2 输出</h2><figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">线程5号，哈哈哈，你已经进入了大哭三声方法中了,接下来即将进入同步块！现在时间是:2014年01月09日10时35分50秒</div><div class="line">Hello 线程1号!现在时间是:2014年01月09日10时35分50秒</div><div class="line">这里是大哭三声同步块 线程5号!现在时间是:2014年01月09日10时35分50秒</div></pre></td></tr></table></figure>
<h2 id="3-4-3-分析"><a href="#3-4-3-分析" class="headerlink" title="# # 3.4.3 分析"></a># # 3.4.3 分析</h2><p>从提示可以看出，线程5调用了sayHaha方法后立马执行了同步块，因为同步块占据的是方法的参数变量name的锁，线程1获取的是syncObject对象锁，所以和线程1的不互斥.</p>
<h2 id="3-5-同一个类的不同实例的对象锁不同"><a href="#3-5-同一个类的不同实例的对象锁不同" class="headerlink" title="# 3.5 同一个类的不同实例的对象锁不同"></a># 3.5 同一个类的不同实例的对象锁不同</h2><h2 id="3-5-1-代码"><a href="#3-5-1-代码" class="headerlink" title="# # 3.5.1 代码"></a># # 3.5.1 代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Hello "</span> + name + <span class="string">"!现在时间是:"</span> + getCurrentTime());</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Thread.sleep(<span class="number">5000</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> TestSynchronized syncObject = <span class="keyword">new</span> TestSynchronized();</div><div class="line">        <span class="keyword">final</span> TestSynchronized otherSyncObject = <span class="keyword">new</span> TestSynchronized();</div><div class="line">        Thread t1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                syncObject.sayHello(Thread.currentThread().getName());</div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"线程1号"</span>);</div><div class="line">        Thread t3 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                otherSyncObject.sayHello(Thread.currentThread().getName());</div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"不是线程3号"</span>);</div><div class="line">t1.start();</div><div class="line">        t3.start();</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<h2 id="3-5-2-输出"><a href="#3-5-2-输出" class="headerlink" title="# # 3.5.2 输出"></a># # 3.5.2 输出</h2><figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Hello 线程1号!现在时间是:2014年01月09日10时30分51秒</div><div class="line">Hello 不是线程3号!现在时间是:2014年01月09日10时30分51秒</div></pre></td></tr></table></figure>
<h2 id="3-5-3-分析"><a href="#3-5-3-分析" class="headerlink" title="# # 3.5.3 分析"></a># # 3.5.3 分析</h2><p>和线程一号同时执行可以看出，同一个类不同实例对象的synchronized描述的方法不会互斥。<br>也说明了，对象锁无法解决所有同步的问题。这时候就需要类锁。</p>
<h2 id="3-6-类锁"><a href="#3-6-类锁" class="headerlink" title="# 3.6 类锁"></a># 3.6 类锁</h2><h2 id="3-6-1-代码"><a href="#3-6-1-代码" class="headerlink" title="# # 3.6.1 代码"></a># # 3.6.1 代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sayStaticClass</span><span class="params">(String name)</span></span>&#123;</div><div class="line">        System.out.println(<span class="string">"StaticClass "</span> + name + <span class="string">"!现在时间是:"</span> + getCurrentTime());</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Thread.sleep(<span class="number">5000</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayClass</span><span class="params">(String name)</span></span>&#123;</div><div class="line">        <span class="keyword">synchronized</span> (TestSynchronized.class) &#123;</div><div class="line">            System.out.println(<span class="string">"Class "</span> + name + <span class="string">"!现在时间是:"</span> + getCurrentTime());</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                Thread.sleep(<span class="number">5000</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayGetClass</span><span class="params">(String name)</span></span>&#123;</div><div class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>.getClass()) &#123;</div><div class="line">            System.out.println(<span class="string">"GetClass "</span> + name + <span class="string">"!现在时间是:"</span> + getCurrentTime());</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                Thread.sleep(<span class="number">5000</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> TestSynchronized syncObject = <span class="keyword">new</span> TestSynchronized();</div><div class="line">        Thread t6 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                TestSynchronized.sayStaticClass(Thread.currentThread().getName());</div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"线程静态方法类锁"</span>);</div><div class="line">        Thread t7 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                syncObject.sayClass(Thread.currentThread().getName());</div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"线程类锁"</span>);</div><div class="line">        Thread t8 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                syncObject.sayGetClass(Thread.currentThread().getName());</div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="string">"对象getClass方法线程类锁"</span>);</div><div class="line">        t6.start();</div><div class="line">        t7.start();</div><div class="line">        t8.start();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="3-6-2-输出"><a href="#3-6-2-输出" class="headerlink" title="# # 3.6.2 输出"></a># # 3.6.2 输出</h2><figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">StaticClass 线程静态方法类锁!现在时间是:2014年01月09日10时40分10秒</div><div class="line">Class 线程类锁!现在时间是:2014年01月09日10时40分15秒</div><div class="line">GetClass 对象getClass方法线程类锁!现在时间是:2014年01月09日10时40分20秒</div></pre></td></tr></table></figure>
<h2 id="3-6-3-分析"><a href="#3-6-3-分析" class="headerlink" title="# # 3.6.3 分析"></a># # 3.6.3 分析</h2><p>可以看出，加了synchronized的静态方法与synchronized(Xxx.class/xxx.getClass())这三种方式互斥。所以他们获取的是同一个锁，也就是Xxx.class这个Xxx类的静态成员的对象锁。<br>由于他可以对该类的所有实例进行同步，所以我们称之为类锁。</p>
<h2 id="4-总结"><a href="#4-总结" class="headerlink" title="4 总结"></a>4 总结</h2><p>搞清楚synchronized锁定的是哪个对象，对我们设计更安全的多线程程序是很有帮助的。<br>通过本文我们可以知道synchronized有两种锁的方式，一种是对象锁，一种是类锁。利用这两种锁，我们可以很好的实现对共享数据的同步操作。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/09/2014-01-09-unbelievably-volatile/" itemprop="url">
                  不靠谱的volatile
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-01-09T11:00:00+08:00" content="2014-01-09">
              2014-01-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/多线程/" itemprop="url" rel="index">
                    <span itemprop="name">多线程</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/多线程/volatile/" itemprop="url" rel="index">
                    <span itemprop="name">volatile</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#1 Volatile关键字的含义<br>在java线程并发处理时，用volatile修饰的变量，线程在每次使用变量的时候都会读取变量修改后的最新值。</p>
<p>#2 与synchronized的对比<br>Synchronized对 对象的锁有两个特性：互斥性和可见性。</p>
<h2 id="2-1-互斥性"><a href="#2-1-互斥性" class="headerlink" title="2.1 互斥性"></a>2.1 互斥性</h2><p>互斥锁就是当Synchronized描述的方法或块获取了对象锁，那其他再视图操作该对象锁的同步块或同步方法就会被阻塞，直到对象锁被释放。</p>
<h2 id="2-2-可见性"><a href="#2-2-可见性" class="headerlink" title="2.2 可见性"></a>2.2 可见性</h2><p>可见性就是同步块或同步方法每次使用变量的时候都会读取变量修改后的最新值。</p>
<h2 id="2-3-结论"><a href="#2-3-结论" class="headerlink" title="2.3 结论"></a>2.3 结论</h2><p>很明显，volatile只有具有可见性的特性。但是，他的可见性对于原子性操作又怎么个不靠谱法呢？</p>
<p>#3 例子</p>
<h2 id="3-1-程序"><a href="#3-1-程序" class="headerlink" title="3.1 程序"></a>3.1 程序</h2><figure class="highlight java"><figcaption><span>Counter.java</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">* <span class="doctag">@ClassName</span>: Counter</span></div><div class="line"><span class="comment">* <span class="doctag">@Description</span>: 测试volatile</span></div><div class="line"><span class="comment">* <span class="doctag">@author</span> David</span></div><div class="line"><span class="comment">* <span class="doctag">@date</span> 2014-1-9 下午04:37:36</span></div><div class="line"><span class="comment">* <span class="doctag">@version</span> 1.0</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Counter</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * <span class="doctag">@Fields</span> count : 不用volatile修饰</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">    * <span class="doctag">@Fields</span> count : 用volatile修饰</span></div><div class="line"><span class="comment">    */</span></div><div class="line"><span class="comment">//    public volatile static int count = 0;</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * <span class="doctag">@Title</span>: inc</span></div><div class="line"><span class="comment">     * <span class="doctag">@Description</span>: &lt;b&gt;功能：&lt;/b&gt;自增长&lt;br</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> void    返回类型</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">inc</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Thread.sleep(<span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        count++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * <span class="doctag">@Title</span>: main</span></div><div class="line"><span class="comment">     * <span class="doctag">@Description</span>: &lt;b&gt;功能：&lt;/b&gt;我是一个main&lt;br</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> void    返回类型</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</div><div class="line">            <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                    Counter.inc();</div><div class="line">                &#125;</div><div class="line">            &#125;).start();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Thread.sleep(<span class="number">3000</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">catch</span>(InterruptedException e) &#123;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"你猜，最后的结果会是多少呢？结果是"</span>+Counter.count);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="3-2-结果"><a href="#3-2-结果" class="headerlink" title="3.2 结果"></a>3.2 结果</h2><p>该函数输出的结果不固定，大概就是在990左右。<br>那如果给count变量加上volatile会怎么样呢？<br>结果还是在990多左右，可能会比没加volatile的情况更接近1000了。<br>但是为什么会出现这个情况呢，不是已经确保线程从内存中获取的count变量始终是最新的了吗。</p>
<p>#4 原因<br>下图描述了JVM运行时刻的内存分配。右边的内存区域就是JVM虚拟机的堆内存，每一个线程运行时都有一个线程栈，线程栈保存了线程运行时候的变量信息。当线程访问某一个对象值的时候，首先通过对象的引用找到对应在堆内存中的变量值，然后把该变量的具体指加载到线程本地内存中，建立一个变量的副本，之后线程内存和主内存之间就没啥关系了。<br>知道线程退出之前，自动把线程变量副本写到对象在堆中的变量中。这时候堆中的对象值才发生变化。<br>因此，线程可见性的特性只保证了从堆中复制的值是最新的，而不能保证线程栈中的值是最新的。<br><img src="http://user-image.logdown.io/user/3769/blog/3827/post/175079/Git9mKXwT8yiboZ0JN9X_1.jpg" alt="1.jpg"></p>
<p>#5 Volatile的适用场合<br>既然volatile这么不靠谱，那为什么还会有他呢？其实他还是有一些适用的场合的。</p>
<h2 id="5-1-读操作远远大于写操作的时候"><a href="#5-1-读操作远远大于写操作的时候" class="headerlink" title="5.1 读操作远远大于写操作的时候"></a>5.1 读操作远远大于写操作的时候</h2><p>由于volatile的开销比synchronized小的多的多。所以，出于性能考虑，在读操作远远大于写操作的时候，还是适用volatile吧。</p>
<h2 id="5-2-用作状态的时候"><a href="#5-2-用作状态的时候" class="headerlink" title="5.2 用作状态的时候"></a>5.2 用作状态的时候</h2><p>比如调度引擎表示是否启动状态的时候，执行调度方法的时候都需要判断状态是否为启动才继续。这种时候适合用volatile。<br>其实这种情况也就是2.1中的一种特殊情况。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/07/2014-01-07-lack-of-change-java-of-the-class-loader-works/" itemprop="url">
                  不足则改之---Java类装载器的工作原理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2014-01-07T16:14:00+08:00" content="2014-01-07">
              2014-01-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/jvm/" itemprop="url" rel="index">
                    <span itemprop="name">jvm</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/jvm/classloader/" itemprop="url" rel="index">
                    <span itemprop="name">classloader</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>很高兴，晚上回来路上捡到了100块钱。我交给了警察叔叔处理，终于拾金不昧了一把。T.T以前都是特么的捡不到钱啊。</p>
<p>#不足<br>今天和一位技术上的前辈聊了一个小时，除了了解到自己需求等各方面的不足，还发现了自己一个薄弱点，那就是对java底层是如何运行的还不是很了解。早在刚毕业的时候，我还会去了解JVM的运行机制、一个java文件如何编译成字节码文件、如何通过类加载器加载、如何解释运行、JIT，包括JVM实例的堆、程序计数器，包括每个方法的栈。<br>但是现在，对于这些东西，由于长期专注于web，并且心猿意马，早就关注其他新的技术，导致忘了这些老本行。这些东西早就有所了解而却说不出个所以然来。<br>因此，晚上回来就痛彻心扉的决定要把这块已经丢失的骨头再啃起来。本来计划今天要把之前写好的javascript实战篇的最后一篇博文整理下发出来，但是，我决定还是先把JVM相关的搞定了把。</p>
<p>#JVM的核心</p>
<p><img src="http://user-image.logdown.io/user/3769/blog/3827/post/174805/kWlOwaDJSbGCe5LDNuxi_1.gif" alt="1.gif"></p>
<p>#类加载器<br>可以看到，类加载器在其中占了很重要的一大块，今天就先把类装载器这老骨头给重新啃一啃。</p>
<h2 id="1-基础概念"><a href="#1-基础概念" class="headerlink" title="1 基础概念"></a>1 基础概念</h2><h2 id="1-1-什么是类加载器"><a href="#1-1-什么是类加载器" class="headerlink" title="# 1.1 什么是类加载器"></a># 1.1 什么是类加载器</h2><p>类加载器是一个用来加载类文件的类。<br>默认的类加载器有三种：Bootstrap类加载器、Extension类加载器和System类加载器。之后章节具体介绍每种类加载器从哪里加载类。</p>
<h2 id="1-2-类加载器的作用"><a href="#1-2-类加载器的作用" class="headerlink" title="# 1.2 类加载器的作用"></a># 1.2 类加载器的作用</h2><p>在Java虚拟机的执行引擎执行的时候加载类。<br>Java源代码通过javac编译器编译成类文件。然后JVM来执行类文件中的字节码（注意：JIT会把热点代码编译成机器码进行执行，为了提供运行时效率）来执行程序。<br>类加载器负责加载文件系统、网络或其他来源的类文件。</p>
<h2 id="1-3-类加载器的三个机制"><a href="#1-3-类加载器的三个机制" class="headerlink" title="# 1.3 类加载器的三个机制"></a># 1.3 类加载器的三个机制</h2><p>Java类加载器的工作原理基于以下三个机制：委托、可见性和单一性。</p>
<h2 id="1-3-1-委托"><a href="#1-3-1-委托" class="headerlink" title="# # 1.3.1 委托"></a># # 1.3.1 委托</h2><p>委托机制是指将加载一个类的请求交给父加载器，如果这个父类加载器不能找到或者加载这个类，那么再加载它。</p>
<h2 id="1-3-2-可见性"><a href="#1-3-2-可见性" class="headerlink" title="# # 1.3.2 可见性"></a># # 1.3.2 可见性</h2><p>子类的加载器可以看见所有父类的加载器加载的类，而父类加载器看不到子类加载器加载的类。</p>
<h2 id="1-3-3-单一性"><a href="#1-3-3-单一性" class="headerlink" title="# # 1.3.3 单一性"></a># # 1.3.3 单一性</h2><p>指一个类仅加载一次，该机制是通过委托机制确保子类加载器不会再次加载父类加载器加载过的类。</p>
<h2 id="1-3-4-例子"><a href="#1-3-4-例子" class="headerlink" title="# # 1.3.4 例子"></a># # 1.3.4 例子</h2><p>通过后面章节介绍了各个类加载器及其工作原理后再结合例子介绍。</p>
<h2 id="1-4-Bootstrap类加载器"><a href="#1-4-Bootstrap类加载器" class="headerlink" title="# 1.4 Bootstrap类加载器"></a># 1.4 Bootstrap类加载器</h2><h2 id="1-4-1-概念"><a href="#1-4-1-概念" class="headerlink" title="# # 1.4.1 概念"></a># # 1.4.1 概念</h2><p>该类加载器负责加载rt.jar中的JDK类文件，他是所有类加载器的父加载器。该类加载器没有父类加载器，如果你调用String.class.getClassLoader()，会返回null。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">System.out.println(String.class.getClassLoader());</div><div class="line">System.out.println(TestBootstrapCL.class.getClassLoader());</div></pre></td></tr></table></figure></p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">null</div><div class="line">sun.misc.Launcher$AppClassLoader@82ba41</div></pre></td></tr></table></figure>
<p>因此，bootstrap类加载器被称为初始类加载器。</p>
<h2 id="1-4-2-加载类文件的地方"><a href="#1-4-2-加载类文件的地方" class="headerlink" title="# # 1.4.2 加载类文件的地方"></a># # 1.4.2 加载类文件的地方</h2><p>JRE/lib/rt.jar</p>
<h2 id="1-5-Extension类加载器"><a href="#1-5-Extension类加载器" class="headerlink" title="# 1.5 Extension类加载器"></a># 1.5 Extension类加载器</h2><h2 id="1-5-1-概念"><a href="#1-5-1-概念" class="headerlink" title="# # 1.5.1 概念"></a># # 1.5.1 概念</h2><p>Extension类加载器负责加载标准扩展目录下面的类。他加载类之前，会先委托他的父类加载器（Bootstrap）进行加载，没有加载到再从jre/lib/ext目录下或者java.ext.dirs系统属性定义的目录下加载类。<br>这样就可以使得编写程序变得简单，只需把JAR文件拷贝到扩展目录下面即可，类加载器会自动的在下面查找。<br>Extension加载器由sun.misc.Launcher$ExtClassLoader实现。</p>
<h2 id="1-5-2-加载类文件的地方"><a href="#1-5-2-加载类文件的地方" class="headerlink" title="# # 1.5.2 加载类文件的地方"></a># # 1.5.2 加载类文件的地方</h2><p>jre/lib/ext</p>
<h2 id="1-6-System类加载器"><a href="#1-6-System类加载器" class="headerlink" title="# 1.6 System类加载器"></a># 1.6 System类加载器</h2><h2 id="1-6-1-概念"><a href="#1-6-1-概念" class="headerlink" title="# # 1.6.1 概念"></a># # 1.6.1 概念</h2><p>System类加载器是默认的类加载器，他会从CLASSPATH目录下查找类。CLASSPATH可以是系统CLASSPATH变量中设定的，可以是命令行-classpath –cp后的参数定义的，也可以是jar文件中的Mainfest的classpath属性定义的。SYSTEM类加载器是通过sun.misc.Launcher$AppClassLoader在实现的。</p>
<h2 id="1-6-2-加载类文件的地方"><a href="#1-6-2-加载类文件的地方" class="headerlink" title="# # 1.6.2 加载类文件的地方"></a># # 1.6.2 加载类文件的地方</h2><p>CLASSPATH</p>
<h2 id="2-工作原理"><a href="#2-工作原理" class="headerlink" title="2 工作原理"></a>2 工作原理</h2><p>把三种类加载器说完了，现在补充下之前没说完的类加载器工作原理的三个机制。</p>
<h2 id="2-1-委托机制"><a href="#2-1-委托机制" class="headerlink" title="# 2.1 委托机制"></a># 2.1 委托机制</h2><p>当一个类加载和初始化的时候，类尽在有需要加载的时候被加载。假设你有一个应用需要的类家Abc.class，首先加载这个类的请求由System类加载器委托给Extension类加载器，然后再委托给Bootstrap类加载器。Bootstrap会先看看rt.jar中有没有这个类，没有的话再把请求返回给extension类加载器，如果这个类被Extension类加载器找到了，那么他将被加载，而System不会加载这个类。如果没有找到，那么System就回去CLASSPATH中寻找。</p>
<h2 id="2-2-可见性机制"><a href="#2-2-可见性机制" class="headerlink" title="# 2.2 可见性机制"></a># 2.2 可见性机制</h2><p>根据可见性机制，子类加载器可以看到父类加载器加载的类，而反之则不行。<br>看以下例子<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">            System.out.println(<span class="string">"TestBootstrapCL.class.getClassLoader():"</span>+TestBootstrapCL.class.getClassLoader());</div><div class="line">            System.out.println(<span class="string">"TestBootstrapCL.class.getClassLoader().getParent():"</span>+TestBootstrapCL.class.getClassLoader().getParent());</div><div class="line">            Class.forName(<span class="string">"com.dragonsoft.test.d140107"</span>, <span class="keyword">true</span>, TestBootstrapCL.class.getClassLoader().getParent());</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">catch</span>(ClassNotFoundException e) &#123;</div><div class="line">            Logger.getLogger(TestBootstrapCL.class.getName()).log(Level.SEVERE, e.toString());</div><div class="line">        &#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">TestBootstrapCL.class.getClassLoader():sun.misc.Launcher$AppClassLoader@82ba41</div><div class="line">TestBootstrapCL.class.getClassLoader().getParent():sun.misc.Launcher$ExtClassLoader@923e30</div><div class="line">2014-1-7 23:58:48 com.dragonsoft.test.d140107.TestBootstrapCL main</div><div class="line">严重: java.lang.ClassNotFoundException: com.dragonsoft.test.d140107</div></pre></td></tr></table></figure>
<p>可以看出TestBootstrapCL的类加载器是SYSTEM类加载器。TestBootstrapCL类加载器的父类加载器是Extension。而Extension类加载器无法加载到TestBootstrapCL类，因为可见性原则限制父类加载器是无法加载子类加载器的。</p>
<h2 id="2-3-单一性原则"><a href="#2-3-单一性原则" class="headerlink" title="# 2.3 单一性原则"></a># 2.3 单一性原则</h2><p>根据该机制，父类加载器加载过的类不能被子类加载器加载第二次。</p>
<h2 id="3-显示类加载"><a href="#3-显示类加载" class="headerlink" title="3 显示类加载"></a>3 显示类加载</h2><p>Class.forName(className)和 Class.forName(className,initialized,classloader)。在JAVA创建JDBC连接的时候，都会要显示的加载数据库驱动类。<br>类加载是通过调用CLassLoader的loadClass()方法，loadClass()再调用findClass()。如果最后都没找到该类，那就会报错。找到的话就调用defineClass()将字节码转化成类实例，然后返回。</p>
<h2 id="4-显示类加载的作用"><a href="#4-显示类加载的作用" class="headerlink" title="4 显示类加载的作用"></a>4 显示类加载的作用</h2><p>Class.forName(className)在返回一个Class的同时，他会执行该类的静态代码段。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Class clazz=Class.forName(driverClass);</div><div class="line">Driver driver=(java.sql.Driver)clazz.newInstance();</div><div class="line">DriverManager.registerDriver(driver);</div></pre></td></tr></table></figure></p>
<p>比如上面这段代码，我就可以把driverClass写在配置文件中，写在数据库中。只要这些驱动类都是java.sql.Driver实现类的，我就能把他们动态的加载到应用中。是不是有点动态语言的风范？这也就是java用代理事先动态语言的一种方式。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/10/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/12/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="David Woo" />
          <p class="site-author-name" itemprop="name">David Woo</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/">
              <span class="site-state-item-count">114</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">195</span>
                <span class="site-state-item-name">categories</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">tags</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">David Woo</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>
